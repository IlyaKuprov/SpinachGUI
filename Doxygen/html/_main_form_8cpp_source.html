<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Spinach GUI: Z:/SpinachGUI/GUI/MainForm.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Z:/SpinachGUI/GUI/MainForm.cpp</h1>  </div>
</div>
<div class="contents">
<a href="_main_form_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;<a class="code" href="stdafx_8h.html">StdAfx.h</a>&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;<a class="code" href="_main_form_8h.html">MainForm.h</a>&quot;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//MainForm  main rutines</span>
<a name="l00006"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6babde35ca5140b4a805eb8da550cdfd">00006</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6babde35ca5140b4a805eb8da550cdfd">SpinachGUI::MainForm::MainForm_Initialization</a>() 
<a name="l00007"></a>00007 {
<a name="l00008"></a>00008         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a04e599b24c20deaa9205dcadce18d5de">MyResources</a> = 
<a name="l00009"></a>00009                 (<span class="keyword">gcnew</span> System::ComponentModel::ComponentResourceManager(MainForm::typeid));
<a name="l00010"></a>00010         System::Threading::Thread::CurrentThread-&gt;CurrentCulture=<span class="keyword">gcnew</span> System::Globalization::CultureInfo( <span class="stringliteral">&quot;en-US&quot;</span>,     <span class="keyword">false</span>);
<a name="l00011"></a>00011 
<a name="l00012"></a>00012         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>=<span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>();
<a name="l00013"></a>00013         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a80f79a6e9dcb6646e5b12304d9eacd09" title="Event for when something changes inside the model object.">PropertyChanged</a>+=<span class="keyword">gcnew</span> PropertyChangedEventHandler(<span class="keyword">this</span>,&amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5b31c53c40cf7e6e6f15340d9f639fbe">MainForm::ModelChange</a>);
<a name="l00014"></a>00014         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;SpinXML1&quot;</span>);
<a name="l00015"></a>00015         this-&gt;MouseWheel += <span class="keyword">gcnew</span> System::Windows::Forms::MouseEventHandler(<span class="keyword">this</span>,&amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a795128e5b9de393b750fa0cc9c32c05a">MainForm::OnMouseWheel</a>);
<a name="l00016"></a>00016         
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 
<a name="l00019"></a>00019         <span class="comment">//Add elements to drop down menu for elements</span>
<a name="l00020"></a>00020         ArrayList^ Isotopes_Collection=<a class="code" href="class_isotopes.html#a366e4892c3701b215fb565b088cefb90" title="Getter of isotopes collection.">Isotopes::getAllIsotopes</a>();
<a name="l00021"></a>00021         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af47c5a76169c64a3f0c2b7c5b2ed0966">NodesToDeleted</a>=<span class="keyword">gcnew</span> ArrayList();
<a name="l00022"></a>00022         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a559a4f70db197a80ec920fc77ae40f4e">Column4</a>-&gt;Items-&gt;Add(((<a class="code" href="class_isotope.html">Isotope</a>^)Isotopes_Collection[0])-&gt;Element); 
<a name="l00023"></a>00023         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;Isotopes_Collection-&gt;Count;i++) 
<a name="l00024"></a>00024         { 
<a name="l00025"></a>00025                 <span class="keywordflow">if</span>(i&gt;0 &amp;&amp; ((<a class="code" href="class_isotope.html">Isotope</a>^)Isotopes_Collection[i])-&gt;Element!=
<a name="l00026"></a>00026                         ((<a class="code" href="class_isotope.html">Isotope</a>^)Isotopes_Collection[i-1])-&gt;Element)
<a name="l00027"></a>00027                         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a559a4f70db197a80ec920fc77ae40f4e">Column4</a>-&gt;Items-&gt;Add((String^)((<a class="code" href="class_isotope.html">Isotope</a>^)Isotopes_Collection[i])-&gt;Element); 
<a name="l00028"></a>00028         }
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;AutoGenerateColumns=<span class="keyword">false</span>;
<a name="l00031"></a>00031         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;AutoGenerateColumns=<span class="keyword">false</span>;
<a name="l00032"></a>00032         <span class="comment">//Initialize the first line of atoms table</span>
<a name="l00033"></a>00033         <span class="comment">//this-&gt;dataGridView1-&gt;TopLeftHeaderCell-&gt;Value=&quot;Add atom&quot;;</span>
<a name="l00034"></a>00034         <span class="comment">//this-&gt;dataGridView1-&gt;Rows[0]-&gt;HeaderCell-&gt;Value = gcnew String(&quot;+Atom&quot;);</span>
<a name="l00035"></a>00035         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[0,0]-&gt;Value = <span class="stringliteral">&quot;new&quot;</span>;
<a name="l00036"></a>00036         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[2,0]-&gt;Value=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00037"></a>00037         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[1,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00038"></a>00038         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00039"></a>00039         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,0]-&gt;ReadOnly=<span class="keyword">true</span>;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[5,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00040"></a>00040         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[6,0]-&gt;ReadOnly=<span class="keyword">true</span>;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[7,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00041"></a>00041         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[8,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a59413c9af9317ec767264b3fc473f185">MyResources2</a>=(<span class="keyword">gcnew</span> System::ComponentModel::ComponentResourceManager(About::typeid));
<a name="l00044"></a>00044         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[8,0])-&gt;ValueIsIcon=<span class="keyword">true</span>;
<a name="l00045"></a>00045         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[8,0])-&gt;Value =
<a name="l00046"></a>00046                 (cli::safe_cast&lt;System::Drawing::Icon^  &gt;(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a59413c9af9317ec767264b3fc473f185">MyResources2</a>-&gt;GetObject(L<span class="stringliteral">&quot;$this.Icon&quot;</span>)));
<a name="l00047"></a>00047         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a753fedf80fb13715b49c225d1c5ff4c1">Column9</a>-&gt;ValuesAreIcons=<span class="keyword">true</span>;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049         <span class="comment">//Initialize the first line of atoms table</span>
<a name="l00050"></a>00050         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[6,0]-&gt;Value=<span class="stringliteral">&quot;Edit&quot;</span>;
<a name="l00051"></a>00051         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[0,0]-&gt;Value = <span class="stringliteral">&quot;new&quot;</span>;
<a name="l00052"></a>00052         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[1,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00053"></a>00053         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00054"></a>00054         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00055"></a>00055         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00056"></a>00056         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[6,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00057"></a>00057         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[7,0]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00058"></a>00058         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[7,0])-&gt;ValueIsIcon=<span class="keyword">true</span>;
<a name="l00059"></a>00059         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[7,0])-&gt;Value =
<a name="l00060"></a>00060                 (cli::safe_cast&lt;System::Drawing::Icon^  &gt;(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a59413c9af9317ec767264b3fc473f185">MyResources2</a>-&gt;GetObject(L<span class="stringliteral">&quot;$this.Icon&quot;</span>)));
<a name="l00061"></a>00061         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a82b5028fff92a2d0f1cc5bac5e3e04d7">Column12</a>-&gt;ValuesAreIcons=<span class="keyword">true</span>;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a>00065         <span class="keywordtype">int</span> gap=2; <span class="comment">//OpenGL panel margin</span>
<a name="l00066"></a>00066         <span class="comment">//OpenGL = gcnew COpenGL(this,</span>
<a name="l00067"></a>00067         <span class="comment">//                         System::Drawing::Point(tableLayoutPanel13-&gt;Width+gap/2,this-&gt;tabControl1-&gt;Height+gap/2),</span>
<a name="l00068"></a>00068         <span class="comment">//                         this-&gt;ClientSize.Width-tableLayoutPanel13-&gt;Width-tableLayoutPanel4-&gt;Width-gap,</span>
<a name="l00069"></a>00069         <span class="comment">//                         this-&gt;ClientSize.Height-this-&gt;tabControl1-&gt;Height-gap);</span>
<a name="l00070"></a>00070         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a> = <span class="keyword">gcnew</span> <a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html">COpenGL</a>(<span class="keyword">this</span>,
<a name="l00071"></a>00071                                    System::Drawing::Point(0,0),
<a name="l00072"></a>00072                                    <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a564527f7610021bd8bb3de9f6d037d04">splitContainer2</a>-&gt;Panel1-&gt;Width,
<a name="l00073"></a>00073                                    <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a564527f7610021bd8bb3de9f6d037d04">splitContainer2</a>-&gt;Panel1-&gt;Height);
<a name="l00074"></a>00074         
<a name="l00075"></a>00075         <span class="comment">//OpenGL-&gt;SuspendLayout();</span>
<a name="l00076"></a>00076         <span class="comment">//OpenGL-&gt;Controls-&gt;Add(splitContainer2-&gt;Panel1);</span>
<a name="l00077"></a>00077         <span class="comment">//OpenGL-&gt;ResumeLayout(false);</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a564527f7610021bd8bb3de9f6d037d04">splitContainer2</a>-&gt;Panel1-&gt;SuspendLayout();
<a name="l00080"></a>00080         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a564527f7610021bd8bb3de9f6d037d04">splitContainer2</a>-&gt;Panel1-&gt;Controls-&gt;Add(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>);
<a name="l00081"></a>00081         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a564527f7610021bd8bb3de9f6d037d04">splitContainer2</a>-&gt;Panel1-&gt;ResumeLayout(<span class="keyword">false</span>);
<a name="l00082"></a>00082   <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2448c0f9e67dd5765379e1d475586eee">Update_Interactions_Color</a>();
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 
<a name="l00087"></a>00087         <span class="comment">//check boxes</span>
<a name="l00088"></a>00088         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4b5718cbc6975ce96c5363c7eda717a1">checkBoxAxes</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a735447373bdfe5ed0fda746aaeaa5f72" title="Flag for showing navigation axes.">AxesFlag</a>;
<a name="l00089"></a>00089         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a13624261209264386df1cde404b1ed6e">GTFlag</a>;
<a name="l00090"></a>00090         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afa59a811285e41674e9f16ea7b6f77ba">CSFlag</a>;
<a name="l00091"></a>00091         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a228adfdf34ef201300550f0f5467e446">HCFlag</a>;
<a name="l00092"></a>00092         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fd00e0dce38f247c53b463fb332a364" title="Flags for showing kind of interactions.">CBFlag</a>;
<a name="l00093"></a>00093         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1b990cb1428e1f146caf86e7c6fd40f6">JCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a38fcd62b067631ddbf9a246de902a60d">JCFlag</a>;
<a name="l00094"></a>00094 <span class="comment">//      DCcheckBox-&gt;Checked=OpenGL-&gt;DCFlag;</span>
<a name="l00095"></a>00095         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa548f39ed75164d87e04034e809ec70e">QCFlag</a>;
<a name="l00096"></a>00096         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1d748386440db28357f41756507ae5db">ECcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa88a55e4dc4b4150121add8c84bda00d">ECFlag</a>;
<a name="l00097"></a>00097         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d940879e95fc2974a27fb24d55bce89" title="Flags for showing kind of interactions.">ZFFlag</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>=<span class="keyword">true</span>;
<a name="l00100"></a>00100         <span class="comment">//EventHandlers for Trackbars-Placed manually because the autogeneration forget them from times to times.</span>
<a name="l00101"></a>00101         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#addb8c546e1158655645dbccd4020015a">HFCtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae09a8303441b15211f840f1251d988cf">MainForm::HFCtrackBar_Scroll</a>);
<a name="l00102"></a>00102         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaa93a5c90977dc9e56e1e49bbcdfe451">CStrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af17b52d955bf43c6198b11968399c66c">MainForm::CStrackBar_Scroll</a>);
<a name="l00103"></a>00103         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a622b73087a36479909ca8cd42e920764">GTtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9937027bdd1ebeba5194a27dc6d2ec60">MainForm::GTtrackBar_Scroll</a>);
<a name="l00104"></a>00104         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac9d283e6bcc31cec8ecbd155f0391e49">BondtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a51c642c2d16f0e36208792f73bc982d9">MainForm::BondtrackBar_Scroll</a>);
<a name="l00105"></a>00105         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5fae1983e82c36bcd4ae88e378b62785">JCtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a963a27daee78044c8810be3556d9add1">MainForm::JCtrackBar_Scroll</a>);
<a name="l00106"></a>00106 <span class="comment">//      this-&gt;DCtrackBar-&gt;ValueChanged += gcnew gTrackBar::gTrackBar::ValueChangedEventHandler(this, &amp;MainForm::DCtrackBar_Scroll);</span>
<a name="l00107"></a>00107         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a601149241a089b20bbba154ff320d5c7">QCtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a285db727612b415cff67204af881e459">MainForm::QCtrackBar_Scroll</a>);
<a name="l00108"></a>00108         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0989f0d7b98a3eae2465130be263be68">ECtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2ab7c7d670ef95b717faa71e0b449538">MainForm::ECtrackBar_Scroll</a>);
<a name="l00109"></a>00109         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a571a1d88b54e5e32a1d1efe1aee152d5">ZFtrackBar</a>-&gt;ValueChanged += <span class="keyword">gcnew</span> gTrackBar::gTrackBar::ValueChangedEventHandler(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5dfdd7d44be4c8c066be9c845b2d217d">MainForm::ZFtrackBar_Scroll</a>);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="comment">//this-&gt;RefFramestreeView-&gt;BeforeLabelEdit += gcnew System::Windows::Forms::NodeLabelEditEventHandler(this, &amp;MainForm::RefFramestreeView_BeforeLabelEdit);</span>
<a name="l00112"></a>00112         <span class="comment">//NativeWindow^ xlMain = gcnew NativeWindow();</span>
<a name="l00113"></a>00113         <span class="comment">//xlMain-&gt;AssignHandle(IntPtr((HWND)this-&gt;Handle.ToPointer()));</span>
<a name="l00114"></a>00114         <span class="comment">//String^ name = AppDomain::CurrentDomain-&gt;FriendlyName;</span>
<a name="l00115"></a>00115         <span class="comment">//array &lt;Diagnostics::Process^&gt;^ pro = </span>
<a name="l00116"></a>00116         <span class="comment">//      Diagnostics::Process::GetProcessesByName(name-&gt;Substring(0, name-&gt;LastIndexOf(&#39;.&#39;)));</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         <span class="comment">//button2-&gt;OnMouseEnter(gcnew EventArgs());</span>
<a name="l00119"></a>00119         
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9eaaafcea8656cb98801941ed6d6dbe0">BalloonToolTip1</a>=<span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_balloon_tool_tip.html">BalloonToolTip</a>(<span class="stringliteral">&quot;Add atom by selecting element&quot;</span>);
<a name="l00122"></a>00122         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8f0971090f98f7596757aba99339ffd9">BalloonToolTip2</a>=<span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_balloon_tool_tip.html">BalloonToolTip</a>(<span class="stringliteral">&quot;Add interaction by selecting Atom ID&quot;</span>);
<a name="l00123"></a>00123         
<a name="l00124"></a>00124         this-&gt;AddOwnedForm( <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9eaaafcea8656cb98801941ed6d6dbe0">BalloonToolTip1</a> );
<a name="l00125"></a>00125         this-&gt;AddOwnedForm( <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8f0971090f98f7596757aba99339ffd9">BalloonToolTip2</a> );
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6be66f928fd89aea3e45b3811284e16b">labelflag</a>=<span class="keyword">true</span>;
<a name="l00128"></a>00128         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab73baf2704690c940479ce829d0ca154">easyspin</a> = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_easy_spin.html">EasySpin</a>();    
<a name="l00129"></a>00129         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bf540019235a3037224e8661155154c">spinach</a> = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_spinach.html">Spinach</a>();      
<a name="l00130"></a>00130         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5576a0a2b5dbc331dc759a4e0a18a293">simpson</a>=<span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_simpson.html">Simpson</a>();
<a name="l00131"></a>00131         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac713ad7e3f865bd8cc699289c26e9340">spinEvolution</a>=<span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_spin_evolution.html">SpinEvolution</a>();
<a name="l00132"></a>00132         
<a name="l00133"></a>00133       
<a name="l00134"></a>00134 }
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a81bff3e5b5390e607bf76851e761db5b">00136</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a81bff3e5b5390e607bf76851e761db5b">SpinachGUI::MainForm::MainForm_Paint</a>(System::Object^  sender, System::Windows::Forms::PaintEventArgs^  e) 
<a name="l00137"></a>00137 {
<a name="l00138"></a>00138         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00139"></a>00139         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac1fb86de38cd62d963ead03a0ff4fbb7" title="Swap Buffer in OpenGL panel, usually after finishing rendering.">SwapOpenGLBuffers</a>();
<a name="l00140"></a>00140         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6b4493c3ff99e8fcf1362a1700f03b9b">dataGridView_Helpers</a>();
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0a55d15ee7268f8df159a13b3d75685">00143</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0a55d15ee7268f8df159a13b3d75685">SpinachGUI::MainForm::MainForm_Resize</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145 
<a name="l00146"></a>00146         <span class="keywordtype">int</span> gap=2; <span class="comment">//OpenGL panel margin</span>
<a name="l00147"></a>00147         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6b4493c3ff99e8fcf1362a1700f03b9b">dataGridView_Helpers</a>();
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a90823e1ea181b5109a7c84e7458d79d7">00152</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a90823e1ea181b5109a7c84e7458d79d7">SpinachGUI::MainForm::MainForm_Shown</a>(System::Object^  sender, System::EventArgs^  e) {
<a name="l00153"></a>00153                           <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a4269a637342af6fb3add0853e1301da6" title="Final Render routine.">Render</a>();
<a name="l00154"></a>00154                  }<span class="comment"></span>
<a name="l00155"></a>00155 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00156"></a>00156 <span class="comment"></span><span class="comment">//Open and Save File</span>
<a name="l00157"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a91695d6fc2a77a6978bc6672510b8557">00157</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a91695d6fc2a77a6978bc6672510b8557">SpinachGUI::MainForm::Newbutton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00158"></a>00158 {
<a name="l00159"></a>00159         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae2c69eda86a678c4636a1ab4e89f3c91">Reset</a>();
<a name="l00160"></a>00160         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a30ba78422f28b4ce56e5408c8e3f78a6">Home</a>();
<a name="l00161"></a>00161         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Clear(); 
<a name="l00162"></a>00162         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a2b1099438d2b42b3f2c7c250323fa712">Clear</a>();
<a name="l00163"></a>00163         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();   
<a name="l00164"></a>00164         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#aab9a62a43eabd6e0edef2599e65ebf82">Clear</a>();
<a name="l00165"></a>00165         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();   
<a name="l00166"></a>00166         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#a3d6b3cdf166c8952ac2cd59b57b51676">Clear</a>();
<a name="l00167"></a>00167         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;Nodes[0]-&gt;Nodes-&gt;Clear();
<a name="l00168"></a>00168         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>=<span class="stringliteral">&quot;SpinXML1&quot;</span>;
<a name="l00169"></a>00169         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>=<span class="keyword">nullptr</span>;
<a name="l00170"></a>00170         this-&gt;Text=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>+<span class="stringliteral">&quot;- Spinach GUI &quot;</span>+SpinachGUIver;
<a name="l00171"></a>00171         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0d61b7fd1b0a11cf21cb61ccf3ccfae3">Savebutton</a>-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00172"></a>00172         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9a74299d9d427352e42cb18c07d6ad35">ModelFileName</a>-&gt;Text=<span class="stringliteral">&quot;Imported File: (None)&quot;</span>;
<a name="l00173"></a>00173         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac5478d4213eaa78e3a725b45868c809d">Reset</a>();
<a name="l00174"></a>00174         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00180"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0704091dc5e94762a44e02c98a2b2f81">00180</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0704091dc5e94762a44e02c98a2b2f81">SpinachGUI::MainForm::OpenFileButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;Filter=<span class="stringliteral">&quot;SpinXML File|*.sxml&quot;</span>;
<a name="l00183"></a>00183         <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l00184"></a>00184         {
<a name="l00185"></a>00185                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae2c69eda86a678c4636a1ab4e89f3c91">Reset</a>();
<a name="l00186"></a>00186                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a30ba78422f28b4ce56e5408c8e3f78a6">Home</a>();
<a name="l00187"></a>00187                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Clear(); 
<a name="l00188"></a>00188                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();   
<a name="l00189"></a>00189                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;Nodes[0]-&gt;Nodes-&gt;Clear();
<a name="l00190"></a>00190                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a2b1099438d2b42b3f2c7c250323fa712">Clear</a>();
<a name="l00191"></a>00191                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#aab9a62a43eabd6e0edef2599e65ebf82">Clear</a>();
<a name="l00192"></a>00192                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#a3d6b3cdf166c8952ac2cd59b57b51676">Clear</a>();
<a name="l00193"></a>00193                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac5478d4213eaa78e3a725b45868c809d">Reset</a>();
<a name="l00194"></a>00194                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00195"></a>00195                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9604c2f105f571246c561c539881d4fc">GenprogressBar</a>-&gt;Visible=<span class="keyword">true</span>;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==1)     <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a22f336cba56244225f8814eb7c55d2af">OpenSpinXML</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName);
<a name="l00198"></a>00198         };
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a22f336cba56244225f8814eb7c55d2af">00203</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a22f336cba56244225f8814eb7c55d2af">SpinachGUI::MainForm::OpenSpinXML</a>(String ^ FileName) 
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205                         <a class="code" href="class_spin_x_m_l.html">SpinXML</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_spin_x_m_l.html">SpinXML</a>(FileName, IOSpinSystem::FilterType::IMPORT, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00206"></a>00206                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00207"></a>00207                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);        
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3648dfd20f486585e35dbc4052ae8160">00210</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3648dfd20f486585e35dbc4052ae8160">SpinachGUI::MainForm::Importbutton_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;Filter=<span class="stringliteral">&quot;Gaussian3 File|*.log;*.out|&quot;</span>+
<a name="l00213"></a>00213                                      <span class="stringliteral">&quot;mol File|*.mol|&quot;</span>+
<a name="l00214"></a>00214                                                          <span class="stringliteral">&quot;xyz File|*.xyz|&quot;</span>+
<a name="l00215"></a>00215                                                          <span class="stringliteral">&quot;CASTEP File|*.magres|&quot;</span>+
<a name="l00216"></a>00216                                                          <span class="stringliteral">&quot;Orca File|*.log;*.out|&quot;</span>+
<a name="l00217"></a>00217                                                          <span class="stringliteral">&quot;ADF File|*.out|&quot;</span>+
<a name="l00218"></a>00218                                  <span class="stringliteral">&quot;GAMESS File|*.out|&quot;</span>+
<a name="l00219"></a>00219                                                          <span class="stringliteral">&quot;COSMOS File|*.coo&quot;</span>;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         <span class="comment">//|All Files|*.*</span>
<a name="l00222"></a>00222         <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l00223"></a>00223         {
<a name="l00224"></a>00224                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae2c69eda86a678c4636a1ab4e89f3c91">Reset</a>();
<a name="l00225"></a>00225                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a30ba78422f28b4ce56e5408c8e3f78a6">Home</a>();
<a name="l00226"></a>00226                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Clear(); 
<a name="l00227"></a>00227                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();   
<a name="l00228"></a>00228             <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;Nodes[0]-&gt;Nodes-&gt;Clear();
<a name="l00229"></a>00229                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a2b1099438d2b42b3f2c7c250323fa712">Clear</a>();
<a name="l00230"></a>00230                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#aab9a62a43eabd6e0edef2599e65ebf82">Clear</a>();
<a name="l00231"></a>00231                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#a3d6b3cdf166c8952ac2cd59b57b51676">Clear</a>();
<a name="l00232"></a>00232                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac5478d4213eaa78e3a725b45868c809d">Reset</a>();
<a name="l00233"></a>00233                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00234"></a>00234                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9604c2f105f571246c561c539881d4fc">GenprogressBar</a>-&gt;Visible=<span class="keyword">true</span>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==1) <span class="comment">//Gaussian</span>
<a name="l00237"></a>00237                 {
<a name="l00238"></a>00238 
<a name="l00239"></a>00239                         <a class="code" href="class_gauss.html">Gauss</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_gauss.html">Gauss</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00240"></a>00240                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00241"></a>00241                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);
<a name="l00242"></a>00242 
<a name="l00243"></a>00243                 }
<a name="l00244"></a>00244                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==4) <span class="comment">//Castep</span>
<a name="l00245"></a>00245                 {
<a name="l00246"></a>00246                         <a class="code" href="class_castep.html">Castep</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_castep.html">Castep</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00247"></a>00247                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00248"></a>00248                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);
<a name="l00249"></a>00249                 }
<a name="l00250"></a>00250                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==3) <span class="comment">//xyz</span>
<a name="l00251"></a>00251                 {
<a name="l00252"></a>00252                         
<a name="l00253"></a>00253                         <a class="code" href="class_spinach_g_u_i_1_1_x_y_z.html">XYZ</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_x_y_z.html">XYZ</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00254"></a>00254                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00255"></a>00255                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257                 }
<a name="l00258"></a>00258                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==2) <span class="comment">//mol</span>
<a name="l00259"></a>00259                 {
<a name="l00260"></a>00260                         <a class="code" href="class_m_o_l.html">MOL</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_m_o_l.html">MOL</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00261"></a>00261                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00262"></a>00262                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);
<a name="l00263"></a>00263                 }
<a name="l00264"></a>00264                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==5) <span class="comment">//Orca</span>
<a name="l00265"></a>00265                 {
<a name="l00266"></a>00266                         <a class="code" href="class_orca.html">Orca</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_orca.html">Orca</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00267"></a>00267                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00268"></a>00268                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);
<a name="l00269"></a>00269                 }
<a name="l00270"></a>00270                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==6) <span class="comment">//ADF</span>
<a name="l00271"></a>00271                 {
<a name="l00272"></a>00272                         <a class="code" href="class_a_d_f.html">ADF</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_a_d_f.html">ADF</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00273"></a>00273                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00274"></a>00274                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);     
<a name="l00275"></a>00275                         
<a name="l00276"></a>00276                 }
<a name="l00277"></a>00277                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==7) <span class="comment">//GAMESS</span>
<a name="l00278"></a>00278                 {
<a name="l00279"></a>00279                         <a class="code" href="class_g_a_m_e_s_s.html">GAMESS</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_g_a_m_e_s_s.html">GAMESS</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00280"></a>00280                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00281"></a>00281                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);     
<a name="l00282"></a>00282                 }
<a name="l00283"></a>00283                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FilterIndex==8) <span class="comment">//COSMOS</span>
<a name="l00284"></a>00284                 {
<a name="l00285"></a>00285                         <a class="code" href="class_c_o_s_m_o_s.html">COSMOS</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_c_o_s_m_o_s.html">COSMOS</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09e68e25678cd17e4acd9457101ad7d8">OpenFilesDialog</a>-&gt;FileName, <span class="keyword">gcnew</span> <a class="code" href="class_model.html">Model</a>());
<a name="l00286"></a>00286                         this-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00287"></a>00287                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aea0fe5219188d6c78acde368eeedd555">ImportbackgroundWorker</a>-&gt;RunWorkerAsync(OpenedFile);
<a name="l00288"></a>00288                 }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         
<a name="l00291"></a>00291                 
<a name="l00292"></a>00292         };
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab42879460d808810ce4d58dbc8dbe2d9">00297</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab42879460d808810ce4d58dbc8dbe2d9">SpinachGUI::MainForm::LoadModel</a>() 
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299 
<a name="l00300"></a>00300         <span class="keywordtype">int</span> line;
<a name="l00301"></a>00301     <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l00302"></a>00302                 {
<a name="l00303"></a>00303                  <span class="comment">//Number of line</span>
<a name="l00304"></a>00304                  line=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Count-1;
<a name="l00305"></a>00305                  <span class="comment">//Add a new line</span>
<a name="l00306"></a>00306              <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Add();
<a name="l00307"></a>00307                  <span class="comment">//Set line readable</span>
<a name="l00308"></a>00308                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[1,line]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00309"></a>00309                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,line]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00310"></a>00310                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[5,line]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00311"></a>00311                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[6,line]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00312"></a>00312                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[7,line]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00313"></a>00313                  <span class="comment">//Set ID, Label, and element</span>
<a name="l00314"></a>00314                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[0,line]-&gt;Value=((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;getID();
<a name="l00315"></a>00315                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[1,line]-&gt;Value=((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;Label;
<a name="l00316"></a>00316                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[2,line]-&gt;Value=((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;isotope-&gt;Element;
<a name="l00317"></a>00317              
<a name="l00318"></a>00318                  <span class="comment">//Create the dropdown menu for the mass of the elements</span>
<a name="l00319"></a>00319                  DataGridViewComboBoxCell^ combobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l00320"></a>00320                  combobox-&gt;Items-&gt;AddRange(<a class="code" href="class_isotopes.html#a2fa7827baf610891e37762252c81151d" title="Function for returning all the possible mass numbers of an element. Used for dropmenu.">Isotopes::getAllIsotopeMasses</a>(Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[2,line]-&gt;Value)));
<a name="l00321"></a>00321                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,line]=combobox;
<a name="l00322"></a>00322                  <span class="comment">//Set Mass</span>
<a name="l00323"></a>00323                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;isotope-&gt;Mass);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 
<a name="l00326"></a>00326                  <span class="comment">//Import the color of the isotope from each atom</span>
<a name="l00327"></a>00327                  Color^ acolor=<span class="keyword">gcnew</span> Color;
<a name="l00328"></a>00328                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,line]-&gt;Style-&gt;BackColor=acolor-&gt;FromArgb(255,
<a name="l00329"></a>00329                                               (<span class="keywordtype">int</span>)(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;isotope-&gt;Red*255),
<a name="l00330"></a>00330                                               (<span class="keywordtype">int</span>)(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;isotope-&gt;Green*255),
<a name="l00331"></a>00331                                               (<span class="keywordtype">int</span>)(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;isotope-&gt;Blue*255));
<a name="l00332"></a>00332                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,line]-&gt;Style-&gt;SelectionBackColor=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,i]-&gt;Style-&gt;BackColor;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334                  <span class="comment">//Import the coordinates of the atom</span>
<a name="l00335"></a>00335                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[5,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;X);
<a name="l00336"></a>00336                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[6,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;Y);
<a name="l00337"></a>00337                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[7,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;Z);
<a name="l00338"></a>00338                 }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0bbac93cc93d09e0a963cd011b407b36">treeView_RefFrames_Update</a>();
<a name="l00341"></a>00341         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4978dc4d55a0eef52f541b2bb13d2c23">DataGridView_Interactions_Update</a>();
<a name="l00342"></a>00342 
<a name="l00343"></a>00343         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a22e7bcaaad16c2edbac9a953a1ede7db">ZoomtoFillScreen</a>();
<a name="l00344"></a>00344          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   
<a name="l00347"></a>00347                 
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a48d42e90210aec3b233361e271916f20">00350</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a48d42e90210aec3b233361e271916f20">SpinachGUI::MainForm::UpdateCoordinates</a>() 
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352 
<a name="l00353"></a>00353                 <span class="keywordtype">int</span> line;
<a name="l00354"></a>00354     <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l00355"></a>00355                 {
<a name="l00356"></a>00356                  <span class="comment">//Number of line</span>
<a name="l00357"></a>00357                  line=i-1;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359                  <span class="comment">//Import the coordinates of the atom</span>
<a name="l00360"></a>00360                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[5,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;X);
<a name="l00361"></a>00361                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[6,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;Y);
<a name="l00362"></a>00362                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[7,line]-&gt;Value=Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[i])-&gt;Z);
<a name="l00363"></a>00363                 }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0bbac93cc93d09e0a963cd011b407b36">treeView_RefFrames_Update</a>();
<a name="l00366"></a>00366         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4978dc4d55a0eef52f541b2bb13d2c23">DataGridView_Interactions_Update</a>();
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a22e7bcaaad16c2edbac9a953a1ede7db">ZoomtoFillScreen</a>();
<a name="l00369"></a>00369          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 
<a name="l00373"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a783e6965b078cdd737c16becabbf41dd">00373</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a783e6965b078cdd737c16becabbf41dd">SpinachGUI::MainForm::SaveAsButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00374"></a>00374 {
<a name="l00375"></a>00375         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;Filter=<span class="stringliteral">&quot;SpinXML File|*.sxml&quot;</span>;
<a name="l00376"></a>00376         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName=Path::GetFileNameWithoutExtension(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>)+<span class="stringliteral">&quot;.sxml&quot;</span>;
<a name="l00377"></a>00377         <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l00378"></a>00378         {
<a name="l00379"></a>00379                 <a class="code" href="class_spin_x_m_l.html">SpinXML</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_spin_x_m_l.html">SpinXML</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName,IOSpinSystem::FilterType::EXPORT, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName;
<a name="l00382"></a>00382                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>=Path::GetFileName(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>);
<a name="l00383"></a>00383                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9a74299d9d427352e42cb18c07d6ad35">ModelFileName</a>-&gt;Text=<span class="stringliteral">&quot;Imported File: (None)&quot;</span>;
<a name="l00384"></a>00384                 this-&gt;Text=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>+<span class="stringliteral">&quot;- Spinach GUI &quot;</span>+SpinachGUIver;
<a name="l00385"></a>00385                 OpenedFile-&gt;<a class="code" href="class_spin_x_m_l.html#a2778e189bf52993737e5ad1134175778">WriteFile</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l00386"></a>00386                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0d61b7fd1b0a11cf21cb61ccf3ccfae3">Savebutton</a>-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00387"></a>00387             <span class="keywordflow">if</span>(Text-&gt;Contains(<span class="stringliteral">&quot;*&quot;</span>)) this-&gt;Text=this-&gt;Text-&gt;Replace(<span class="stringliteral">&quot; *&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         };
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a272c9f421fcd915630de7a76f9aa76a1">00394</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a272c9f421fcd915630de7a76f9aa76a1">SpinachGUI::MainForm::Savebutton_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>!=<span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>!=<span class="stringliteral">&quot;&quot;</span>)
<a name="l00397"></a>00397         {
<a name="l00398"></a>00398                 <a class="code" href="class_spin_x_m_l.html">SpinXML</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_spin_x_m_l.html">SpinXML</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>,IOSpinSystem::FilterType::EXPORT, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l00399"></a>00399                 OpenedFile-&gt;<a class="code" href="class_spin_x_m_l.html#a2778e189bf52993737e5ad1134175778">WriteFile</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l00400"></a>00400                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0d61b7fd1b0a11cf21cb61ccf3ccfae3">Savebutton</a>-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00401"></a>00401             <span class="keywordflow">if</span>(Text-&gt;Contains(<span class="stringliteral">&quot;*&quot;</span>)) this-&gt;Text=this-&gt;Text-&gt;Replace(<span class="stringliteral">&quot; *&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403         <span class="keywordflow">else</span>
<a name="l00404"></a>00404         {
<a name="l00405"></a>00405                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;Filter=<span class="stringliteral">&quot;SpinXML File|*.sxml&quot;</span>;
<a name="l00406"></a>00406                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName=Path::GetFileNameWithoutExtension(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>)+<span class="stringliteral">&quot;.sxml&quot;</span>;
<a name="l00407"></a>00407                 <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l00408"></a>00408                 {
<a name="l00409"></a>00409                         <a class="code" href="class_spin_x_m_l.html">SpinXML</a>^ OpenedFile= <span class="keyword">gcnew</span> <a class="code" href="class_spin_x_m_l.html">SpinXML</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName,IOSpinSystem::FilterType::EXPORT, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l00410"></a>00410                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName;
<a name="l00411"></a>00411                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>=Path::GetFileName(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>);
<a name="l00412"></a>00412                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9a74299d9d427352e42cb18c07d6ad35">ModelFileName</a>-&gt;Text=<span class="stringliteral">&quot;Imported File: (None)&quot;</span>;
<a name="l00413"></a>00413                         this-&gt;Text=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>+<span class="stringliteral">&quot;- Spinach GUI &quot;</span>+SpinachGUIver;
<a name="l00414"></a>00414                         OpenedFile-&gt;<a class="code" href="class_spin_x_m_l.html#a2778e189bf52993737e5ad1134175778">WriteFile</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l00415"></a>00415                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0d61b7fd1b0a11cf21cb61ccf3ccfae3">Savebutton</a>-&gt;Enabled=<span class="keyword">false</span>;
<a name="l00416"></a>00416                 <span class="keywordflow">if</span>(Text-&gt;Contains(<span class="stringliteral">&quot;*&quot;</span>)) this-&gt;Text=this-&gt;Text-&gt;Replace(<span class="stringliteral">&quot; *&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00417"></a>00417                 };
<a name="l00418"></a>00418         };
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00422"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac11ec8f9fdc7a81c693240bfde10d4da">00422</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac11ec8f9fdc7a81c693240bfde10d4da">SpinachGUI::MainForm::AboutButton_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00423"></a>00423 {
<a name="l00424"></a>00424         <a class="code" href="class_spinach_g_u_i_1_1_about.html">About</a>^ aboutdialog = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_about.html">About</a>();     
<a name="l00425"></a>00425         aboutdialog-&gt;ShowDialog();
<a name="l00426"></a>00426 }
<a name="l00427"></a>00427 
<a name="l00428"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed7066519a29eb5ba02cc30644131903">00428</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed7066519a29eb5ba02cc30644131903">SpinachGUI::MainForm::Printbutton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00429"></a>00429 {
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="keywordflow">if</span> ( <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5328c6ff2b256fd039e6042461b10954">printDialog1</a>-&gt;ShowDialog() == ::DialogResult::OK )
<a name="l00432"></a>00432         {
<a name="l00433"></a>00433                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af794fd249cfdcc868db7d611ca940058">DocumenttoPrint</a>-&gt;Print();
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad09e90c500cc8b99550d688e0f0a3ebb">00437</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad09e90c500cc8b99550d688e0f0a3ebb">SpinachGUI::MainForm::DocumenttoPrint_PrintPage</a>(System::Object^  sender, System::Drawing::Printing::PrintPageEventArgs^  e) 
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439         e-&gt;Graphics-&gt;DrawImage(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac5d6bf8aa731670ca6444773ed40db8a" title="Export the contens of the OpenGL panel in a bitmap file.">Save_BMP</a>(), 0, 0);
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00442"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acdfa5f2f1fa6e0bedf45af734395180c">00442</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acdfa5f2f1fa6e0bedf45af734395180c">SpinachGUI::MainForm::checkBoxAtomID_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00443"></a>00443 {
<a name="l00444"></a>00444         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aea9bc7ab4d1f1cb9f91b2fa4fd9d7d28" title="Flag for showing ID of all atoms.">AtomIDFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a272045c2348019eae8a3d7e2d3b15896">checkBoxAtomID</a>-&gt;Checked;
<a name="l00445"></a>00445          <span class="comment">//OpenGL-&gt;Render();</span>
<a name="l00446"></a>00446         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ac9b19bb44ce177521e4a9873919e99e6">UpdateType::ATOMS</a>);
<a name="l00447"></a>00447 }<span class="comment"></span>
<a name="l00448"></a>00448 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00449"></a>00449 <span class="comment"></span><span class="comment">//Export</span>
<a name="l00450"></a>00450 
<a name="l00451"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a74a6fc6b048bef74768af8fb6bb9612d">00451</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a74a6fc6b048bef74768af8fb6bb9612d">SpinachGUI::MainForm::ExportBitmap_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00452"></a>00452 {
<a name="l00453"></a>00453         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;Filter=<span class="stringliteral">&quot;Bitmap File|*.bmp&quot;</span>;
<a name="l00454"></a>00454         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>+<span class="stringliteral">&quot;.bmp&quot;</span>;
<a name="l00455"></a>00455         <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l00456"></a>00456         {
<a name="l00457"></a>00457                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac5d6bf8aa731670ca6444773ed40db8a" title="Export the contens of the OpenGL panel in a bitmap file.">Save_BMP</a>()-&gt;Save(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4fbf3d4996d9f847ef14fc5db2e18291">SaveFilesDialog</a>-&gt;FileName, System::Drawing::Imaging::ImageFormat::Bmp);
<a name="l00458"></a>00458         }
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#affcc82427a2ee948f2d0e906c2ec6c64">00461</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#affcc82427a2ee948f2d0e906c2ec6c64">SpinachGUI::MainForm::ExportEasyspin_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00462"></a>00462 {
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 
<a name="l00465"></a>00465         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>())
<a name="l00466"></a>00466         {
<a name="l00467"></a>00467                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab73baf2704690c940479ce829d0ca154">easyspin</a>-&gt;<a class="code" href="class_spinach_g_u_i_1_1_easy_spin.html#ac124e4cea1a94f53892b7f56b26d41fc" title="Initializator of EasySpin class.">EasySpin_Initialization</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>);
<a name="l00468"></a>00468                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab73baf2704690c940479ce829d0ca154">easyspin</a>-&gt;ShowDialog();
<a name="l00469"></a>00469         }
<a name="l00470"></a>00470         <span class="keywordflow">else</span>
<a name="l00471"></a>00471                 MessageBox::Show(<span class="stringliteral">&quot;No electrons in  the system. Easyspin requires at least one&quot;</span>+ 
<a name="l00472"></a>00472                 <span class="stringliteral">&quot; electron in the system. Create one in order to export to Easyspin format.&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00473"></a>00473                 MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 
<a name="l00476"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab3746fa437a5f7216c956567ad3d850e">00476</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab3746fa437a5f7216c956567ad3d850e">SpinachGUI::MainForm::ExportSpinEvolution_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00477"></a>00477 {
<a name="l00478"></a>00478 
<a name="l00479"></a>00479         <span class="keywordflow">if</span>(!<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>())
<a name="l00480"></a>00480         {
<a name="l00481"></a>00481                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a015184d531a720ec874425923d502076" title="Property Count for giving the number of atom in the collection.">Count</a>&gt;0)
<a name="l00482"></a>00482                 {
<a name="l00483"></a>00483                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac713ad7e3f865bd8cc699289c26e9340">spinEvolution</a>-&gt;<a class="code" href="class_spinach_g_u_i_1_1_spin_evolution.html#a3bb3f92a690d20375bff599fcbab3abe" title="Initializator of Spinevolution class.">Initialize_SpinEvolution</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>);
<a name="l00484"></a>00484                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac713ad7e3f865bd8cc699289c26e9340">spinEvolution</a>-&gt;ShowDialog();
<a name="l00485"></a>00485                 }
<a name="l00486"></a>00486                 <span class="keywordflow">else</span>
<a name="l00487"></a>00487                         MessageBox::Show(<span class="stringliteral">&quot;No atoms in system. Add one in order to export to Simpson format.&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00488"></a>00488                         MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         }
<a name="l00491"></a>00491         <span class="keywordflow">else</span>
<a name="l00492"></a>00492                 MessageBox::Show(<span class="stringliteral">&quot;Electrons are not supported by SpinEvolution. Delete all electrons&quot;</span>+
<a name="l00493"></a>00493                 <span class="stringliteral">&quot; from the spin system to enable export into SpinEvolution format.&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00494"></a>00494                 MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00497"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa475c49fcac31871e9882b9586a6d76a">00497</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa475c49fcac31871e9882b9586a6d76a">SpinachGUI::MainForm::ExportSpinach_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bf540019235a3037224e8661155154c">spinach</a>-&gt;<a class="code" href="class_spinach_g_u_i_1_1_spinach.html#a080d49d5cd5b6ca616595939606ef818" title="Initializator of Spinach class.">Spinach_Initialization</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>);
<a name="l00500"></a>00500         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bf540019235a3037224e8661155154c">spinach</a>-&gt;ShowDialog();
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#abbc9ded8125833e92309e51e109cc3c4">00503</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#abbc9ded8125833e92309e51e109cc3c4">SpinachGUI::MainForm::ExportSimpson_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505         <span class="keywordflow">if</span>(!<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>())
<a name="l00506"></a>00506         {
<a name="l00507"></a>00507                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a015184d531a720ec874425923d502076" title="Property Count for giving the number of atom in the collection.">Count</a>&gt;0)
<a name="l00508"></a>00508                 {
<a name="l00509"></a>00509 
<a name="l00510"></a>00510                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5576a0a2b5dbc331dc759a4e0a18a293">simpson</a>-&gt;<a class="code" href="class_spinach_g_u_i_1_1_simpson.html#a758e7fbf97428e8d36375ce76b72dd42" title="Initializator of Simpson class.">Initialize_Simpson</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>);
<a name="l00511"></a>00511                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5576a0a2b5dbc331dc759a4e0a18a293">simpson</a>-&gt;ShowDialog();
<a name="l00512"></a>00512                 }
<a name="l00513"></a>00513                 <span class="keywordflow">else</span>
<a name="l00514"></a>00514                         MessageBox::Show(<span class="stringliteral">&quot;No atoms in system. Add one in order to export to Simpson format.&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00515"></a>00515                         MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00516"></a>00516         }
<a name="l00517"></a>00517         <span class="keywordflow">else</span>
<a name="l00518"></a>00518                 MessageBox::Show(<span class="stringliteral">&quot;Electrons are not supported by Simpson. Delete all electrons&quot;</span>+
<a name="l00519"></a>00519                 <span class="stringliteral">&quot; from the spin system to enable export into Simpson format.&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00520"></a>00520                 MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00521"></a>00521 }
<a name="l00522"></a>00522 <span class="comment"></span>
<a name="l00523"></a>00523 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00524"></a>00524 <span class="comment"></span><span class="comment">// Edit Datagridview for Atoms</span>
<a name="l00525"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5d00e3d63458ffadbcc21c52aa6b7f64">00525</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5d00e3d63458ffadbcc21c52aa6b7f64">SpinachGUI::MainForm::dataGridView1_CellEndEdit</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) 
<a name="l00526"></a>00526 {
<a name="l00527"></a>00527         <span class="keywordtype">int</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a28977b388063a3b0275f71b270af2b66">AtomID</a>;
<a name="l00528"></a>00528         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==2 &amp;&amp;
<a name="l00529"></a>00529                 (String^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value!=<span class="stringliteral">&quot;&quot;</span> ) <span class="comment">//Change Element</span>
<a name="l00530"></a>00530         {
<a name="l00531"></a>00531                 
<a name="l00532"></a>00532                 <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab33fc5f6e7adfb0f31c00432c2abf255">insertAtom</a>) <span class="comment">//insert Atom</span>
<a name="l00533"></a>00533                 {
<a name="l00534"></a>00534                         <span class="comment">//Creat an atom and add in the collection in order to take ID</span>
<a name="l00535"></a>00535                         <a class="code" href="class_atom.html">Atom</a>^ nAtom=<span class="keyword">gcnew</span> <a class="code" href="class_atom.html">Atom</a>();
<a name="l00536"></a>00536                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a5fc80506216705ab642e1ea842a16d8c">Add</a>(nAtom);
<a name="l00537"></a>00537                         <span class="comment">//Atom ID</span>
<a name="l00538"></a>00538                         dataGridView1[0,e-&gt;RowIndex]-&gt;Value=nAtom-&gt;<a class="code" href="class_atom.html#a542c13cf22cab7bebec4f53198586434" title="Getter for the atom ID.">getID</a>();
<a name="l00539"></a>00539                         AtomID=nAtom-&gt;<a class="code" href="class_atom.html#a542c13cf22cab7bebec4f53198586434" title="Getter for the atom ID.">getID</a>();
<a name="l00540"></a>00540 
<a name="l00541"></a>00541                         <span class="comment">//Unlock Atom table cells</span>
<a name="l00542"></a>00542                         dataGridView1[1,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00543"></a>00543                         dataGridView1[3,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00544"></a>00544                         dataGridView1[5,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00545"></a>00545                         dataGridView1[6,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00546"></a>00546                         dataGridView1[7,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548                         <span class="comment">//Atom Coordinates</span>
<a name="l00549"></a>00549                         dataGridView1[5,e-&gt;RowIndex]-&gt;Value=
<a name="l00550"></a>00550                                 Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;X);
<a name="l00551"></a>00551                         dataGridView1[6,e-&gt;RowIndex]-&gt;Value=
<a name="l00552"></a>00552                                 Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;Y);
<a name="l00553"></a>00553                         dataGridView1[7,e-&gt;RowIndex]-&gt;Value=
<a name="l00554"></a>00554                                 Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;Z);
<a name="l00555"></a>00555                 }
<a name="l00556"></a>00556                 <span class="keywordflow">else</span> AtomID=Convert::ToInt32(dataGridView1[0,e-&gt;RowIndex]-&gt;Value);
<a name="l00557"></a>00557 
<a name="l00558"></a>00558                 <span class="comment">//Select isotope</span>
<a name="l00559"></a>00559                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;isotope=
<a name="l00560"></a>00560                         <a class="code" href="class_isotopes.html#a5d8772910912cbc6667f066a2a8ef531" title="Function for finding the isotope when one of the element, atom number or mass is given.">Isotopes::FindIsotope</a>((String^)dataGridView1[2,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Value,0, 0);
<a name="l00561"></a>00561                 
<a name="l00562"></a>00562                 <span class="comment">//Create Masses of isotope dropdown menu</span>
<a name="l00563"></a>00563         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a38028f189bb68e1ac0b429c3091231d5">Column5</a>-&gt;Items-&gt;Clear();
<a name="l00564"></a>00564                 DataGridViewComboBoxCell^ combobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l00565"></a>00565 
<a name="l00566"></a>00566                 <span class="comment">//Set the values for the masses dropdown menu</span>
<a name="l00567"></a>00567                 combobox-&gt;Items-&gt;AddRange(
<a name="l00568"></a>00568                         <a class="code" href="class_isotopes.html#a2fa7827baf610891e37762252c81151d" title="Function for returning all the possible mass numbers of an element. Used for dropmenu.">Isotopes::getAllIsotopeMasses</a>((String^)dataGridView1[2,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Value));
<a name="l00569"></a>00569                 dataGridView1[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]=combobox;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571                 <span class="comment">//Set the value for the mass cell</span>
<a name="l00572"></a>00572                 dataGridView1[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Value=combobox-&gt;Items[0];
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 
<a name="l00575"></a>00575                 <span class="comment">//Set Atom-Isotope Color to cell</span>
<a name="l00576"></a>00576                 Color^ acolor=<span class="keyword">gcnew</span> Color;
<a name="l00577"></a>00577                 dataGridView1[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Style-&gt;BackColor=acolor-&gt;FromArgb(255,
<a name="l00578"></a>00578                         (<span class="keywordtype">int</span>)(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;isotope-&gt;Red*255),
<a name="l00579"></a>00579                         (<span class="keywordtype">int</span>)(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;isotope-&gt;Green*255),
<a name="l00580"></a>00580                         (<span class="keywordtype">int</span>)(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;isotope-&gt;Blue*255));
<a name="l00581"></a>00581                 dataGridView1[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Style-&gt;SelectionBackColor=
<a name="l00582"></a>00582                         dataGridView1[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Style-&gt;BackColor;
<a name="l00583"></a>00583                 
<a name="l00584"></a>00584         }
<a name="l00585"></a>00585         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;ColumnIndex==3) <span class="comment">//Change Mass</span>
<a name="l00586"></a>00586         {
<a name="l00587"></a>00587           AtomID=Convert::ToInt32(dataGridView1[0,e-&gt;RowIndex]-&gt;Value);
<a name="l00588"></a>00588       ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;isotope=
<a name="l00589"></a>00589                         <a class="code" href="class_isotopes.html#a5d8772910912cbc6667f066a2a8ef531" title="Function for finding the isotope when one of the element, atom number or mass is given.">Isotopes::FindIsotope</a>((String^)dataGridView1[2,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Value,0,
<a name="l00590"></a>00590                                                Convert::ToInt32(dataGridView1[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>]-&gt;Value));
<a name="l00591"></a>00591         }
<a name="l00592"></a>00592         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;ColumnIndex==1) <span class="comment">//Change Label</span>
<a name="l00593"></a>00593         {
<a name="l00594"></a>00594           AtomID=Convert::ToInt32(dataGridView1[0,e-&gt;RowIndex]-&gt;Value);
<a name="l00595"></a>00595       ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;Label=
<a name="l00596"></a>00596                                                                                 ((String^)dataGridView1[1,e-&gt;RowIndex]-&gt;Value);
<a name="l00597"></a>00597         }
<a name="l00598"></a>00598         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(e-&gt;ColumnIndex&gt;4)  <span class="comment">//Change Coordinates</span>
<a name="l00599"></a>00599         {
<a name="l00600"></a>00600                 <span class="keywordtype">double</span> result;
<a name="l00601"></a>00601                 AtomID=Convert::ToInt32(dataGridView1[0,e-&gt;RowIndex]-&gt;Value);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603                 <span class="comment">//Can change coordinates only for non electrons</span>
<a name="l00604"></a>00604                 <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;isotope-&gt;Element!=<span class="stringliteral">&quot;e&quot;</span>)
<a name="l00605"></a>00605                 {
<a name="l00606"></a>00606                         <span class="keywordflow">if</span>(Double::TryParse((String^)dataGridView1[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value, result))
<a name="l00607"></a>00607                         {
<a name="l00608"></a>00608                                 <span class="keywordflow">switch</span>(e-&gt;ColumnIndex)
<a name="l00609"></a>00609                                 {
<a name="l00610"></a>00610                                         <span class="keywordflow">break</span>;
<a name="l00611"></a>00611                                 <span class="keywordflow">case</span> 5:
<a name="l00612"></a>00612                                         ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;X=
<a name="l00613"></a>00613                                                 Convert::ToDouble((String^)dataGridView1[5,e-&gt;RowIndex]-&gt;Value);
<a name="l00614"></a>00614                                         <span class="keywordflow">break</span>;
<a name="l00615"></a>00615                                 <span class="keywordflow">case</span> 6:
<a name="l00616"></a>00616                                         ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;Y=
<a name="l00617"></a>00617                                                 Convert::ToDouble((String^)dataGridView1[6,e-&gt;RowIndex]-&gt;Value);                                        
<a name="l00618"></a>00618                                         <span class="keywordflow">break</span>;
<a name="l00619"></a>00619                                 <span class="keywordflow">case</span> 7:
<a name="l00620"></a>00620                                         ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[AtomID])-&gt;Z=
<a name="l00621"></a>00621                                                 Convert::ToDouble((String^)dataGridView1[7,e-&gt;RowIndex]-&gt;Value);                                        
<a name="l00622"></a>00622                                         <span class="keywordflow">break</span>;
<a name="l00623"></a>00623                                 };
<a name="l00624"></a>00624                         } 
<a name="l00625"></a>00625                         <span class="keywordflow">else</span>
<a name="l00626"></a>00626                         {
<a name="l00627"></a>00627                                 MessageBox::Show(<span class="stringliteral">&quot;Wrong Number Format for Coordinates&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00628"></a>00628                                         MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00629"></a>00629                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aacd027baa0c8e1b29c56413e9af09620">SetColumnIndex</a>^ method= <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aacd027baa0c8e1b29c56413e9af09620">SetColumnIndex</a>(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8335eded6d0ea217ee8a4bca8ec66e1b">MainForm::DelegateMethod</a>);
<a name="l00630"></a>00630                                 dataGridView1-&gt;BeginInvoke(method,e-&gt;ColumnIndex,e-&gt;RowIndex);
<a name="l00631"></a>00631                         }
<a name="l00632"></a>00632                 }
<a name="l00633"></a>00633 
<a name="l00634"></a>00634         }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <span class="comment">//Change the color of the cell back to original color</span>
<a name="l00637"></a>00637         dataGridView1[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Style-&gt;BackColor=System::Drawing::SystemColors::Window;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639         <span class="comment">//Update the datagridview2 with the updated atom properties</span>
<a name="l00640"></a>00640         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();
<a name="l00641"></a>00641         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4978dc4d55a0eef52f541b2bb13d2c23">DataGridView_Interactions_Update</a>();
<a name="l00642"></a>00642    
<a name="l00643"></a>00643         <span class="comment">//Update the OpenGL screen</span>
<a name="l00644"></a>00644         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a22e7bcaaad16c2edbac9a953a1ede7db">ZoomtoFillScreen</a>();
<a name="l00645"></a>00645          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l00646"></a>00646 }
<a name="l00647"></a>00647 
<a name="l00648"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8335eded6d0ea217ee8a4bca8ec66e1b">00648</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8335eded6d0ea217ee8a4bca8ec66e1b">SpinachGUI::MainForm::DelegateMethod</a>(<span class="keywordtype">int</span> columnIndex, <span class="keywordtype">int</span> rowIndex)
<a name="l00649"></a>00649 {
<a name="l00650"></a>00650         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;CurrentCell = <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[columnIndex,rowIndex];
<a name="l00651"></a>00651         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;BeginEdit(<span class="keyword">true</span>);
<a name="l00652"></a>00652 }
<a name="l00653"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acc3dbecd98fdcb35b7160b5a4d4a5f44">00653</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acc3dbecd98fdcb35b7160b5a4d4a5f44">SpinachGUI::MainForm::Delegate2Method</a>(<span class="keywordtype">int</span> columnIndex, <span class="keywordtype">int</span> rowIndex)
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;CurrentCell = <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[columnIndex,rowIndex];
<a name="l00656"></a>00656         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;EndEdit();
<a name="l00657"></a>00657 }
<a name="l00658"></a>00658 
<a name="l00659"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a8ce2fbcccfb7c5a6d67e30dcc6c69">00659</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a8ce2fbcccfb7c5a6d67e30dcc6c69">SpinachGUI::MainForm::dataGridView1_CellBeginEdit</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellCancelEventArgs^  e) 
<a name="l00660"></a>00660 { 
<a name="l00661"></a>00661  <span class="comment">//Set the current row and column of the cell</span>
<a name="l00662"></a>00662  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>=e-&gt;ColumnIndex;
<a name="l00663"></a>00663  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa07f7b716ce80f952a9732208cae5761">datagridview1_row</a>=e-&gt;RowIndex;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665  <span class="comment">//Highlight the current cell</span>
<a name="l00666"></a>00666  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Style-&gt;BackColor=System::Drawing::SystemColors::Highlight;
<a name="l00667"></a>00667  
<a name="l00668"></a>00668  <span class="keywordflow">if</span> (e-&gt;ColumnIndex==2) <span class="comment">//Choose of isotope</span>
<a name="l00669"></a>00669  {
<a name="l00670"></a>00670          <span class="comment">//If isotope column empty, it means a new atom is inserted</span>
<a name="l00671"></a>00671          <span class="keywordflow">if</span> ((String^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value==<span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab33fc5f6e7adfb0f31c00432c2abf255">insertAtom</a>=<span class="keyword">true</span>;
<a name="l00672"></a>00672          <span class="keywordflow">else</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab33fc5f6e7adfb0f31c00432c2abf255">insertAtom</a>=<span class="keyword">false</span>;
<a name="l00673"></a>00673  };
<a name="l00674"></a>00674 
<a name="l00675"></a>00675  <span class="comment">//Set the current cell for coordinates</span>
<a name="l00676"></a>00676  <span class="keywordflow">if</span> (e-&gt;ColumnIndex&gt;4 )  DataGridViewCell^ currentCell=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[e-&gt;ColumnIndex,e-&gt;RowIndex];
<a name="l00677"></a>00677 }
<a name="l00678"></a>00678 <span class="comment">//------------------------------</span>
<a name="l00679"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a82fb920136d580a5f895914f3949c42c">00679</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a82fb920136d580a5f895914f3949c42c">SpinachGUI::MainForm::dataGridView1_EditingControlShowing</a>(System::Object^  sender, System::Windows::Forms::DataGridViewEditingControlShowingEventArgs^  e) 
<a name="l00680"></a>00680 {
<a name="l00681"></a>00681         <span class="comment">//For coordinates columns set keypress event handler</span>
<a name="l00682"></a>00682         <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>&gt;4)
<a name="l00683"></a>00683         {
<a name="l00684"></a>00684                 TextBox^ txtbox = (TextBox^)(e-&gt;Control);
<a name="l00685"></a>00685                 <span class="keywordflow">if</span> (txtbox != <span class="keyword">nullptr</span>) txtbox-&gt;KeyPress += 
<a name="l00686"></a>00686                         <span class="keyword">gcnew</span> KeyPressEventHandler(<span class="keyword">this</span>,&amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0faa12c512eac1e0aa4531401991b7ac">MainForm::txtbox_KeyPress</a>);
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688         <span class="comment">//For dropmenu columns set selectedindexchanged handler</span>
<a name="l00689"></a>00689         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>==2 || <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>==3 )
<a name="l00690"></a>00690         {
<a name="l00691"></a>00691                 ComboBox^ cmbbox = (ComboBox^)(e-&gt;Control);
<a name="l00692"></a>00692                 <span class="keywordflow">if</span> (cmbbox != <span class="keyword">nullptr</span>) cmbbox-&gt;SelectedIndexChanged -= 
<a name="l00693"></a>00693                         <span class="keyword">gcnew</span> System::EventHandler( <span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a464026093837e801f551adca69228f61">MainForm::cmbbox_SelectedIndexChanged</a> );
<a name="l00694"></a>00694                 <span class="keywordflow">if</span> (cmbbox != <span class="keyword">nullptr</span>) cmbbox-&gt;SelectedIndexChanged += 
<a name="l00695"></a>00695                         <span class="keyword">gcnew</span> System::EventHandler( <span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a464026093837e801f551adca69228f61">MainForm::cmbbox_SelectedIndexChanged</a> );
<a name="l00696"></a>00696         };
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00699"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0faa12c512eac1e0aa4531401991b7ac">00699</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0faa12c512eac1e0aa4531401991b7ac">SpinachGUI::MainForm::txtbox_KeyPress</a>(System::Object^  sender, System::Windows::Forms::KeyPressEventArgs^  e) 
<a name="l00700"></a>00700 {
<a name="l00701"></a>00701  <span class="comment">// For coordinates columns, determine whether the keystroke is a number.</span>
<a name="l00702"></a>00702  <span class="keywordflow">if</span> (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>&gt;4 &amp;&amp; !Char::IsNumber(e-&gt;KeyChar) &amp;&amp; e-&gt;KeyChar != <span class="charliteral">&#39;\b&#39;</span> &amp;&amp;
<a name="l00703"></a>00703          e-&gt;KeyChar != <span class="charliteral">&#39;.&#39;</span> &amp;&amp; e-&gt;KeyChar != <span class="charliteral">&#39;-&#39;</span>) e-&gt;Handled = <span class="keyword">true</span>;
<a name="l00704"></a>00704  }
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a464026093837e801f551adca69228f61">00706</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a464026093837e801f551adca69228f61">SpinachGUI::MainForm::cmbbox_SelectedIndexChanged</a>(System::Object^  sender, EventArgs^ e) 
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708         <span class="comment">/*</span>
<a name="l00709"></a>00709 <span class="comment">        ComboBox^ cmbbox = (ComboBox^)sender;</span>
<a name="l00710"></a>00710 <span class="comment">        dataGridView1[datagridview1_column,datagridview1_row]-&gt;Value=cmbbox-&gt;SelectedItem-&gt;ToString();</span>
<a name="l00711"></a>00711 <span class="comment">        cmbbox-&gt;SelectedItem=dataGridView1[datagridview1_column,datagridview1_row]-&gt;Value;</span>
<a name="l00712"></a>00712 <span class="comment"></span>
<a name="l00713"></a>00713 <span class="comment">        //Create Combo box for mass number of isotopes after choosing element</span>
<a name="l00714"></a>00714 <span class="comment">        if(datagridview1_column==2 &amp;&amp; cmbbox-&gt;SelectedItem!=&quot;&quot;)</span>
<a name="l00715"></a>00715 <span class="comment">        {</span>
<a name="l00716"></a>00716 <span class="comment">                this-&gt;Column5-&gt;Items-&gt;Clear();</span>
<a name="l00717"></a>00717 <span class="comment"></span>
<a name="l00718"></a>00718 <span class="comment">                DataGridViewComboBoxCell^ combobox=gcnew DataGridViewComboBoxCell();</span>
<a name="l00719"></a>00719 <span class="comment">                combobox-&gt;Items-&gt;AddRange(Isotopes::getAllIsotopeMasses(cmbbox-&gt;SelectedItem-&gt;ToString()));</span>
<a name="l00720"></a>00720 <span class="comment">                dataGridView1[3,datagridview1_row]=combobox;</span>
<a name="l00721"></a>00721 <span class="comment"></span>
<a name="l00722"></a>00722 <span class="comment">                dataGridView1[3,datagridview1_row]-&gt;Value=(String ^)combobox-&gt;Value;</span>
<a name="l00723"></a>00723 <span class="comment">                dataGridView1[3,datagridview1_row]-&gt;ReadOnly=false;             </span>
<a name="l00724"></a>00724 <span class="comment">                dataGridView1[3,datagridview1_row]-&gt;Value=combobox-&gt;Items[0];</span>
<a name="l00725"></a>00725 <span class="comment"></span>
<a name="l00726"></a>00726 <span class="comment">        }</span>
<a name="l00727"></a>00727 <span class="comment"></span>
<a name="l00728"></a>00728 <span class="comment">        OpenGL-&gt;Render();</span>
<a name="l00729"></a>00729 <span class="comment">        */</span>
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae7246cc661679688ca38feca897758d1">00732</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae7246cc661679688ca38feca897758d1">SpinachGUI::MainForm::dataGridView1_RowsAdded</a>(System::Object^  sender, System::Windows::Forms::DataGridViewRowsAddedEventArgs^  e)
<a name="l00733"></a>00733 {
<a name="l00734"></a>00734         <span class="comment">//Isotope Column empty, ready to choose  and ID colunm set &quot;new&quot;</span>
<a name="l00735"></a>00735         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[2,e-&gt;RowIndex]-&gt;Value=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00736"></a>00736         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[0,e-&gt;RowIndex]-&gt;Value = <span class="stringliteral">&quot;new&quot;</span>;
<a name="l00737"></a>00737 
<a name="l00738"></a>00738         <span class="comment">//Everything readonly, except isotope column </span>
<a name="l00739"></a>00739         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[2,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00740"></a>00740         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[1,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00741"></a>00741         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00742"></a>00742         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00743"></a>00743         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[5,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00744"></a>00744         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[6,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00745"></a>00745         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[7,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00746"></a>00746 
<a name="l00747"></a>00747         <span class="comment">//Set the current cell, the one just added</span>
<a name="l00748"></a>00748         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;CurrentCell = <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>,e-&gt;RowIndex];
<a name="l00749"></a>00749 
<a name="l00750"></a>00750         <span class="comment">//Set the tooltip text for new lines</span>
<a name="l00751"></a>00751         <span class="keywordflow">if</span>(e-&gt;RowIndex&gt;0) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows[e-&gt;RowIndex-1]-&gt;HeaderCell-&gt;ToolTipText  = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00752"></a>00752         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows[e-&gt;RowIndex]-&gt;HeaderCell-&gt;ToolTipText  = <span class="stringliteral">&quot;Add New Atom&quot;</span>;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754         <span class="comment">//Set the last cell of the row the bin icon</span>
<a name="l00755"></a>00755         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[8,e-&gt;RowIndex])-&gt;ValueIsIcon=<span class="keyword">true</span>;
<a name="l00756"></a>00756         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[8,e-&gt;RowIndex])-&gt;Value =
<a name="l00757"></a>00757                 (cli::safe_cast&lt;System::Drawing::Icon^  &gt;(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a59413c9af9317ec767264b3fc473f185">MyResources2</a>-&gt;GetObject(L<span class="stringliteral">&quot;$this.Icon&quot;</span>)));
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 <span class="comment">//For editing coordinates, label and color</span>
<a name="l00762"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a353e14ada9b9bcd1a2049271aba6d0d5">00762</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a353e14ada9b9bcd1a2049271aba6d0d5">SpinachGUI::MainForm::dataGridView1_CellClick</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) 
<a name="l00763"></a>00763 {
<a name="l00764"></a>00764         <span class="comment">//Edit coordinates and label</span>
<a name="l00765"></a>00765         <span class="keywordflow">if</span> ((e-&gt;ColumnIndex&gt;4 || e-&gt;ColumnIndex==1 ) &amp;&amp; 
<a name="l00766"></a>00766                 !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;ReadOnly )           <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;BeginEdit(<span class="keyword">true</span>);
<a name="l00767"></a>00767 
<a name="l00768"></a>00768         <span class="comment">//Click for changing the color</span>
<a name="l00769"></a>00769         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==4 &amp;&amp; 
<a name="l00770"></a>00770                 !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,e-&gt;RowIndex]-&gt;ReadOnly &amp;&amp;
<a name="l00771"></a>00771                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l00772"></a>00772         {
<a name="l00773"></a>00773                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,e-&gt;RowIndex]-&gt;Style-&gt;BackColor=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;Color;
<a name="l00774"></a>00774                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[4,e-&gt;RowIndex]-&gt;Style-&gt;SelectionBackColor=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;Color;
<a name="l00775"></a>00775         };
<a name="l00776"></a>00776 
<a name="l00777"></a>00777         <span class="comment">//When click the bin, delete the atom</span>
<a name="l00778"></a>00778         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==8 &amp;&amp; !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[3,e-&gt;RowIndex]-&gt;ReadOnly )
<a name="l00779"></a>00779         {
<a name="l00780"></a>00780                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows[e-&gt;RowIndex]-&gt;Selected=<span class="keyword">true</span>;
<a name="l00781"></a>00781                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;RemoveAt(e-&gt;RowIndex);
<a name="l00782"></a>00782         };
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         <span class="comment">// Do not select the &quot;new&quot; row</span>
<a name="l00785"></a>00785         <span class="keywordflow">if</span>(e-&gt;ColumnIndex==-1 &amp;&amp; e-&gt;RowIndex==<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Count-1) 
<a name="l00786"></a>00786                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows[e-&gt;RowIndex]-&gt;Selected=<span class="keyword">false</span>;
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790 <span class="comment">//When selection of an Atom change the selection in Interaction Table change</span>
<a name="l00791"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7941198a0984bbcc020331d123fd5a38">00791</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7941198a0984bbcc020331d123fd5a38">SpinachGUI::MainForm::dataGridView1_SelectionChanged</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00792"></a>00792 {
<a name="l00793"></a>00793         <span class="comment">//Clear Selected rown in datagridview2</span>
<a name="l00794"></a>00794         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;ClearSelection();
<a name="l00795"></a>00795 
<a name="l00796"></a>00796         <span class="comment">//Set the Selected atom ID, if &quot;new&quot; set it to -1(nothing) else the value in the first cell</span>
<a name="l00797"></a>00797         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows-&gt;Count!=0) 
<a name="l00798"></a>00798                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#adb6d7ebc122a68cfaaf37467820f5252">SelectedAtomID</a>=(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows[<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows-&gt;Count-1]-&gt;Cells[0]-&gt;Value==<span class="stringliteral">&quot;new&quot;</span>?
<a name="l00799"></a>00799                 -1: Convert::ToInt32((<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows[<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows-&gt;Count-1]-&gt;Cells[0]-&gt;Value)));
<a name="l00800"></a>00800         
<a name="l00801"></a>00801         <span class="comment">//Check its line of datagridview2 to see if atom in column 2 and 4 are in the selected list of datagriview1</span>
<a name="l00802"></a>00802         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;RowCount;i++)
<a name="l00803"></a>00803                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows-&gt;Count;j++)
<a name="l00804"></a>00804                         <span class="keywordflow">if</span>(Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[2,i]-&gt;Value)==
<a name="l00805"></a>00805                                 Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows[j]-&gt;Cells[0]-&gt;Value) ||
<a name="l00806"></a>00806                                 Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,i]-&gt;Value)==
<a name="l00807"></a>00807                                 Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows[j]-&gt;Cells[0]-&gt;Value))  
<a name="l00808"></a>00808                         {
<a name="l00809"></a>00809                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows[i]-&gt;Selected=<span class="keyword">true</span>;
<a name="l00810"></a>00810                         };
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 }
<a name="l00814"></a>00814 
<a name="l00815"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af18b6d818d161ca377f32b3c6fa7f514">00815</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af18b6d818d161ca377f32b3c6fa7f514">SpinachGUI::MainForm::dataGridView1_RowsRemoved</a>(System::Object^  sender, 
<a name="l00816"></a>00816                                                                                                                          System::Windows::Forms::DataGridViewRowsRemovedEventArgs^  e) 
<a name="l00817"></a>00817 {
<a name="l00818"></a>00818  <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a015184d531a720ec874425923d502076" title="Property Count for giving the number of atom in the collection.">Count</a>&gt;0 &amp;&amp; e-&gt;RowCount&lt;=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Count)
<a name="l00819"></a>00819         {
<a name="l00820"></a>00820         <span class="comment">//Remove atom from AtomCollection</span>
<a name="l00821"></a>00821         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#af08725f59d4aa7bf662d247d98cbdd8d">RemoveAt</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#adb6d7ebc122a68cfaaf37467820f5252">SelectedAtomID</a>);
<a name="l00822"></a>00822 
<a name="l00823"></a>00823         <span class="comment">//Renumber atoms in datagridview1</span>
<a name="l00824"></a>00824         <span class="keywordtype">int</span> jj=0;
<a name="l00825"></a>00825         <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[0,jj++]-&gt;Value=i;
<a name="l00826"></a>00826         
<a name="l00827"></a>00827         <span class="comment">//Refresh the whole datagridview1 and Rerender</span>
<a name="l00828"></a>00828         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows-&gt;Count==0)
<a name="l00829"></a>00829                 {
<a name="l00830"></a>00830                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();
<a name="l00831"></a>00831                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4978dc4d55a0eef52f541b2bb13d2c23">DataGridView_Interactions_Update</a>(); 
<a name="l00832"></a>00832                         <span class="comment">//OpenGL-&gt;UpdateDisplay(UpdateType::ALL);</span>
<a name="l00833"></a>00833                 };
<a name="l00834"></a>00834 
<a name="l00835"></a>00835         };
<a name="l00836"></a>00836 }
<a name="l00837"></a>00837 
<a name="l00838"></a>00838 <span class="comment">//When mouse is above a cell, then is getting selected immidiatelly in order to avoid many clicks</span>
<a name="l00839"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8d956cbaa8626810528600456e2a996e">00839</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8d956cbaa8626810528600456e2a996e">SpinachGUI::MainForm::dataGridView1_CellEnter</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) {
<a name="l00840"></a>00840 
<a name="l00841"></a>00841         <span class="keywordflow">if</span>(e-&gt;ColumnIndex&gt;1 &amp;&amp; e-&gt;ColumnIndex&lt;4 &amp;&amp; e-&gt;RowIndex&gt;=0 
<a name="l00842"></a>00842                 &amp;&amp; !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;IsCurrentCellInEditMode &amp;&amp; <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;SelectedRows-&gt;Count&lt;1 )
<a name="l00843"></a>00843         {
<a name="l00844"></a>00844                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;CurrentCell = <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>[e-&gt;ColumnIndex,e-&gt;RowIndex];
<a name="l00845"></a>00845         };
<a name="l00846"></a>00846 }
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 <span class="comment">//When we choose something from dropdown menu immidiately finish edit</span>
<a name="l00849"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af8ea9f3b73503b5433c570b3d80e396a">00849</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af8ea9f3b73503b5433c570b3d80e396a">SpinachGUI::MainForm::dataGridView1_CurrentCellDirtyStateChanged</a>(System::Object^  sender, System::EventArgs^  e) {
<a name="l00850"></a>00850         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>==2 || <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>==3) 
<a name="l00851"></a>00851                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;EndEdit(DataGridViewDataErrorContexts::Commit);
<a name="l00852"></a>00852 }
<a name="l00853"></a>00853 
<a name="l00854"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a69b8c878b2a424519218b9fd8278d235">00854</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a69b8c878b2a424519218b9fd8278d235">SpinachGUI::MainForm::dataGridView1_MouseEnter</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00855"></a>00855 {
<a name="l00856"></a>00856         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Focus();
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a051619e727e46a1c3f9940fca22cbc57">00859</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a051619e727e46a1c3f9940fca22cbc57">SpinachGUI::MainForm::dataGridView1_CellLeave</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) 
<a name="l00860"></a>00860 {
<a name="l00861"></a>00861         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>==2 || <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8af7729e54134c93292c332e91b897cb">datagridview1_column</a>==3) 
<a name="l00862"></a>00862                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0faa12c512eac1e0aa4531401991b7ac">txtbox_KeyPress</a>(<span class="keyword">gcnew</span> DataGridViewTextBoxColumn(),<span class="keyword">gcnew</span> KeyPressEventArgs((<span class="keywordtype">char</span>)13)) ;
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a098f0ca31d0638190c51586aef36d170">00865</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a098f0ca31d0638190c51586aef36d170">SpinachGUI::MainForm::dataGridView1_Paint</a>(System::Object^  sender, System::Windows::Forms::PaintEventArgs^  e) 
<a name="l00866"></a>00866 {
<a name="l00867"></a>00867         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6b4493c3ff99e8fcf1362a1700f03b9b">dataGridView_Helpers</a>();
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 <span class="comment"></span>
<a name="l00870"></a>00870 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00871"></a>00871 <span class="comment"></span><span class="comment">// Edit Datagridview for Interaction</span>
<a name="l00872"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8e56a0c3283e925a70f4c7f1ce40f02f">00872</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8e56a0c3283e925a70f4c7f1ce40f02f">SpinachGUI::MainForm::dataGridView2_CellClick</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) 
<a name="l00873"></a>00873 {
<a name="l00874"></a>00874         <span class="comment">//Click of orientation button</span>
<a name="l00875"></a>00875         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==6 &amp;&amp; e-&gt;RowIndex&gt;-1 &amp;&amp; !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;ReadOnly)
<a name="l00876"></a>00876         {                       
<a name="l00877"></a>00877                 <span class="keywordtype">int</span> k=Convert::ToInt32(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[0,e-&gt;RowIndex]-&gt;Value);
<a name="l00878"></a>00878                 <span class="comment">//OrientationDialog^ orientationdialog= gcnew OrientationDialog();</span>
<a name="l00879"></a>00879                 <a class="code" href="namespace_spinach_g_u_i.html#a3c716a03fba0b66dac5dd03360e85e38">Check</a> ^ method=<span class="keyword">gcnew</span> <a class="code" href="namespace_spinach_g_u_i.html#a3c716a03fba0b66dac5dd03360e85e38">Check</a>(<span class="keyword">this</span>,&amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">SpinachGUI::MainForm::CheckExistentInteractions</a>);
<a name="l00880"></a>00880                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a934d7d9135df6941da32069d78643584">orientationdialog</a>-&gt;<a class="code" href="class_spinach_g_u_i_1_1_orientation_dialog.html#a36c53006a93e73da4674553d1f566038" title="Initialization of orientation dialog.">Initialization</a>(((<a class="code" href="class_tensor.html">Tensor</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[k]), <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>
<a name="l00881"></a>00881                         , method);
<a name="l00882"></a>00882                         <span class="comment">//= gcnew OrientationDialog(((Tensor^)SystemModel-&gt;InteractionCollection[k]), OpenGL);</span>
<a name="l00883"></a>00883                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a934d7d9135df6941da32069d78643584">orientationdialog</a>-&gt;ShowDialog();
<a name="l00884"></a>00884 
<a name="l00885"></a>00885         };
<a name="l00886"></a>00886 
<a name="l00887"></a>00887         <span class="comment">//Delete button deletes this row</span>
<a name="l00888"></a>00888         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==7 &amp;&amp; !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,e-&gt;RowIndex]-&gt;ReadOnly )
<a name="l00889"></a>00889         {
<a name="l00890"></a>00890                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows[e-&gt;RowIndex]-&gt;Selected=<span class="keyword">true</span>;
<a name="l00891"></a>00891                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;RemoveAt(e-&gt;RowIndex);
<a name="l00892"></a>00892         }
<a name="l00893"></a>00893         <span class="comment">// do not select the new row</span>
<a name="l00894"></a>00894         <span class="keywordflow">if</span>(e-&gt;ColumnIndex==-1 &amp;&amp; e-&gt;RowIndex==<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aed29c1e181b6e7d4e8d9251d7ff79a98">dataGridView1</a>-&gt;Rows-&gt;Count-1) 
<a name="l00895"></a>00895                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows[e-&gt;RowIndex]-&gt;Selected=<span class="keyword">false</span>;
<a name="l00896"></a>00896 }
<a name="l00897"></a>00897 
<a name="l00898"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a471e0135101de253f162738e0a4aac5d">00898</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a471e0135101de253f162738e0a4aac5d">SpinachGUI::MainForm::dataGridView2_RowsRemoved</a>(System::Object^  sender, System::Windows::Forms::DataGridViewRowsRemovedEventArgs^  e) 
<a name="l00899"></a>00899 {
<a name="l00900"></a>00900 
<a name="l00901"></a>00901         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a5917115071d8b045a2ec73beb07a6a48" title="Property Count for giving the number of interactions in the collection.">Count</a>&gt;0 &amp;&amp; 
<a name="l00902"></a>00902            e-&gt;RowCount&lt;=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Count
<a name="l00903"></a>00903                 <span class="comment">//&amp;&amp; e-&gt;RowIndex&gt;0 //check that</span>
<a name="l00904"></a>00904                 <span class="comment">//e-&gt;RowCount&lt;2 //check that</span>
<a name="l00905"></a>00905                 )
<a name="l00906"></a>00906         {
<a name="l00907"></a>00907                 <span class="comment">//Remove of interaction</span>
<a name="l00908"></a>00908                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a46a87c69895237a69e651c8720c69df9">RemoveAt</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a88a238ce8cec828458c041bde9902d99">SelectedInterID</a>);
<a name="l00909"></a>00909 
<a name="l00910"></a>00910                 <span class="comment">//Renumbering of IDs</span>
<a name="l00911"></a>00911                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a88a238ce8cec828458c041bde9902d99">SelectedInterID</a>;i&lt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a5917115071d8b045a2ec73beb07a6a48" title="Property Count for giving the number of interactions in the collection.">Count</a>+1;i++)
<a name="l00912"></a>00912                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[0,i-1]-&gt;Value=((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;getID();
<a name="l00913"></a>00913         };
<a name="l00914"></a>00914 
<a name="l00915"></a>00915         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;SelectedRows-&gt;Count==0)
<a name="l00916"></a>00916         {
<a name="l00917"></a>00917         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a5917115071d8b045a2ec73beb07a6a48" title="Property Count for giving the number of interactions in the collection.">Count</a>&gt;0) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">CheckExistentInteractions</a>(<span class="keyword">true</span>);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l00920"></a>00920          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l00921"></a>00921         }
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 }
<a name="l00924"></a>00924 
<a name="l00925"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8f9daa783df9a56ff2cac1ee178a7e75">00925</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8f9daa783df9a56ff2cac1ee178a7e75">SpinachGUI::MainForm::dataGridView2_SelectionChanged</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l00926"></a>00926 {
<a name="l00927"></a>00927         
<a name="l00928"></a>00928  <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;SelectedRows-&gt;Count!=0) 
<a name="l00929"></a>00929  {
<a name="l00930"></a>00930          Int32::TryParse(Convert::ToString(
<a name="l00931"></a>00931             <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;SelectedRows[<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;SelectedRows-&gt;Count-1]-&gt;Cells[0]-&gt;Value), <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a88a238ce8cec828458c041bde9902d99">SelectedInterID</a>); 
<a name="l00932"></a>00932          <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad49d29faefc444c990205f1dead0811e">ReferencecheckBox</a>-&gt;Checked)  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a4269a637342af6fb3add0853e1301da6" title="Final Render routine.">Render</a>();
<a name="l00933"></a>00933  }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935 }
<a name="l00936"></a>00936 
<a name="l00937"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aeb353736f4cee01c899bcd62e09a4732">00937</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aeb353736f4cee01c899bcd62e09a4732">SpinachGUI::MainForm::dataGridView2_CellBeginEdit</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellCancelEventArgs^  e) 
<a name="l00938"></a>00938 {
<a name="l00939"></a>00939         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a02fab26a6b0959609bfcc6e029e73953">datagridview2_column</a>=e-&gt;ColumnIndex;
<a name="l00940"></a>00940         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>=e-&gt;RowIndex;
<a name="l00941"></a>00941 
<a name="l00942"></a>00942         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==2) 
<a name="l00943"></a>00943         {
<a name="l00944"></a>00944                 <span class="keywordflow">if</span> ((String^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value==<span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a01359c9f71532e864ceef15911625f62">insertInter</a>=<span class="keyword">true</span>;
<a name="l00945"></a>00945                 <span class="keywordflow">else</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a01359c9f71532e864ceef15911625f62">insertInter</a>=<span class="keyword">false</span>;
<a name="l00946"></a>00946         };
<a name="l00947"></a>00947 
<a name="l00948"></a>00948 
<a name="l00949"></a>00949 }
<a name="l00950"></a>00950 
<a name="l00951"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a19865e08b6354e97023b73bf9ddcabaf">00951</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a19865e08b6354e97023b73bf9ddcabaf">SpinachGUI::MainForm::dataGridView2_CellEnter</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) 
<a name="l00952"></a>00952 {
<a name="l00953"></a>00953         <span class="keywordflow">if</span>((e-&gt;ColumnIndex==2 || e-&gt;ColumnIndex==3 || e-&gt;ColumnIndex==4 || e-&gt;ColumnIndex==5) &amp;&amp;
<a name="l00954"></a>00954                 e-&gt;RowIndex&gt;=0 &amp;&amp; !<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;IsCurrentCellInEditMode &amp;&amp;
<a name="l00955"></a>00955             <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;SelectedRows-&gt;Count&lt;1 )
<a name="l00956"></a>00956         {
<a name="l00957"></a>00957                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;CurrentCell = <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[e-&gt;ColumnIndex,e-&gt;RowIndex];
<a name="l00958"></a>00958         };
<a name="l00959"></a>00959 
<a name="l00960"></a>00960 
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 }
<a name="l00963"></a>00963 
<a name="l00964"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa4c700f2d3b3de77b2804e914a115e25">00964</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa4c700f2d3b3de77b2804e914a115e25">SpinachGUI::MainForm::dataGridView2_CurrentCellDirtyStateChanged</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l00965"></a>00965                  {
<a name="l00966"></a>00966         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a02fab26a6b0959609bfcc6e029e73953">datagridview2_column</a>==2 || <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a02fab26a6b0959609bfcc6e029e73953">datagridview2_column</a>==3 || <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a02fab26a6b0959609bfcc6e029e73953">datagridview2_column</a>==4 || <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a02fab26a6b0959609bfcc6e029e73953">datagridview2_column</a>==5) 
<a name="l00967"></a>00967                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;EndEdit(DataGridViewDataErrorContexts::Commit);
<a name="l00968"></a>00968 }
<a name="l00969"></a>00969 
<a name="l00970"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab5a0f246ed538c90eeb7216fc349b0b5">00970</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab5a0f246ed538c90eeb7216fc349b0b5">SpinachGUI::MainForm::dataGridView2_RowsAdded</a>(System::Object^  sender, System::Windows::Forms::DataGridViewRowsAddedEventArgs^  e) 
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972         <span class="comment">//Adding the items in the Atom menu</span>
<a name="l00973"></a>00973         DataGridViewComboBoxCell^ combobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l00974"></a>00974         <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l00975"></a>00975         { 
<a name="l00976"></a>00976                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;getID()));
<a name="l00977"></a>00977         }
<a name="l00978"></a>00978         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[2,e-&gt;RowIndex]=combobox;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980         <span class="comment">//Atom Column empty, ready to choose  and ID colunm set &quot;new&quot; and edit column</span>
<a name="l00981"></a>00981         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[2,e-&gt;RowIndex]-&gt;Value=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00982"></a>00982         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[0,e-&gt;RowIndex]-&gt;Value=<span class="stringliteral">&quot;new&quot;</span>;
<a name="l00983"></a>00983         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[6,e-&gt;RowIndex]-&gt;Value=<span class="stringliteral">&quot;Edit&quot;</span>;
<a name="l00984"></a>00984 
<a name="l00985"></a>00985         <span class="comment">//Everything readonly, except atom 1 column</span>
<a name="l00986"></a>00986         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[1,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00987"></a>00987         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[2,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l00988"></a>00988         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00989"></a>00989         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00990"></a>00990         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00991"></a>00991         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[6,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00992"></a>00992         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[7,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">true</span>;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994         <span class="comment">//Set the current cell, the one just added</span>
<a name="l00995"></a>00995         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;CurrentCell = <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a02fab26a6b0959609bfcc6e029e73953">datagridview2_column</a>,e-&gt;RowIndex];
<a name="l00996"></a>00996 
<a name="l00997"></a>00997                 
<a name="l00998"></a>00998         <span class="comment">//Set the tooltip text for new lines</span>
<a name="l00999"></a>00999         <span class="keywordflow">if</span>(e-&gt;RowIndex&gt;0) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows[e-&gt;RowIndex-1]-&gt;HeaderCell-&gt;ToolTipText  = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01000"></a>01000         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows[e-&gt;RowIndex]-&gt;HeaderCell-&gt;ToolTipText  = <span class="stringliteral">&quot;Add New Interaction&quot;</span>;
<a name="l01001"></a>01001         
<a name="l01002"></a>01002         <span class="comment">//Set the last cell of the row the bin icon</span>
<a name="l01003"></a>01003         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[7,e-&gt;RowIndex])-&gt;ValueIsIcon=<span class="keyword">true</span>;
<a name="l01004"></a>01004         ((DataGridViewImageCell ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[7,e-&gt;RowIndex])-&gt;Value =
<a name="l01005"></a>01005                 (cli::safe_cast&lt;System::Drawing::Icon^  &gt;(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a59413c9af9317ec767264b3fc473f185">MyResources2</a>-&gt;GetObject(L<span class="stringliteral">&quot;$this.Icon&quot;</span>)));
<a name="l01006"></a>01006 
<a name="l01007"></a>01007 }
<a name="l01008"></a>01008 
<a name="l01009"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4f55a4cb7dbbafaa1cddebcd6071174f">01009</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4f55a4cb7dbbafaa1cddebcd6071174f">SpinachGUI::MainForm::dataGridView2_CellEndEdit</a>(System::Object^  sender, System::Windows::Forms::DataGridViewCellEventArgs^  e) 
<a name="l01010"></a>01010 {
<a name="l01011"></a>01011         <span class="keywordflow">if</span> (e-&gt;ColumnIndex==2 &amp;&amp; 
<a name="l01012"></a>01012                 (String^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value!=<span class="stringliteral">&quot;&quot;</span>) <span class="comment">//insert Interaction</span>
<a name="l01013"></a>01013         {
<a name="l01014"></a>01014                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a01359c9f71532e864ceef15911625f62">insertInter</a>)
<a name="l01015"></a>01015                 {
<a name="l01016"></a>01016                         <span class="keywordtype">int</span> jj=Convert::ToInt32((String^)dataGridView2[2,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01017"></a>01017                         <a class="code" href="class_atom.html">Atom</a>^ nAtom=((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[jj]);
<a name="l01018"></a>01018 
<a name="l01019"></a>01019                         <span class="comment">//Assing initial values of tensor</span><a class="code" href="class_spinach_g_u_i_1_1_matrix3x3.html"></a>
<a name="l01020"></a>01020 <a class="code" href="class_spinach_g_u_i_1_1_matrix3x3.html">			::Matrix3x3</a> ^matrix=gcnew ::Matrix3x3();
<a name="l01021"></a>01021                         matrix[0]=0.0; matrix[4]=0.0; matrix[8]=0.0;
<a name="l01022"></a>01022                         matrix[1]=0.0; matrix[2]=0.0; matrix[3]=0.0;
<a name="l01023"></a>01023                         matrix[5]=0.0; matrix[6]=0.0; matrix[7]=0.0;
<a name="l01024"></a>01024 
<a name="l01025"></a>01025                         <a class="code" href="class_tensor.html">Tensor</a>^ nInter;
<a name="l01026"></a>01026 
<a name="l01027"></a>01027                         <span class="comment">//Combo box for kinds of interactions</span>
<a name="l01028"></a>01028                         DataGridViewComboBoxCell^ combobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01029"></a>01029                         <span class="keywordflow">if</span>(nAtom-&gt;<a class="code" href="class_atom.html#a14a6785b5d26d50fe23d617c95b2585d" title="Property isotope of the atom.">isotope</a>-&gt;<a class="code" href="class_isotope.html#ae44f2dfdec36f8d7934ac152b7deefd6" title="Name of element.">Element</a>==<span class="stringliteral">&quot;e&quot;</span>)
<a name="l01030"></a>01030                         {
<a name="l01031"></a>01031                                 combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Zero-Field&quot;</span>);
<a name="l01032"></a>01032                                 combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;G-tensor&quot;</span>);
<a name="l01033"></a>01033                                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>()&gt;1)combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Exchange&quot;</span>);
<a name="l01034"></a>01034                         }
<a name="l01035"></a>01035                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nAtom-&gt;<a class="code" href="class_atom.html#a14a6785b5d26d50fe23d617c95b2585d" title="Property isotope of the atom.">isotope</a>-&gt;<a class="code" href="class_isotope.html#ae44f2dfdec36f8d7934ac152b7deefd6" title="Name of element.">Element</a>!=<span class="stringliteral">&quot;e&quot;</span>)
<a name="l01036"></a>01036                         {
<a name="l01037"></a>01037                                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>()) combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;HFC&quot;</span>); <span class="comment">//If electron exist have HFC</span>
<a name="l01038"></a>01038                                 combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Shift&quot;</span>);
<a name="l01039"></a>01039                                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a015184d531a720ec874425923d502076" title="Property Count for giving the number of atom in the collection.">Count</a>&gt;1) combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;J-coupling&quot;</span>); <span class="comment">//More than 1 atoms</span>
<a name="l01040"></a>01040                                 <span class="comment">//Not available for 1/2 spin atoms</span>
<a name="l01041"></a>01041                                 <span class="keywordflow">if</span>(nAtom-&gt;<a class="code" href="class_atom.html#a14a6785b5d26d50fe23d617c95b2585d" title="Property isotope of the atom.">isotope</a>-&gt;<a class="code" href="class_isotope.html#a6b449f3c65b6cb81225a87572353c235" title="Spin of element.">Spin</a>!=0.5) combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Quadrupolar&quot;</span>);
<a name="l01042"></a>01042                         }
<a name="l01043"></a>01043 
<a name="l01044"></a>01044                         this-&gt;dataGridView2[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]=combobox;
<a name="l01045"></a>01045 
<a name="l01046"></a>01046                         <span class="comment">//Create first the comboBox with the options of reference frames</span>
<a name="l01047"></a>01047                         DataGridViewComboBoxCell^ refcombobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01048"></a>01048                         <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#ac4bf3754525cbdb370387718ad4dd579" title="Property Keys for giving the keys of the collection.">Keys</a>) 
<a name="l01049"></a>01049                                         refcombobox-&gt;Items-&gt;Add(Convert::ToString(j));
<a name="l01050"></a>01050                         dataGridView2[5,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]=refcombobox;
<a name="l01051"></a>01051                         <span class="comment">//Select default reference frame</span>
<a name="l01052"></a>01052                         dataGridView2[5,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value=refcombobox-&gt;Items[0];
<a name="l01053"></a>01053 
<a name="l01054"></a>01054 
<a name="l01055"></a>01055                         
<a name="l01056"></a>01056                         <span class="keywordflow">if</span>(nAtom-&gt;isotope-&gt;Element!=<span class="stringliteral">&quot;e&quot;</span>) 
<a name="l01057"></a>01057                         {
<a name="l01058"></a>01058                                 nInter=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>(nAtom,nAtom, <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eae4a1b28ecfe89d0bac93fee76b23ba68">InteractionKind::Shift</a>, matrix);       
<a name="l01059"></a>01059                                 nInter-&gt;unit=<a class="code" href="class_units.html#a13d0ca3953991e746670edb678bf1194">Units::ppm</a>;
<a name="l01060"></a>01060                                 <span class="comment">//Set reference frame to the interaction</span>
<a name="l01061"></a>01061                             nInter-&gt;Frame=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[1];
<a name="l01062"></a>01062                                 <span class="comment">//Add interaction to system</span>
<a name="l01063"></a>01063                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ad925f794ab817762d3b2bab79fc34038">Add</a>(nInter);
<a name="l01064"></a>01064                                 dataGridView2[3,e-&gt;RowIndex]-&gt;Value=Convert::ToString(<span class="stringliteral">&quot;Shift&quot;</span>);
<a name="l01065"></a>01065                                 combobox=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7ce1e994e9be5df175b30211f8925519">UpdateCoupledAtomIDComboBox</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a5917115071d8b045a2ec73beb07a6a48" title="Property Count for giving the number of interactions in the collection.">Count</a>,<span class="stringliteral">&quot;Shift&quot;</span>);
<a name="l01066"></a>01066 
<a name="l01067"></a>01067                         }
<a name="l01068"></a>01068                         <span class="keywordflow">else</span>
<a name="l01069"></a>01069                         {
<a name="l01070"></a>01070                                 nInter=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>(nAtom,nAtom, <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea002c54e14f8b8cc5a33e76e39d67a6a0">InteractionKind::GTensor</a>, matrix);
<a name="l01071"></a>01071                                 nInter-&gt;unit=<a class="code" href="class_units.html#aefde252771ce6c48781414a0ea4aee78">Units::Mi_b</a>;
<a name="l01072"></a>01072                                 <span class="comment">//Set reference frame to the interaction</span>
<a name="l01073"></a>01073                             nInter-&gt;Frame=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[1];
<a name="l01074"></a>01074                                 <span class="comment">//Add interaction to system</span>
<a name="l01075"></a>01075                             <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ad925f794ab817762d3b2bab79fc34038">Add</a>(nInter);
<a name="l01076"></a>01076                                 dataGridView2[3,e-&gt;RowIndex]-&gt;Value=Convert::ToString(<span class="stringliteral">&quot;G-tensor&quot;</span>);
<a name="l01077"></a>01077                                 combobox=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7ce1e994e9be5df175b30211f8925519">UpdateCoupledAtomIDComboBox</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a5917115071d8b045a2ec73beb07a6a48" title="Property Count for giving the number of interactions in the collection.">Count</a>,<span class="stringliteral">&quot;G-tensor&quot;</span>);
<a name="l01078"></a>01078 
<a name="l01079"></a>01079                         };
<a name="l01080"></a>01080 
<a name="l01081"></a>01081                         <span class="comment">//Change kind of interaction and update B atoms menus</span>
<a name="l01082"></a>01082                         this-&gt;dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]=combobox;
<a name="l01083"></a>01083                         <span class="comment">//Set the value to defaults</span>
<a name="l01084"></a>01084                         dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value=combobox-&gt;Items[0];
<a name="l01085"></a>01085 
<a name="l01086"></a>01086                         <span class="comment">//Assign the ID</span>
<a name="l01087"></a>01087                         dataGridView2[0,e-&gt;RowIndex]-&gt;Value=nInter-&gt;ID;
<a name="l01088"></a>01088 
<a name="l01089"></a>01089                         <span class="comment">//Change to readable</span>
<a name="l01090"></a>01090                         dataGridView2[1,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01091"></a>01091                         dataGridView2[2,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01092"></a>01092                         dataGridView2[3,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01093"></a>01093                         dataGridView2[4,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01094"></a>01094                         dataGridView2[5,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01095"></a>01095                         dataGridView2[6,e-&gt;RowIndex]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01096"></a>01096                 
<a name="l01097"></a>01097                 }
<a name="l01098"></a>01098                 <span class="keywordflow">else</span> <span class="comment">//Not Inserting</span>
<a name="l01099"></a>01099                 {
<a name="l01100"></a>01100                         <span class="comment">//Find interaction ID</span>
<a name="l01101"></a>01101                         <span class="keywordtype">int</span> jj=Convert::ToInt32(dataGridView2[0,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01102"></a>01102                         
<a name="l01103"></a>01103 
<a name="l01104"></a>01104            <span class="comment">//Temporary change to spirotation in order to change to an  valid  atom</span>
<a name="l01105"></a>01105                ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::spinrotation;
<a name="l01106"></a>01106 
<a name="l01107"></a>01107                         <span class="comment">//Change atoms</span>
<a name="l01108"></a>01108                         <span class="keywordtype">int</span> ii=Convert::ToInt32((String^)dataGridView2[2,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01109"></a>01109                         ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A=     
<a name="l01110"></a>01110                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[ii]);
<a name="l01111"></a>01111 
<a name="l01112"></a>01112                         <span class="comment">//Combo box for kinds of interactions</span>
<a name="l01113"></a>01113                         DataGridViewComboBoxCell^ combobox=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3c19660c9070a55fa8755a2feb1aad1b">UpdateInteractionTypeComboBox</a>(jj);
<a name="l01114"></a>01114                         this-&gt;dataGridView2[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]=combobox;
<a name="l01115"></a>01115                         <span class="comment">//Set the value to defaults</span>
<a name="l01116"></a>01116                         <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;isotope-&gt;Element!=<span class="stringliteral">&quot;e&quot;</span>) 
<a name="l01117"></a>01117                                 dataGridView2[3,e-&gt;RowIndex]-&gt;Value=Convert::ToString(<span class="stringliteral">&quot;Shift&quot;</span>);
<a name="l01118"></a>01118                         <span class="keywordflow">else</span> dataGridView2[3,e-&gt;RowIndex]-&gt;Value=Convert::ToString(<span class="stringliteral">&quot;G-tensor&quot;</span>);
<a name="l01119"></a>01119 
<a name="l01120"></a>01120                         <span class="comment">//Change kind of interaction and update B atoms menus</span>
<a name="l01121"></a>01121                         DataGridViewComboBoxCell^ tcombobox=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7ce1e994e9be5df175b30211f8925519">UpdateCoupledAtomIDComboBox</a>(jj, 
<a name="l01122"></a>01122                                 (String ^)dataGridView2[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01123"></a>01123                         this-&gt;dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]=tcombobox;
<a name="l01124"></a>01124                         <span class="comment">//Set the value to defaults</span>
<a name="l01125"></a>01125                         dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value=tcombobox-&gt;Items[0];
<a name="l01126"></a>01126                         
<a name="l01127"></a>01127                         <span class="comment">//Set this value to the system</span>
<a name="l01128"></a>01128                         <span class="keywordtype">int</span> kk=Convert::ToInt32((String^)dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01129"></a>01129                         ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01130"></a>01130                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[kk]);
<a name="l01131"></a>01131 
<a name="l01132"></a>01132                 }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134         }
<a name="l01135"></a>01135         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;ColumnIndex==3 &amp;&amp;
<a name="l01136"></a>01136                 (String^)dataGridView2[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value!=<span class="stringliteral">&quot;&quot;</span>) <span class="comment">//Change Interaction</span>
<a name="l01137"></a>01137         {
<a name="l01138"></a>01138                 <span class="comment">//Find interaction ID</span>
<a name="l01139"></a>01139                 <span class="keywordtype">int</span> jj=Convert::ToInt32(dataGridView2[0,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141                 <span class="comment">//Change kind of interaction and update B atoms menus</span>
<a name="l01142"></a>01142                 DataGridViewComboBoxCell^ combobox=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7ce1e994e9be5df175b30211f8925519">UpdateCoupledAtomIDComboBox</a>(jj, 
<a name="l01143"></a>01143                         (String ^)dataGridView2[3,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01144"></a>01144                 this-&gt;dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]=combobox;
<a name="l01145"></a>01145                 dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value=combobox-&gt;Items[0];
<a name="l01146"></a>01146 
<a name="l01147"></a>01147                 <span class="comment">//Set this value to the system</span>
<a name="l01148"></a>01148                 <span class="keywordtype">int</span> kk=Convert::ToInt32((String^)dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01149"></a>01149                         ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01150"></a>01150                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[kk]);
<a name="l01151"></a>01151 
<a name="l01152"></a>01152 
<a name="l01153"></a>01153         }
<a name="l01154"></a>01154 
<a name="l01155"></a>01155                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;ColumnIndex==4 &amp;&amp;
<a name="l01156"></a>01156                 (String^)dataGridView2[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value!=<span class="stringliteral">&quot;&quot;</span>) <span class="comment">//Change coupled atom</span>
<a name="l01157"></a>01157         {
<a name="l01158"></a>01158                 <span class="comment">//Find interaction ID</span>
<a name="l01159"></a>01159                 <span class="keywordtype">int</span> jj=Convert::ToInt32(dataGridView2[0,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01160"></a>01160 
<a name="l01161"></a>01161                 <span class="comment">//Set this value to the system</span>
<a name="l01162"></a>01162                 <span class="keywordtype">int</span> kk=Convert::ToInt32((String^)dataGridView2[4,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01163"></a>01163                         ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01164"></a>01164                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[kk]);
<a name="l01165"></a>01165         }
<a name="l01166"></a>01166         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;ColumnIndex==5 &amp;&amp;
<a name="l01167"></a>01167                 (String^)dataGridView2[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value!=<span class="stringliteral">&quot;&quot;</span>) <span class="comment">//Change reference frame</span>
<a name="l01168"></a>01168         {
<a name="l01169"></a>01169                         
<a name="l01170"></a>01170         <span class="comment">//Find interaction ID</span>
<a name="l01171"></a>01171                 <span class="keywordtype">int</span> jj=Convert::ToInt32(dataGridView2[0,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01172"></a>01172 
<a name="l01173"></a>01173                 <span class="comment">//Set this value to the system</span>
<a name="l01174"></a>01174                 <span class="keywordtype">int</span> kk=Convert::ToInt32((String^)dataGridView2[5,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01175"></a>01175                 ((<a class="code" href="class_tensor.html">Tensor</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;Frame= ((<a class="code" href="class_reference_frame.html">ReferenceFrame</a> ^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[kk]);
<a name="l01176"></a>01176         }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;ColumnIndex==1 &amp;&amp;
<a name="l01179"></a>01179                 (String^)dataGridView2[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Value!=<span class="stringliteral">&quot;&quot;</span>) <span class="comment">//Change Label</span>
<a name="l01180"></a>01180                 {
<a name="l01181"></a>01181                 <span class="comment">//Find interaction ID</span>
<a name="l01182"></a>01182                 <span class="keywordtype">int</span> jj=Convert::ToInt32((String^)dataGridView2[0,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5a04abdc1f956a760688887937225576">datagridview2_row</a>]-&gt;Value);
<a name="l01183"></a>01183                 
<a name="l01184"></a>01184                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;Label= 
<a name="l01185"></a>01185                                                                                 ((String^)dataGridView2[1,e-&gt;RowIndex]-&gt;Value);
<a name="l01186"></a>01186         };
<a name="l01187"></a>01187 
<a name="l01188"></a>01188         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">CheckExistentInteractions</a>(<span class="keyword">true</span>);
<a name="l01189"></a>01189         dataGridView2[e-&gt;ColumnIndex,e-&gt;RowIndex]-&gt;Style-&gt;BackColor=System::Drawing::SystemColors::Window;
<a name="l01190"></a>01190 
<a name="l01191"></a>01191          <span class="comment">//OpenGL-&gt;Render();</span>
<a name="l01192"></a>01192         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01193"></a>01193 }
<a name="l01194"></a>01194 
<a name="l01195"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3c19660c9070a55fa8755a2feb1aad1b">01195</a> DataGridViewComboBoxCell^ <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3c19660c9070a55fa8755a2feb1aad1b">SpinachGUI::MainForm::UpdateInteractionTypeComboBox</a>(<span class="keywordtype">int</span> InteractionIndex)
<a name="l01196"></a>01196 {
<a name="l01197"></a>01197         DataGridViewComboBoxCell^ combobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01198"></a>01198         <span class="keywordtype">int</span> jj=InteractionIndex;
<a name="l01199"></a>01199         <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;isotope-&gt;Element==<span class="stringliteral">&quot;e&quot;</span>)
<a name="l01200"></a>01200         {
<a name="l01201"></a>01201                 combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Zero-Field&quot;</span>);
<a name="l01202"></a>01202                 combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;G-tensor&quot;</span>);
<a name="l01203"></a>01203                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>()&gt;1) combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Exchange&quot;</span>);
<a name="l01204"></a>01204         }
<a name="l01205"></a>01205         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;isotope-&gt;Element!=<span class="stringliteral">&quot;e&quot;</span>)
<a name="l01206"></a>01206         {
<a name="l01207"></a>01207                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a96e3d0e7d320792d02f940b1f1b99c4a" title="Getter for the number of electrons in the collection.">get_electron_number</a>()) combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;HFC&quot;</span>); <span class="comment">//If electron exist have HFC</span>
<a name="l01208"></a>01208                 combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Shift&quot;</span>);
<a name="l01209"></a>01209                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a015184d531a720ec874425923d502076" title="Property Count for giving the number of atom in the collection.">Count</a>&gt;1) combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;J-coupling&quot;</span>); <span class="comment">//More than 1 atoms</span>
<a name="l01210"></a>01210                 <span class="comment">//Not available for 1/2 spin atoms</span>
<a name="l01211"></a>01211                 <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;isotope-&gt;Spin!=0.5) 
<a name="l01212"></a>01212                         combobox-&gt;Items-&gt;Add(<span class="stringliteral">&quot;Quadrupolar&quot;</span>);
<a name="l01213"></a>01213         }
<a name="l01214"></a>01214         <span class="keywordflow">return</span> combobox;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 }
<a name="l01217"></a>01217 
<a name="l01218"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7ce1e994e9be5df175b30211f8925519">01218</a> DataGridViewComboBoxCell^ <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7ce1e994e9be5df175b30211f8925519">SpinachGUI::MainForm::UpdateCoupledAtomIDComboBox</a>(<span class="keywordtype">int</span> InteractionIndex, String^ IntKind)
<a name="l01219"></a>01219 {
<a name="l01220"></a>01220         DataGridViewComboBoxCell^ combobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01221"></a>01221         <span class="keywordtype">int</span> jj=InteractionIndex;
<a name="l01222"></a>01222         <span class="comment">//Temporary change to spirotation in order to change to an  valid  atom</span>
<a name="l01223"></a>01223         ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::spinrotation;
<a name="l01224"></a>01224 
<a name="l01225"></a>01225         <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;HFC&quot;</span>)
<a name="l01226"></a>01226         {
<a name="l01227"></a>01227                 
<a name="l01228"></a>01228                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>) 
<a name="l01229"></a>01229                 { 
<a name="l01230"></a>01230                         <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;isotope-&gt;Element==<span class="stringliteral">&quot;e&quot;</span>)
<a name="l01231"></a>01231                                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID));
<a name="l01232"></a>01232                 }
<a name="l01233"></a>01233                                 <span class="comment">//Set this value to the system</span>
<a name="l01234"></a>01234                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01235"></a>01235                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01236"></a>01236 
<a name="l01237"></a>01237                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::HFC;
<a name="l01238"></a>01238                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#afa8199bb56a18f4b9bc05a143645a068">Units::Gauss</a>;
<a name="l01239"></a>01239 
<a name="l01240"></a>01240 
<a name="l01241"></a>01241         }
<a name="l01242"></a>01242         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;Shift&quot;</span>)
<a name="l01243"></a>01243         {
<a name="l01244"></a>01244 
<a name="l01245"></a>01245                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;ID));
<a name="l01246"></a>01246                 <span class="comment">//Set this value to the system</span>
<a name="l01247"></a>01247                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01248"></a>01248                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01249"></a>01249                 
<a name="l01250"></a>01250                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::Shift;
<a name="l01251"></a>01251                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#a13d0ca3953991e746670edb678bf1194">Units::ppm</a>;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253         }
<a name="l01254"></a>01254         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;J-coupling&quot;</span>)
<a name="l01255"></a>01255         {
<a name="l01256"></a>01256 
<a name="l01257"></a>01257                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01258"></a>01258                 { 
<a name="l01259"></a>01259                         <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;isotope-&gt;Element!=<span class="stringliteral">&quot;e&quot;</span> &amp;&amp;
<a name="l01260"></a>01260                                 ((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID!=
<a name="l01261"></a>01261                                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;ID)
<a name="l01262"></a>01262                                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID));
<a name="l01263"></a>01263                 };
<a name="l01264"></a>01264 
<a name="l01265"></a>01265                 <span class="comment">//Set this value to the system</span>
<a name="l01266"></a>01266                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01267"></a>01267                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01268"></a>01268 
<a name="l01269"></a>01269                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::Jcoupling;
<a name="l01270"></a>01270                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#aa52706faabc35b525a484ad1bbd9747a">Units::Hz</a>;
<a name="l01271"></a>01271         }
<a name="l01272"></a>01272         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;Quadrupolar&quot;</span>)
<a name="l01273"></a>01273         {
<a name="l01274"></a>01274                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;ID));
<a name="l01275"></a>01275 
<a name="l01276"></a>01276                 <span class="comment">//Set this value to the system</span>
<a name="l01277"></a>01277                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01278"></a>01278                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01279"></a>01279 
<a name="l01280"></a>01280                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::Quadrupolar;
<a name="l01281"></a>01281                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#a0dae09a04eea7c37f558e74dfe99f09b">Units::MHz</a>;
<a name="l01282"></a>01282         }
<a name="l01283"></a>01283         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;G-tensor&quot;</span>)
<a name="l01284"></a>01284         {
<a name="l01285"></a>01285                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;ID));
<a name="l01286"></a>01286 
<a name="l01287"></a>01287                 
<a name="l01288"></a>01288                 <span class="comment">//Set this value to the system</span>
<a name="l01289"></a>01289                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01290"></a>01290                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01291"></a>01291 
<a name="l01292"></a>01292                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::GTensor;
<a name="l01293"></a>01293                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#aefde252771ce6c48781414a0ea4aee78">Units::Mi_b</a>;
<a name="l01294"></a>01294         }
<a name="l01295"></a>01295         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;Exchange&quot;</span>)
<a name="l01296"></a>01296         {
<a name="l01297"></a>01297                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01298"></a>01298                 { 
<a name="l01299"></a>01299                         <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;isotope-&gt;Element==<span class="stringliteral">&quot;e&quot;</span> &amp;&amp;
<a name="l01300"></a>01300                                 ((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID!=
<a name="l01301"></a>01301                                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;ID)
<a name="l01302"></a>01302                                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID));
<a name="l01303"></a>01303                 };
<a name="l01304"></a>01304 
<a name="l01305"></a>01305                 <span class="comment">//Set this value to the system</span>
<a name="l01306"></a>01306                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01307"></a>01307                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01308"></a>01308 
<a name="l01309"></a>01309                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::Exchange;
<a name="l01310"></a>01310                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#aefde252771ce6c48781414a0ea4aee78">Units::Mi_b</a>;
<a name="l01311"></a>01311 
<a name="l01312"></a>01312         }
<a name="l01313"></a>01313         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(IntKind==<span class="stringliteral">&quot;Zero-Field&quot;</span>)
<a name="l01314"></a>01314         {
<a name="l01315"></a>01315 
<a name="l01316"></a>01316                 combobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;A-&gt;ID));
<a name="l01317"></a>01317 
<a name="l01318"></a>01318                 <span class="comment">//Set this value to the system</span>
<a name="l01319"></a>01319                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;B=     
<a name="l01320"></a>01320                                 ((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[Convert::ToInt32((String^)combobox-&gt;Items[0])]);
<a name="l01321"></a>01321 
<a name="l01322"></a>01322                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;IntKind=InteractionKind::ZFS;
<a name="l01323"></a>01323                 ((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;unit=<a class="code" href="class_units.html#a0dae09a04eea7c37f558e74dfe99f09b">Units::MHz</a>;
<a name="l01324"></a>01324         }
<a name="l01325"></a>01325 
<a name="l01326"></a>01326         <span class="keywordflow">return</span> combobox;
<a name="l01327"></a>01327 }
<a name="l01328"></a>01328 
<a name="l01329"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4978dc4d55a0eef52f541b2bb13d2c23">01329</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4978dc4d55a0eef52f541b2bb13d2c23">SpinachGUI::MainForm::DataGridView_Interactions_Update</a>() 
<a name="l01330"></a>01330 {
<a name="l01331"></a>01331 
<a name="l01332"></a>01332 
<a name="l01333"></a>01333         <span class="keywordtype">int</span> jj=0;
<a name="l01334"></a>01334         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l01335"></a>01335         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">CheckExistentInteractions</a>(<span class="keyword">true</span>);
<a name="l01336"></a>01336         <span class="comment">//In order to clear the first line and update with the new atom dorp menu</span>
<a name="l01337"></a>01337         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Clear();
<a name="l01338"></a>01338 
<a name="l01339"></a>01339 
<a name="l01340"></a>01340         <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a3975f45bfab6c927263eeab43f8d21ef" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01341"></a>01341         {
<a name="l01342"></a>01342                 <span class="comment">//Fill Table with Interactions but no Bonds</span>
<a name="l01343"></a>01343                 <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind!=<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea1203807f6d26bc8df1724b77efbcf351">InteractionKind::CBond</a>)
<a name="l01344"></a>01344                 {
<a name="l01345"></a>01345                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Rows-&gt;Add();
<a name="l01346"></a>01346 
<a name="l01347"></a>01347                         <span class="comment">//Interaction ID</span>
<a name="l01348"></a>01348                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[0,jj]-&gt;Value=((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;getID();
<a name="l01349"></a>01349 
<a name="l01350"></a>01350                         <span class="comment">//Atom A ID</span>
<a name="l01351"></a>01351                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[2,jj]-&gt;Value=Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID);
<a name="l01352"></a>01352 
<a name="l01353"></a>01353                         <span class="comment">//Combo box for kinds of interactions</span>
<a name="l01354"></a>01354                         DataGridViewComboBoxCell^ combobox=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3c19660c9070a55fa8755a2feb1aad1b">UpdateInteractionTypeComboBox</a>(i);
<a name="l01355"></a>01355                 this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]=combobox;
<a name="l01356"></a>01356 
<a name="l01357"></a>01357 
<a name="l01358"></a>01358                         <span class="comment">// Kind of Interaction</span>
<a name="l01359"></a>01359                         <span class="comment">//Create first the comboBox with the options of Atom B ID</span>
<a name="l01360"></a>01360                         DataGridViewComboBoxCell^ ncombobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01361"></a>01361 
<a name="l01362"></a>01362 
<a name="l01363"></a>01363                         <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eaa963e6070e2708404c83781a60a9e823">InteractionKind::HFC</a>)
<a name="l01364"></a>01364                         {
<a name="l01365"></a>01365                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;HFC&quot;</span>;
<a name="l01366"></a>01366                                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01367"></a>01367                                 { 
<a name="l01368"></a>01368                                         <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;isotope-&gt;Element==<span class="stringliteral">&quot;e&quot;</span>)
<a name="l01369"></a>01369                                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID));
<a name="l01370"></a>01370                                 };
<a name="l01371"></a>01371                         }
<a name="l01372"></a>01372                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eae4a1b28ecfe89d0bac93fee76b23ba68">InteractionKind::Shift</a>)
<a name="l01373"></a>01373                         {
<a name="l01374"></a>01374                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;Shift&quot;</span>;
<a name="l01375"></a>01375                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID));
<a name="l01376"></a>01376                         }
<a name="l01377"></a>01377                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>)
<a name="l01378"></a>01378                         {
<a name="l01379"></a>01379                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;J-coupling&quot;</span>;
<a name="l01380"></a>01380                                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01381"></a>01381                                 { 
<a name="l01382"></a>01382                                         <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;isotope-&gt;Element!=<span class="stringliteral">&quot;e&quot;</span> &amp;&amp;
<a name="l01383"></a>01383                                                 ((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID!=
<a name="l01384"></a>01384                                                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID)
<a name="l01385"></a>01385                                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID));
<a name="l01386"></a>01386                                 };
<a name="l01387"></a>01387                         }
<a name="l01388"></a>01388                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eac17339440287fe2fd6774ac931c67eb7">InteractionKind::Quadrupolar</a>)
<a name="l01389"></a>01389                         {
<a name="l01390"></a>01390                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;Quadrupolar&quot;</span>;
<a name="l01391"></a>01391                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID));
<a name="l01392"></a>01392                         }
<a name="l01393"></a>01393                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea002c54e14f8b8cc5a33e76e39d67a6a0">InteractionKind::GTensor</a>)
<a name="l01394"></a>01394                         {
<a name="l01395"></a>01395                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;G-tensor&quot;</span>;
<a name="l01396"></a>01396                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID));
<a name="l01397"></a>01397                         }
<a name="l01398"></a>01398                         <span class="comment">//                      else if (((Interaction^)SystemModel-&gt;InteractionCollection[i])-&gt;IntKind==InteractionKind::Dipolar)</span>
<a name="l01399"></a>01399                         <span class="comment">//                      dataGridView2[3,jj]-&gt;Value=&quot;Dipolar&quot;;</span>
<a name="l01400"></a>01400                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>)
<a name="l01401"></a>01401                         {
<a name="l01402"></a>01402                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;Exchange&quot;</span>;
<a name="l01403"></a>01403                                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a4832f15df7de47e9f4ec36b117041539" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01404"></a>01404                                 { 
<a name="l01405"></a>01405                                         <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;isotope-&gt;Element==<span class="stringliteral">&quot;e&quot;</span> &amp;&amp;
<a name="l01406"></a>01406                                                 ((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID!=
<a name="l01407"></a>01407                                                 ((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID)
<a name="l01408"></a>01408                                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_atom.html">Atom</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>[j])-&gt;ID));
<a name="l01409"></a>01409                                 };
<a name="l01410"></a>01410                         }
<a name="l01411"></a>01411                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;IntKind==<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea26da56330c608adf3b3477986a12735f">InteractionKind::ZFS</a>)
<a name="l01412"></a>01412                         {
<a name="l01413"></a>01413                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[3,jj]-&gt;Value=<span class="stringliteral">&quot;Zero-Field&quot;</span>;
<a name="l01414"></a>01414                                 ncombobox-&gt;Items-&gt;Add(Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^ )<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID));
<a name="l01415"></a>01415                         };
<a name="l01416"></a>01416 
<a name="l01417"></a>01417                         
<a name="l01418"></a>01418                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,jj]=ncombobox;
<a name="l01419"></a>01419 
<a name="l01420"></a>01420 
<a name="l01421"></a>01421                         <span class="comment">//Atom B ID</span>
<a name="l01422"></a>01422                         <span class="comment">//Select B Atom</span>
<a name="l01423"></a>01423                     <span class="keywordflow">if</span>(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;B!=<span class="keyword">nullptr</span>) 
<a name="l01424"></a>01424                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,jj]-&gt;Value=Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;B-&gt;ID);
<a name="l01425"></a>01425                         <span class="keywordflow">else</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[4,jj]-&gt;Value=Convert::ToString(((<a class="code" href="class_interaction.html">Interaction</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;A-&gt;ID);
<a name="l01426"></a>01426                         
<a name="l01427"></a>01427                         <span class="comment">//Create first the comboBox with the options of reference frames</span>
<a name="l01428"></a>01428                         DataGridViewComboBoxCell^ refcombobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01429"></a>01429                         <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#ac4bf3754525cbdb370387718ad4dd579" title="Property Keys for giving the keys of the collection.">Keys</a>) 
<a name="l01430"></a>01430                                         refcombobox-&gt;Items-&gt;Add(Convert::ToString(j));
<a name="l01431"></a>01431                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,jj]=refcombobox;
<a name="l01432"></a>01432                         <span class="comment">//Select reference frame</span>
<a name="l01433"></a>01433                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,jj]-&gt;Value=Convert::ToString(((<a class="code" href="class_tensor.html">Tensor</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[i])-&gt;Frame-&gt;getID());
<a name="l01434"></a>01434 
<a name="l01435"></a>01435 
<a name="l01436"></a>01436                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[1,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01437"></a>01437                         dataGridView2[2,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01438"></a>01438                         dataGridView2[3,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01439"></a>01439                         dataGridView2[4,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01440"></a>01440                         dataGridView2[5,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01441"></a>01441                         dataGridView2[6,jj]-&gt;Value=<span class="stringliteral">&quot;Edit&quot;</span>;
<a name="l01442"></a>01442                         dataGridView2[6,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01443"></a>01443                         dataGridView2[7,jj]-&gt;ReadOnly=<span class="keyword">false</span>;
<a name="l01444"></a>01444 
<a name="l01445"></a>01445                         jj++;
<a name="l01446"></a>01446                 };
<a name="l01447"></a>01447 
<a name="l01448"></a>01448                 
<a name="l01449"></a>01449         };
<a name="l01450"></a>01450 
<a name="l01451"></a>01451         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Sort(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Columns[1],ListSortDirection::Ascending);
<a name="l01452"></a>01452         
<a name="l01453"></a>01453 }
<a name="l01454"></a>01454 
<a name="l01455"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a46f016ea50bba66a444a24fe7c82bbef">01455</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a46f016ea50bba66a444a24fe7c82bbef">SpinachGUI::MainForm::dataGridView2_MouseEnter</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01456"></a>01456 {
<a name="l01457"></a>01457         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;Focus();
<a name="l01458"></a>01458 }
<a name="l01459"></a>01459 
<a name="l01460"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa402445e30c0bb76c482f4e6badaa58b">01460</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa402445e30c0bb76c482f4e6badaa58b">SpinachGUI::MainForm::dataGridView2_Paint</a>(System::Object^  sender, System::Windows::Forms::PaintEventArgs^  e) 
<a name="l01461"></a>01461 {
<a name="l01462"></a>01462         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6b4493c3ff99e8fcf1362a1700f03b9b">dataGridView_Helpers</a>();
<a name="l01463"></a>01463 }
<a name="l01464"></a>01464 
<a name="l01465"></a>01465 <span class="comment"></span>
<a name="l01466"></a>01466 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01467"></a>01467 <span class="comment"></span><span class="comment">// Edit RefFramestreeview for reference frames</span>
<a name="l01468"></a>01468 
<a name="l01469"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0bbac93cc93d09e0a963cd011b407b36">01469</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0bbac93cc93d09e0a963cd011b407b36">SpinachGUI::MainForm::treeView_RefFrames_Update</a>() 
<a name="l01470"></a>01470 {
<a name="l01471"></a>01471         <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#ac4bf3754525cbdb370387718ad4dd579" title="Property Keys for giving the keys of the collection.">Keys</a>)
<a name="l01472"></a>01472         {
<a name="l01473"></a>01473                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[i]-&gt;getID()!=1)
<a name="l01474"></a>01474                 {
<a name="l01475"></a>01475                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae4d94b8f6dc796d23a7c57e75667078d">FindNodeRecurcively</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;Nodes[0], 
<a name="l01476"></a>01476                                 Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[i]-&gt;ParentRefFrame-&gt;getID()))-&gt;Nodes-&gt;Add(
<a name="l01477"></a>01477                                 Convert::ToString(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[i]-&gt;getID()),
<a name="l01478"></a>01478                                 (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[i]-&gt;Label==<span class="keyword">nullptr</span>? <span class="stringliteral">&quot;Ref. Frame &quot;</span>: 
<a name="l01479"></a>01479                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[i]-&gt;Label)+<span class="stringliteral">&quot;[&quot;</span>+<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[i]-&gt;getID()+<span class="stringliteral">&quot;]&quot;</span>);
<a name="l01480"></a>01480                 }
<a name="l01481"></a>01481         };
<a name="l01482"></a>01482 
<a name="l01483"></a>01483         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;ExpandAll();
<a name="l01484"></a>01484 }
<a name="l01485"></a>01485 
<a name="l01486"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afd2c25076a89a3fdc1c262f05bee76f3">01486</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afd2c25076a89a3fdc1c262f05bee76f3">SpinachGUI::MainForm::RefFramestreeView_BeforeLabelEdit</a>(System::Object^  sender, System::Windows::Forms::NodeLabelEditEventArgs^  e) 
<a name="l01487"></a>01487 {
<a name="l01488"></a>01488         array&lt;wchar_t&gt;^ trimChars={<span class="charliteral">&#39;[&#39;</span>,<span class="charliteral">&#39;]&#39;</span>,<span class="charliteral">&#39;0&#39;</span>,<span class="charliteral">&#39;1&#39;</span>,<span class="charliteral">&#39;2&#39;</span>,<span class="charliteral">&#39;3&#39;</span>,<span class="charliteral">&#39;4&#39;</span>,<span class="charliteral">&#39;5&#39;</span>,<span class="charliteral">&#39;6&#39;</span>,<span class="charliteral">&#39;7&#39;</span>,<span class="charliteral">&#39;8&#39;</span>,<span class="charliteral">&#39;9&#39;</span>};
<a name="l01489"></a>01489         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6be66f928fd89aea3e45b3811284e16b">labelflag</a>){
<a name="l01490"></a>01490                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab7573c923de6e11e998cf5617f3838cd">SetSenders</a>^ method= <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab7573c923de6e11e998cf5617f3838cd">SetSenders</a>(<span class="keyword">this</span>, &amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae63a486c066992d49c25f969f933e4ed">MainForm::Delegate3Method</a>);
<a name="l01491"></a>01491                 e-&gt;Node-&gt;Text=e-&gt;Node-&gt;Text-&gt;TrimEnd(trimChars);
<a name="l01492"></a>01492                 System::Windows::Forms::NodeLabelEditEventArgs^ ne=
<a name="l01493"></a>01493                         <span class="keyword">gcnew</span> System::Windows::Forms::NodeLabelEditEventArgs(e-&gt;Node);
<a name="l01494"></a>01494                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;BeginInvoke(method,sender,ne);
<a name="l01495"></a>01495         }
<a name="l01496"></a>01496         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6be66f928fd89aea3e45b3811284e16b">labelflag</a>=<span class="keyword">true</span>;
<a name="l01497"></a>01497 
<a name="l01498"></a>01498 }
<a name="l01499"></a>01499 
<a name="l01500"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae63a486c066992d49c25f969f933e4ed">01500</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae63a486c066992d49c25f969f933e4ed">SpinachGUI::MainForm::Delegate3Method</a>(System::Object^  sender, System::Windows::Forms::NodeLabelEditEventArgs^  e)
<a name="l01501"></a>01501 {
<a name="l01502"></a>01502         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6be66f928fd89aea3e45b3811284e16b">labelflag</a>=<span class="keyword">false</span>;
<a name="l01503"></a>01503         e-&gt;Node-&gt;BeginEdit();
<a name="l01504"></a>01504 }
<a name="l01505"></a>01505 
<a name="l01506"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af978f51a40b21b4bc2462d64362b1952">01506</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af978f51a40b21b4bc2462d64362b1952">SpinachGUI::MainForm::RefFramestreeView_AfterLabelEdit</a>(System::Object^  sender, System::Windows::Forms::NodeLabelEditEventArgs^  e) 
<a name="l01507"></a>01507 {
<a name="l01508"></a>01508         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6be66f928fd89aea3e45b3811284e16b">labelflag</a>)
<a name="l01509"></a>01509         {
<a name="l01510"></a>01510                 e-&gt;CancelEdit = <span class="keyword">true</span>;
<a name="l01511"></a>01511                 e-&gt;Node-&gt;Text=(e-&gt;Label!=<span class="keyword">nullptr</span>?e-&gt;Label:e-&gt;Node-&gt;Text)+<span class="stringliteral">&quot; [&quot;</span>+e-&gt;Node-&gt;Name+<span class="stringliteral">&quot;]&quot;</span>;
<a name="l01512"></a>01512                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[Convert::ToInt32(e-&gt;Node-&gt;Name)]-&gt;Label=e-&gt;Label;
<a name="l01513"></a>01513         };
<a name="l01514"></a>01514 
<a name="l01515"></a>01515 }
<a name="l01516"></a>01516 
<a name="l01517"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a004e1285ff159e96cb2fd80d1b1b5cf1">01517</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a004e1285ff159e96cb2fd80d1b1b5cf1">SpinachGUI::MainForm::AddNodeButton_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01518"></a>01518 {
<a name="l01519"></a>01519         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode!=<span class="keyword">nullptr</span>)
<a name="l01520"></a>01520         {
<a name="l01521"></a>01521                 <span class="comment">//Create Reference Frame in the SystemModel</span>
<a name="l01522"></a>01522                 <a class="code" href="class_reference_frame.html">ReferenceFrame</a>^ refFrame=<span class="keyword">gcnew</span> <a class="code" href="class_reference_frame.html">ReferenceFrame</a>();
<a name="l01523"></a>01523                 refFrame-&gt;<a class="code" href="class_reference_frame.html#a4806dd7454843eab35b91a65170c2e5b" title="The parent reference frame of this reference frame.">ParentRefFrame</a>=
<a name="l01524"></a>01524                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[Convert::ToInt32(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode-&gt;Name)];
<a name="l01525"></a>01525                 refFrame-&gt;<a class="code" href="class_reference_frame.html#a40c899fae97085475ebfe616e241a026" title="Property Label for giving or setting the label of the reference frame.">Label</a>=<span class="stringliteral">&quot;Ref. Frame&quot;</span>;
<a name="l01526"></a>01526                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#a58496087004766c6f8bef676f16484a5">Add</a>(refFrame);
<a name="l01527"></a>01527 
<a name="l01528"></a>01528                 <span class="comment">//Create this reference frame in the  RefFramestreeview </span>
<a name="l01529"></a>01529                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode-&gt;Nodes-&gt;Add(Convert::ToString(refFrame-&gt;<a class="code" href="class_reference_frame.html#a028b1d551d461d23d16f683df8199b80" title="Getter for the reference frame ID.">getID</a>()),
<a name="l01530"></a>01530                         <span class="stringliteral">&quot;Ref. Frame [&quot;</span>+refFrame-&gt;<a class="code" href="class_reference_frame.html#a028b1d551d461d23d16f683df8199b80" title="Getter for the reference frame ID.">getID</a>()+<span class="stringliteral">&quot;]&quot;</span>);
<a name="l01531"></a>01531                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;ExpandAll();
<a name="l01532"></a>01532 
<a name="l01533"></a>01533                 <span class="comment">// Add this reference frame ID in the menu in the interaction table</span>
<a name="l01534"></a>01534                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;RowCount-1;i++)
<a name="l01535"></a>01535                         ((DataGridViewComboBoxCell^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,i])-&gt;Items-&gt;Add(Convert::ToString((refFrame-&gt;<a class="code" href="class_reference_frame.html#a028b1d551d461d23d16f683df8199b80" title="Getter for the reference frame ID.">getID</a>())));
<a name="l01536"></a>01536         }
<a name="l01537"></a>01537 }
<a name="l01538"></a>01538 
<a name="l01539"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae76ba221a1686cbd4286203da40c1c01">01539</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae76ba221a1686cbd4286203da40c1c01">SpinachGUI::MainForm::DeleteNodeButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01540"></a>01540 {
<a name="l01541"></a>01541         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode!=<span class="keyword">nullptr</span> &amp;&amp; Convert::ToInt32(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode-&gt;Name)!=1)
<a name="l01542"></a>01542         {
<a name="l01543"></a>01543                 <span class="keywordflow">try</span>
<a name="l01544"></a>01544                 {
<a name="l01545"></a>01545                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#abfd7011a9cda3d7ce30a31aa791ccd4d">RemoveAt</a>(Convert::ToInt32(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode-&gt;Name));
<a name="l01546"></a>01546                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;Nodes[0]-&gt;Nodes-&gt;Clear();
<a name="l01547"></a>01547                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0bbac93cc93d09e0a963cd011b407b36">treeView_RefFrames_Update</a>();
<a name="l01548"></a>01548 
<a name="l01549"></a>01549 
<a name="l01550"></a>01550                         <span class="comment">//Update dropmenu in interactions</span>
<a name="l01551"></a>01551             
<a name="l01552"></a>01552                         <span class="comment">//Create first the comboBox with the options of reference frames</span>
<a name="l01553"></a>01553                         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>-&gt;RowCount-1;i++)
<a name="l01554"></a>01554                         {
<a name="l01555"></a>01555                                 <span class="keywordtype">int</span> jj=Convert::ToInt32(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[0,i]-&gt;Value);
<a name="l01556"></a>01556                                 DataGridViewComboBoxCell^ refcombobox=<span class="keyword">gcnew</span> DataGridViewComboBoxCell();
<a name="l01557"></a>01557                                 <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> j <span class="keywordflow">in</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#ac4bf3754525cbdb370387718ad4dd579" title="Property Keys for giving the keys of the collection.">Keys</a>) 
<a name="l01558"></a>01558                                         refcombobox-&gt;Items-&gt;Add(Convert::ToString(j));
<a name="l01559"></a>01559                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,i]=refcombobox;
<a name="l01560"></a>01560                                 <span class="comment">//Select reference frame</span>
<a name="l01561"></a>01561                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a923260539c4b66dcf08ca6760345f90f">dataGridView2</a>[5,i]-&gt;Value=Convert::ToString(((<a class="code" href="class_tensor.html">Tensor</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[jj])-&gt;Frame-&gt;getID());
<a name="l01562"></a>01562                         };
<a name="l01563"></a>01563 
<a name="l01564"></a>01564 
<a name="l01565"></a>01565                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">CheckExistentInteractions</a>(<span class="keyword">true</span>);
<a name="l01566"></a>01566                         <span class="comment">//OpenGL-&gt;Render();</span>
<a name="l01567"></a>01567                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01568"></a>01568                 }
<a name="l01569"></a>01569                 <span class="keywordflow">catch</span>(String ^ e)   {MessageBox::Show(e, <span class="stringliteral">&quot;Error&quot;</span>, MessageBoxButtons::OK, MessageBoxIcon::Error);};
<a name="l01570"></a>01570         }
<a name="l01571"></a>01571 }
<a name="l01572"></a>01572 
<a name="l01573"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0295ff4a9a361d617a14d8356a407f9">01573</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0295ff4a9a361d617a14d8356a407f9">SpinachGUI::MainForm::MakeLabButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01574"></a>01574 {
<a name="l01575"></a>01575         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode!=<span class="keyword">nullptr</span>)
<a name="l01576"></a>01576         {
<a name="l01577"></a>01577                 <span class="comment">/*</span>
<a name="l01578"></a>01578 <span class="comment">                TreeNode ^ tnode=gcnew TreeNode();</span>
<a name="l01579"></a>01579 <span class="comment">                RefFramestreeView-&gt;SelectedNode-&gt;Text=&quot;New Lab &quot;+ RefFramestreeView-&gt;SelectedNode-&gt;Text;</span>
<a name="l01580"></a>01580 <span class="comment">                //save in this new node(new root) the selected one plus the children</span>
<a name="l01581"></a>01581 <span class="comment">                if(Convert::ToInt32(RefFramestreeView-&gt;SelectedNode-&gt;Name)&gt;1) </span>
<a name="l01582"></a>01582 <span class="comment">                        tnode=RefFramestreeView-&gt;SelectedNode;</span>
<a name="l01583"></a>01583 <span class="comment">                //Remove selected (new root)from the current </span>
<a name="l01584"></a>01584 <span class="comment">                RefFramestreeView-&gt;SelectedNode-&gt;Remove();</span>
<a name="l01585"></a>01585 <span class="comment">                //Rename old lab Frame</span>
<a name="l01586"></a>01586 <span class="comment">                RefFramestreeView-&gt;TopNode-&gt;Text=&quot;Old &quot;+RefFramestreeView-&gt;TopNode-&gt;Text;</span>
<a name="l01587"></a>01587 <span class="comment">                //Add the rest of the tree as a child in the new node</span>
<a name="l01588"></a>01588 <span class="comment">                tnode-&gt;Nodes-&gt;Add((TreeNode ^)RefFramestreeView-&gt;TopNode-&gt;Clone());</span>
<a name="l01589"></a>01589 <span class="comment">                //Clear the current</span>
<a name="l01590"></a>01590 <span class="comment">                RefFramestreeView-&gt;Nodes-&gt;Clear();</span>
<a name="l01591"></a>01591 <span class="comment">                //Set the new node to currennt</span>
<a name="l01592"></a>01592 <span class="comment">                RefFramestreeView-&gt;Nodes-&gt;Add(tnode);</span>
<a name="l01593"></a>01593 <span class="comment">                */</span>
<a name="l01594"></a>01594                 <a class="code" href="class_reference_frame.html">ReferenceFrame</a>^ frame=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[Convert::ToInt32(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;SelectedNode-&gt;Name)];
<a name="l01595"></a>01595                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#a87ad7449595ab98bc6b4365db554c622">MakeFrameLabFrame</a>(frame);
<a name="l01596"></a>01596                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afc1a1c5e077df443735539bd7022b250">RefFramestreeView</a>-&gt;Nodes[0]-&gt;Nodes-&gt;Clear();
<a name="l01597"></a>01597                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0bbac93cc93d09e0a963cd011b407b36">treeView_RefFrames_Update</a>();
<a name="l01598"></a>01598                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">CheckExistentInteractions</a>(<span class="keyword">true</span>);
<a name="l01599"></a>01599                 <span class="comment">//OpenGL-&gt;Render();</span>
<a name="l01600"></a>01600                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01601"></a>01601         }
<a name="l01602"></a>01602 }
<a name="l01603"></a>01603 
<a name="l01604"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5899309d232691a9f1e9dee53d777b2b">01604</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5899309d232691a9f1e9dee53d777b2b">SpinachGUI::MainForm::RefFramestreeView_NodeMouseDoubleClick</a>(System::Object^  sender, System::Windows::Forms::TreeNodeMouseClickEventArgs^  e) 
<a name="l01605"></a>01605 {
<a name="l01606"></a>01606         <span class="keywordtype">int</span> k=Convert::ToInt32(e-&gt;Node-&gt;Name);
<a name="l01607"></a>01607         <a class="code" href="class_spinach_g_u_i_1_1_ref_frame_orientation_dialog.html">RefFrameOrientationDialog</a>^ RefFramedialog;
<a name="l01608"></a>01608         RefFramedialog = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_ref_frame_orientation_dialog.html">RefFrameOrientationDialog</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>[k],<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>);
<a name="l01609"></a>01609         RefFramedialog-&gt;ShowDialog();
<a name="l01610"></a>01610 }
<a name="l01611"></a>01611 
<a name="l01612"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9e24d5d0c69f2b0b1cd486b6fcdca79a">01612</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9e24d5d0c69f2b0b1cd486b6fcdca79a">SpinachGUI::MainForm::ReferencecheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01613"></a>01613 {
<a name="l01614"></a>01614 
<a name="l01615"></a>01615         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a44b9634d3a01e26c244d965f1eb9a0f1" title="Flag for showing current reference frame axis of interaction.">ReferenceFrameAxesFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad49d29faefc444c990205f1dead0811e">ReferencecheckBox</a>-&gt;Checked;
<a name="l01616"></a>01616         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01617"></a>01617 }
<a name="l01618"></a>01618 
<a name="l01619"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae4d94b8f6dc796d23a7c57e75667078d">01619</a> TreeNode^ <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae4d94b8f6dc796d23a7c57e75667078d">SpinachGUI::MainForm::FindNodeRecurcively</a>(TreeNode ^Root, String ^Name)
<a name="l01620"></a>01620 {
<a name="l01621"></a>01621         TreeNode^ test;
<a name="l01622"></a>01622         <span class="keywordflow">if</span>(Root-&gt;Name==Name) <span class="keywordflow">return</span> Root;
<a name="l01623"></a>01623         <span class="keywordflow">if</span>(Root-&gt;Nodes-&gt;Count==0) <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;
<a name="l01624"></a>01624 
<a name="l01625"></a>01625         <span class="keywordflow">for each</span>(TreeNode ^ node <span class="keywordflow">in</span> Root-&gt;Nodes)
<a name="l01626"></a>01626         {
<a name="l01627"></a>01627                 test=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae4d94b8f6dc796d23a7c57e75667078d">FindNodeRecurcively</a>(node, Name);
<a name="l01628"></a>01628                 <span class="keywordflow">if</span>(test!=<span class="keyword">nullptr</span>) <span class="keywordflow">return</span> test;
<a name="l01629"></a>01629         }
<a name="l01630"></a>01630 
<a name="l01631"></a>01631         <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">//For the compiler to not complain</span>
<a name="l01632"></a>01632 }
<a name="l01633"></a>01633 <span class="comment"></span>
<a name="l01634"></a>01634 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01635"></a>01635 <span class="comment"></span><span class="comment">//Trackbar interactions</span>
<a name="l01636"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae09a8303441b15211f840f1251d988cf">01636</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae09a8303441b15211f840f1251d988cf">SpinachGUI::MainForm::HFCtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01637"></a>01637 {
<a name="l01638"></a>01638         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01639"></a>01639         {
<a name="l01640"></a>01640                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afe34ce939edd9ed01b8df562629ab40b">HCfactor</a>=pow(10,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#addb8c546e1158655645dbccd4020015a">HFCtrackBar</a>-&gt;Value/10.0);
<a name="l01641"></a>01641                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01642"></a>01642         }
<a name="l01643"></a>01643 }
<a name="l01644"></a>01644 
<a name="l01645"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af17b52d955bf43c6198b11968399c66c">01645</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af17b52d955bf43c6198b11968399c66c">SpinachGUI::MainForm::CStrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01646"></a>01646 { 
<a name="l01647"></a>01647         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01648"></a>01648         {
<a name="l01649"></a>01649                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a655fb8e18d522e43daec2256cfee5937">CSfactor</a>=pow(10.0f,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaa93a5c90977dc9e56e1e49bbcdfe451">CStrackBar</a>-&gt;Value/10.0f);
<a name="l01650"></a>01650                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01651"></a>01651         }
<a name="l01652"></a>01652 }
<a name="l01653"></a>01653 
<a name="l01654"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a51c642c2d16f0e36208792f73bc982d9">01654</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a51c642c2d16f0e36208792f73bc982d9">SpinachGUI::MainForm::BondtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01655"></a>01655 {
<a name="l01656"></a>01656         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01657"></a>01657         {
<a name="l01658"></a>01658                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a8235a35f4031b6695623c3cfe403f73e" title="Multiplication factor for the size of ellipsoids.">CBfactor</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac9d283e6bcc31cec8ecbd155f0391e49">BondtrackBar</a>-&gt;Value/100.0;
<a name="l01659"></a>01659                 <span class="keywordtype">double</span> test=2.0*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a8235a35f4031b6695623c3cfe403f73e" title="Multiplication factor for the size of ellipsoids.">CBfactor</a>-0.5)*
<a name="l01660"></a>01660                                     (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[InteractionKind::CBond]-1.6f)+1.6f;
<a name="l01661"></a>01661                 test=(test&gt;0?test:0.0f);
<a name="l01662"></a>01662                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a63407fe8fc2579c5b6661e9f6d3116a3">BondColorlabel</a>-&gt;Text=<span class="stringliteral">&quot;BOND &lt; &quot;</span>+(test).ToString(<span class="stringliteral">&quot;N2&quot;</span>)+<span class="stringliteral">&quot; An&quot;</span>;
<a name="l01663"></a>01663                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01664"></a>01664         }
<a name="l01665"></a>01665 }
<a name="l01666"></a>01666 
<a name="l01667"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a963a27daee78044c8810be3556d9add1">01667</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a963a27daee78044c8810be3556d9add1">SpinachGUI::MainForm::JCtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01668"></a>01668 {
<a name="l01669"></a>01669         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01670"></a>01670         {
<a name="l01671"></a>01671                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a1782f41a5c8ffb35aa6704dfb68d9f21">JCfactor</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5fae1983e82c36bcd4ae88e378b62785">JCtrackBar</a>-&gt;Value/100.0;
<a name="l01672"></a>01672                 <span class="keywordtype">double</span> absMax=(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>])&lt;
<a name="l01673"></a>01673                            abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]))*
<a name="l01674"></a>01674                                    abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>])+
<a name="l01675"></a>01675                                    (abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>])&gt;
<a name="l01676"></a>01676                                    abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]))*
<a name="l01677"></a>01677                                    abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]);
<a name="l01678"></a>01678 
<a name="l01679"></a>01679                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4ccf7c09029252c739533c23c1ca1645">JCColorlabel</a>-&gt;Text=<span class="stringliteral">&quot;J-COUPLING  &gt; &quot;</span>+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a1782f41a5c8ffb35aa6704dfb68d9f21">JCfactor</a>*absMax).ToString(<span class="stringliteral">&quot;N2&quot;</span>)+<span class="stringliteral">&quot; Hz&quot;</span>;
<a name="l01680"></a>01680                  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01681"></a>01681         }
<a name="l01682"></a>01682 }
<a name="l01683"></a>01683 
<a name="l01684"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9937027bdd1ebeba5194a27dc6d2ec60">01684</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9937027bdd1ebeba5194a27dc6d2ec60">SpinachGUI::MainForm::GTtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01685"></a>01685 {
<a name="l01686"></a>01686         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01687"></a>01687         {
<a name="l01688"></a>01688                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a022a3a713d0801b7427cabca634a3ec3">GTfactor</a>=pow(10,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a622b73087a36479909ca8cd42e920764">GTtrackBar</a>-&gt;Value/10.0);
<a name="l01689"></a>01689                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01690"></a>01690         }
<a name="l01691"></a>01691 }
<a name="l01692"></a>01692 
<a name="l01693"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a285db727612b415cff67204af881e459">01693</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a285db727612b415cff67204af881e459">SpinachGUI::MainForm::QCtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01694"></a>01694 {
<a name="l01695"></a>01695         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01696"></a>01696         {
<a name="l01697"></a>01697                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af054791eff9432418c16d48cd8453023">QCfactor</a>=pow(10,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a601149241a089b20bbba154ff320d5c7">QCtrackBar</a>-&gt;Value/10.0);
<a name="l01698"></a>01698                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01699"></a>01699         }
<a name="l01700"></a>01700 }
<a name="l01701"></a>01701 
<a name="l01702"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2ab7c7d670ef95b717faa71e0b449538">01702</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2ab7c7d670ef95b717faa71e0b449538">SpinachGUI::MainForm::ECtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01703"></a>01703 {
<a name="l01704"></a>01704         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01705"></a>01705         {
<a name="l01706"></a>01706                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a9c0396e7c649b1fc08390be9d045c20f">ECfactor</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0989f0d7b98a3eae2465130be263be68">ECtrackBar</a>-&gt;Value/100.0;
<a name="l01707"></a>01707                 <span class="keywordtype">double</span> absMax=(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>])&lt;
<a name="l01708"></a>01708                            abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]))*
<a name="l01709"></a>01709                                    abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>])+
<a name="l01710"></a>01710                                    (abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>])&gt;
<a name="l01711"></a>01711                                    abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]))*
<a name="l01712"></a>01712                                    abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]);
<a name="l01713"></a>01713                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a77bd6ecdf85e95071216791e54abe">ECColorlabel</a>-&gt;Text=<span class="stringliteral">&quot;EXCHANGE COUPL.&gt; &quot;</span>+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a9c0396e7c649b1fc08390be9d045c20f">ECfactor</a>*absMax).ToString(<span class="stringliteral">&quot;N2&quot;</span>)+<span class="stringliteral">&quot; MHz&quot;</span>;
<a name="l01714"></a>01714                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01715"></a>01715         }
<a name="l01716"></a>01716 }
<a name="l01717"></a>01717 
<a name="l01718"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5dfdd7d44be4c8c066be9c845b2d217d">01718</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5dfdd7d44be4c8c066be9c845b2d217d">SpinachGUI::MainForm::ZFtrackBar_Scroll</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01719"></a>01719 {
<a name="l01720"></a>01720         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>)
<a name="l01721"></a>01721         {
<a name="l01722"></a>01722                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a1e7566b011cd74b57ad1f52d4dc0b09e" title="Multiplication factor for the size of ellipsoids.">ZFfactor</a>=pow(10,<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a571a1d88b54e5e32a1d1efe1aee152d5">ZFtrackBar</a>-&gt;Value/10.0);
<a name="l01723"></a>01723                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01724"></a>01724         }
<a name="l01725"></a>01725 }<span class="comment"></span>
<a name="l01726"></a>01726 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01727"></a>01727 <span class="comment"></span><span class="comment">//CheckBox interactions</span>
<a name="l01728"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad84da62936b233bf233f0944dd1027a1">01728</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad84da62936b233bf233f0944dd1027a1">SpinachGUI::MainForm::HFCcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01729"></a>01729 {
<a name="l01730"></a>01730         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a228adfdf34ef201300550f0f5467e446">HCFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;Checked;
<a name="l01731"></a>01731         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01732"></a>01732 }
<a name="l01733"></a>01733 
<a name="l01734"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad2e2e1e2023b01d252c7cba06abbdccc">01734</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad2e2e1e2023b01d252c7cba06abbdccc">SpinachGUI::MainForm::CScheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01735"></a>01735 {
<a name="l01736"></a>01736         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afa59a811285e41674e9f16ea7b6f77ba">CSFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;Checked;
<a name="l01737"></a>01737          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01738"></a>01738 }
<a name="l01739"></a>01739 
<a name="l01740"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1f4c25ec756bab31bde0226eb8ae3551">01740</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1f4c25ec756bab31bde0226eb8ae3551">SpinachGUI::MainForm::BondcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01741"></a>01741 {
<a name="l01742"></a>01742         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fd00e0dce38f247c53b463fb332a364" title="Flags for showing kind of interactions.">CBFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;Checked;
<a name="l01743"></a>01743         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01744"></a>01744 }
<a name="l01745"></a>01745 
<a name="l01746"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afe853f6e571fd177a632e723d882149b">01746</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afe853f6e571fd177a632e723d882149b">SpinachGUI::MainForm::JCcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01747"></a>01747 {
<a name="l01748"></a>01748         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a38fcd62b067631ddbf9a246de902a60d">JCFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1b990cb1428e1f146caf86e7c6fd40f6">JCcheckBox</a>-&gt;Checked;
<a name="l01749"></a>01749         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01750"></a>01750 }
<a name="l01751"></a>01751 
<a name="l01752"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaf64b5bae09f0442ac72a13d98c83060">01752</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaf64b5bae09f0442ac72a13d98c83060">SpinachGUI::MainForm::GTcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01753"></a>01753 {
<a name="l01754"></a>01754         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a13624261209264386df1cde404b1ed6e">GTFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;Checked;
<a name="l01755"></a>01755         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01756"></a>01756 }
<a name="l01757"></a>01757 
<a name="l01758"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8eaf81fe1715a86f61e3b8a072ed642f">01758</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8eaf81fe1715a86f61e3b8a072ed642f">SpinachGUI::MainForm::ECcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01759"></a>01759 {
<a name="l01760"></a>01760         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa88a55e4dc4b4150121add8c84bda00d">ECFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1d748386440db28357f41756507ae5db">ECcheckBox</a>-&gt;Checked;
<a name="l01761"></a>01761          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01762"></a>01762 }
<a name="l01763"></a>01763 
<a name="l01764"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a296d8891b250317121a5ac7ddf314b1e">01764</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a296d8891b250317121a5ac7ddf314b1e">SpinachGUI::MainForm::ZFcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01765"></a>01765 {
<a name="l01766"></a>01766         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d940879e95fc2974a27fb24d55bce89" title="Flags for showing kind of interactions.">ZFFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;Checked;
<a name="l01767"></a>01767          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01768"></a>01768 }
<a name="l01769"></a>01769 
<a name="l01770"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4d31247d2e5f8bd36b8a6721b19bc862">01770</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4d31247d2e5f8bd36b8a6721b19bc862">SpinachGUI::MainForm::QCcheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01771"></a>01771 {
<a name="l01772"></a>01772         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa548f39ed75164d87e04034e809ec70e">QCFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;Checked;
<a name="l01773"></a>01773         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01774"></a>01774 }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776 
<a name="l01777"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a820e851aa6143b709d539ece532de74d">01777</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a820e851aa6143b709d539ece532de74d">SpinachGUI::MainForm::TensorButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01778"></a>01778 {
<a name="l01779"></a>01779         <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((ToolStripButton ^)sender)-&gt;Tag))==1) <span class="comment">//ALL</span>
<a name="l01780"></a>01780         {
<a name="l01781"></a>01781 
<a name="l01782"></a>01782                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a13624261209264386df1cde404b1ed6e">GTFlag</a>=<span class="keyword">true</span>;
<a name="l01783"></a>01783                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afa59a811285e41674e9f16ea7b6f77ba">CSFlag</a>=<span class="keyword">true</span>;
<a name="l01784"></a>01784                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a228adfdf34ef201300550f0f5467e446">HCFlag</a>=<span class="keyword">true</span>;
<a name="l01785"></a>01785                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fd00e0dce38f247c53b463fb332a364" title="Flags for showing kind of interactions.">CBFlag</a>=<span class="keyword">true</span>;
<a name="l01786"></a>01786                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1b990cb1428e1f146caf86e7c6fd40f6">JCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a38fcd62b067631ddbf9a246de902a60d">JCFlag</a>=<span class="keyword">true</span>;
<a name="l01787"></a>01787                 <span class="comment">//                               DCcheckBox-&gt;Checked=OpenGL-&gt;DCFlag=true;</span>
<a name="l01788"></a>01788                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa548f39ed75164d87e04034e809ec70e">QCFlag</a>=<span class="keyword">true</span>;
<a name="l01789"></a>01789                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1d748386440db28357f41756507ae5db">ECcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa88a55e4dc4b4150121add8c84bda00d">ECFlag</a>=<span class="keyword">true</span>;
<a name="l01790"></a>01790                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d940879e95fc2974a27fb24d55bce89" title="Flags for showing kind of interactions.">ZFFlag</a>=<span class="keyword">true</span>;
<a name="l01791"></a>01791 
<a name="l01792"></a>01792         }
<a name="l01793"></a>01793         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((ToolStripButton ^)sender)-&gt;Tag))==2) <span class="comment">//NMR</span>
<a name="l01794"></a>01794         {
<a name="l01795"></a>01795 
<a name="l01796"></a>01796                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a13624261209264386df1cde404b1ed6e">GTFlag</a>=<span class="keyword">false</span>;
<a name="l01797"></a>01797                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afa59a811285e41674e9f16ea7b6f77ba">CSFlag</a>=<span class="keyword">true</span>;
<a name="l01798"></a>01798                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a228adfdf34ef201300550f0f5467e446">HCFlag</a>=<span class="keyword">false</span>;
<a name="l01799"></a>01799                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fd00e0dce38f247c53b463fb332a364" title="Flags for showing kind of interactions.">CBFlag</a>=<span class="keyword">true</span>;
<a name="l01800"></a>01800                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1b990cb1428e1f146caf86e7c6fd40f6">JCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a38fcd62b067631ddbf9a246de902a60d">JCFlag</a>=<span class="keyword">true</span>;
<a name="l01801"></a>01801                 <span class="comment">//                               DCcheckBox-&gt;Checked=OpenGL-&gt;DCFlag=true;</span>
<a name="l01802"></a>01802                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa548f39ed75164d87e04034e809ec70e">QCFlag</a>=<span class="keyword">true</span>;
<a name="l01803"></a>01803                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1d748386440db28357f41756507ae5db">ECcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa88a55e4dc4b4150121add8c84bda00d">ECFlag</a>=<span class="keyword">false</span>;
<a name="l01804"></a>01804                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d940879e95fc2974a27fb24d55bce89" title="Flags for showing kind of interactions.">ZFFlag</a>=<span class="keyword">false</span>;
<a name="l01805"></a>01805         }
<a name="l01806"></a>01806 
<a name="l01807"></a>01807         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((ToolStripButton ^)sender)-&gt;Tag))==3) <span class="comment">//EPR</span>
<a name="l01808"></a>01808         {
<a name="l01809"></a>01809 
<a name="l01810"></a>01810                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a13624261209264386df1cde404b1ed6e">GTFlag</a>=<span class="keyword">true</span>;
<a name="l01811"></a>01811                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afa59a811285e41674e9f16ea7b6f77ba">CSFlag</a>=<span class="keyword">false</span>;
<a name="l01812"></a>01812                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a228adfdf34ef201300550f0f5467e446">HCFlag</a>=<span class="keyword">true</span>;
<a name="l01813"></a>01813                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fd00e0dce38f247c53b463fb332a364" title="Flags for showing kind of interactions.">CBFlag</a>=<span class="keyword">true</span>;
<a name="l01814"></a>01814                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1b990cb1428e1f146caf86e7c6fd40f6">JCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a38fcd62b067631ddbf9a246de902a60d">JCFlag</a>=<span class="keyword">false</span>;
<a name="l01815"></a>01815                 <span class="comment">//                               DCcheckBox-&gt;Checked=OpenGL-&gt;DCFlag=true;</span>
<a name="l01816"></a>01816                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa548f39ed75164d87e04034e809ec70e">QCFlag</a>=<span class="keyword">true</span>;
<a name="l01817"></a>01817                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1d748386440db28357f41756507ae5db">ECcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa88a55e4dc4b4150121add8c84bda00d">ECFlag</a>=<span class="keyword">true</span>;
<a name="l01818"></a>01818                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d940879e95fc2974a27fb24d55bce89" title="Flags for showing kind of interactions.">ZFFlag</a>=<span class="keyword">true</span>;
<a name="l01819"></a>01819         };
<a name="l01820"></a>01820 
<a name="l01821"></a>01821         <span class="comment">//OpenGL-&gt;Render();</span>
<a name="l01822"></a>01822         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01823"></a>01823 
<a name="l01824"></a>01824 }
<a name="l01825"></a>01825 
<a name="l01826"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a282569f0796a8ec19d3188185f2bca54">01826</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a282569f0796a8ec19d3188185f2bca54">SpinachGUI::MainForm::EigenAxescheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01827"></a>01827 {
<a name="l01828"></a>01828         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af7ffeb4b7690dfecb95daab57165b9c0" title="Flag for showing interaction axes.">EigenAxesFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0004f7672716b865c4b0c18704497e3e">EigenAxescheckBox</a>-&gt;Checked;
<a name="l01829"></a>01829         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01830"></a>01830 }
<a name="l01831"></a>01831 
<a name="l01832"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a795e1ae47cd4b19f6d90c959dca56a0c">01832</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a795e1ae47cd4b19f6d90c959dca56a0c">SpinachGUI::MainForm::EigenEllipsoidscheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e)
<a name="l01833"></a>01833 {
<a name="l01834"></a>01834         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac4a2747b4541ead35bf992447bedeec9" title="Flag for showing interaction ellipsoids.">EigenEllipsoidsFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36766accf409b06e050cb976986a8658">EigenEllipsoidscheckBox</a>-&gt;Checked;
<a name="l01835"></a>01835         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01836"></a>01836 }
<a name="l01837"></a>01837 <span class="comment"></span>
<a name="l01838"></a>01838 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01839"></a>01839 <span class="comment"></span><span class="comment">//ColorDialog interactions</span>
<a name="l01840"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aafc4952f9aa4997831be4fea468637cd">01840</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aafc4952f9aa4997831be4fea468637cd">SpinachGUI::MainForm::Colour_DoubleClick</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01841"></a>01841 {
<a name="l01842"></a>01842 
<a name="l01843"></a>01843 
<a name="l01844"></a>01844         <span class="keywordflow">if</span> (  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l01845"></a>01845         {
<a name="l01846"></a>01846                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afba47ca21da6662f9710a6fade444faf">Update_OpenGL_Color</a>(((System::Windows::Forms::Label ^)sender)-&gt;Text, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;Color, <span class="keyword">true</span> );
<a name="l01847"></a>01847                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2448c0f9e67dd5765379e1d475586eee">Update_Interactions_Color</a>();
<a name="l01848"></a>01848                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0ec9fa30f5072a38d9ed495a6392ca5a">tableLayoutPanel7</a>-&gt;Refresh();
<a name="l01849"></a>01849         }
<a name="l01850"></a>01850 
<a name="l01851"></a>01851 }
<a name="l01852"></a>01852 
<a name="l01853"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a362fde6768b475b50f3ee65d80d7e5dc">01853</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a362fde6768b475b50f3ee65d80d7e5dc">SpinachGUI::MainForm::Colorlabel_MouseDoubleClick</a>(System::Object^  sender, System::Windows::Forms::MouseEventArgs^  e)
<a name="l01854"></a>01854 {
<a name="l01855"></a>01855         <span class="keywordflow">if</span> (  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l01856"></a>01856         {
<a name="l01857"></a>01857                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afba47ca21da6662f9710a6fade444faf">Update_OpenGL_Color</a>(((System::Windows::Forms::Label ^)sender)-&gt;Text, <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;Color, e-&gt;Button == ::MouseButtons::Left );
<a name="l01858"></a>01858                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2448c0f9e67dd5765379e1d475586eee">Update_Interactions_Color</a>();
<a name="l01859"></a>01859                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0ec9fa30f5072a38d9ed495a6392ca5a">tableLayoutPanel7</a>-&gt;Refresh();
<a name="l01860"></a>01860         }
<a name="l01861"></a>01861 
<a name="l01862"></a>01862 }
<a name="l01863"></a>01863 <span class="comment"></span>
<a name="l01864"></a>01864 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01865"></a>01865 <span class="comment"></span><span class="comment">// ToolBox Buttons and checkboxes</span>
<a name="l01866"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7cffb40930131b247e270bb81219c9dc">01866</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7cffb40930131b247e270bb81219c9dc">SpinachGUI::MainForm::IsotopesButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01867"></a>01867 {
<a name="l01868"></a>01868         <a class="code" href="class_spinach_g_u_i_1_1_isotopes_dialog.html">IsotopesDialog</a>^ isotopesdialog = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_isotopes_dialog.html">IsotopesDialog</a>();
<a name="l01869"></a>01869         isotopesdialog-&gt;ShowDialog();
<a name="l01870"></a>01870 }
<a name="l01871"></a>01871 
<a name="l01872"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa7b368e8890a52476630e996db35001b">01872</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa7b368e8890a52476630e996db35001b">SpinachGUI::MainForm::HomeButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01873"></a>01873 {
<a name="l01874"></a>01874         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a30ba78422f28b4ce56e5408c8e3f78a6">Home</a>();
<a name="l01875"></a>01875         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a4269a637342af6fb3add0853e1301da6" title="Final Render routine.">Render</a>();
<a name="l01876"></a>01876 
<a name="l01877"></a>01877 }
<a name="l01878"></a>01878 
<a name="l01879"></a>01879 
<a name="l01880"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a239fc79fefe42c884a0b349413928157">01880</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a239fc79fefe42c884a0b349413928157">SpinachGUI::MainForm::ExitButton_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01881"></a>01881 {
<a name="l01882"></a>01882         Application::Exit();
<a name="l01883"></a>01883 }
<a name="l01884"></a>01884 
<a name="l01885"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3397f332f7a76001fb12be0f155e9898">01885</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3397f332f7a76001fb12be0f155e9898">SpinachGUI::MainForm::checkBoxAxes_CheckStateChanged</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01886"></a>01886 {
<a name="l01887"></a>01887         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a735447373bdfe5ed0fda746aaeaa5f72" title="Flag for showing navigation axes.">AxesFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4b5718cbc6975ce96c5363c7eda717a1">checkBoxAxes</a>-&gt;Checked;
<a name="l01888"></a>01888          <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01889"></a>01889 }
<a name="l01890"></a>01890 
<a name="l01891"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2e37cdc3ad68eaa45f3039d632addac5">01891</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2e37cdc3ad68eaa45f3039d632addac5">SpinachGUI::MainForm::BackGroundColorLabel_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01892"></a>01892 {
<a name="l01893"></a>01893         <span class="keywordflow">if</span> (  <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;ShowDialog() == System::Windows::Forms::DialogResult::OK )
<a name="l01894"></a>01894         {
<a name="l01895"></a>01895                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4e75ba1060dc9ac8dd359437f5ddbaff">BackGroundColorLabel</a>-&gt;BackColor =<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a599c09cab98d1d4a393e2e76a81300dc">GenColorDialog</a>-&gt;Color;
<a name="l01896"></a>01896                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a59338162d14cc3c1179d6c90290ce450" title="RGB Matrix for the color.">BackgroundColor</a>[0]=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4e75ba1060dc9ac8dd359437f5ddbaff">BackGroundColorLabel</a>-&gt;BackColor.R/255.0f;
<a name="l01897"></a>01897                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a59338162d14cc3c1179d6c90290ce450" title="RGB Matrix for the color.">BackgroundColor</a>[1]=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4e75ba1060dc9ac8dd359437f5ddbaff">BackGroundColorLabel</a>-&gt;BackColor.G/255.0f;
<a name="l01898"></a>01898                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a59338162d14cc3c1179d6c90290ce450" title="RGB Matrix for the color.">BackgroundColor</a>[2]=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4e75ba1060dc9ac8dd359437f5ddbaff">BackGroundColorLabel</a>-&gt;BackColor.B/255.0f;
<a name="l01899"></a>01899                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a4269a637342af6fb3add0853e1301da6" title="Final Render routine.">Render</a>();
<a name="l01900"></a>01900         }
<a name="l01901"></a>01901 }
<a name="l01902"></a>01902 
<a name="l01903"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10feeb5596a22a60ebfcde73499326f8">01903</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10feeb5596a22a60ebfcde73499326f8">SpinachGUI::MainForm::SelectedInteractionscheckBox_Click</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01904"></a>01904 {
<a name="l01905"></a>01905         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a0f9cb0f634625db9ac37118d7314a044" title="Flag for showing the interaction of the selected atom.">SelectedAtomsInteractionsFlag</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2098dc9803048608dfaa073d6f816084">SelectedInteractionscheckBox</a>-&gt;Checked;
<a name="l01906"></a>01906         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l01907"></a>01907         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l01908"></a>01908 }
<a name="l01909"></a>01909 
<a name="l01910"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09cbb0647441111086c5517e7bdbd792">01910</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a09cbb0647441111086c5517e7bdbd792">SpinachGUI::MainForm::RotateToPlaneClick</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l01911"></a>01911 {
<a name="l01912"></a>01912         <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((Button^)sender)-&gt;Tag))==1) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fa1e17cedd7c3ec6d1d67b770b69a9d" title="Rotates the 3D model to a plane.">RotateToPlane</a>(<span class="charliteral">&#39;X&#39;</span>,<span class="charliteral">&#39;Y&#39;</span>);
<a name="l01913"></a>01913         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((Button^)sender)-&gt;Tag))==2) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fa1e17cedd7c3ec6d1d67b770b69a9d" title="Rotates the 3D model to a plane.">RotateToPlane</a>(<span class="charliteral">&#39;X&#39;</span>,<span class="charliteral">&#39;Z&#39;</span>);
<a name="l01914"></a>01914         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((Button^)sender)-&gt;Tag))==3) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fa1e17cedd7c3ec6d1d67b770b69a9d" title="Rotates the 3D model to a plane.">RotateToPlane</a>(<span class="charliteral">&#39;Z&#39;</span>,<span class="charliteral">&#39;Y&#39;</span>);
<a name="l01915"></a>01915         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((Button^)sender)-&gt;Tag))==4) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fa1e17cedd7c3ec6d1d67b770b69a9d" title="Rotates the 3D model to a plane.">RotateToPlane</a>(<span class="charliteral">&#39;Y&#39;</span>,<span class="charliteral">&#39;X&#39;</span>);
<a name="l01916"></a>01916         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((Button^)sender)-&gt;Tag))==5) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fa1e17cedd7c3ec6d1d67b770b69a9d" title="Rotates the 3D model to a plane.">RotateToPlane</a>(<span class="charliteral">&#39;Z&#39;</span>,<span class="charliteral">&#39;X&#39;</span>);
<a name="l01917"></a>01917         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Convert::ToInt32((String^)(((Button^)sender)-&gt;Tag))==6) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fa1e17cedd7c3ec6d1d67b770b69a9d" title="Rotates the 3D model to a plane.">RotateToPlane</a>(<span class="charliteral">&#39;Y&#39;</span>,<span class="charliteral">&#39;Z&#39;</span>);
<a name="l01918"></a>01918 }
<a name="l01919"></a>01919 <span class="comment"></span>
<a name="l01920"></a>01920 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01921"></a>01921 <span class="comment"></span><span class="comment">//Other</span>
<a name="l01922"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad96af823986c85029abf4faee5182711">01922</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad96af823986c85029abf4faee5182711">SpinachGUI::MainForm::OnMouseDownOpenGL</a>(System::Object^  sender, System::Windows::Forms::MouseEventArgs^  e)
<a name="l01923"></a>01923 {
<a name="l01924"></a>01924 
<a name="l01925"></a>01925         <span class="keywordflow">if</span> (e-&gt;Button == ::MouseButtons::Left) 
<a name="l01926"></a>01926         {
<a name="l01927"></a>01927                 this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0f292c0002385b8560cd42f742cebf44">pictureBoxMouse</a>-&gt;Image=
<a name="l01928"></a>01928                         (cli::safe_cast&lt;System::Drawing::Image^ &gt; (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a04e599b24c20deaa9205dcadce18d5de">MyResources</a>-&gt;GetObject(L<span class="stringliteral">&quot;mouseSelectLeft.Image&quot;</span>)));
<a name="l01929"></a>01929                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36fe788ed42a12146003122a9d3ae59f">StatusBarLabel</a>-&gt;Text=<span class="stringliteral">&quot;Rotation&quot;</span>;
<a name="l01930"></a>01930         }
<a name="l01931"></a>01931         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;Button == ::MouseButtons::Right)
<a name="l01932"></a>01932         {
<a name="l01933"></a>01933                 this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0f292c0002385b8560cd42f742cebf44">pictureBoxMouse</a>-&gt;Image=
<a name="l01934"></a>01934                         (cli::safe_cast&lt;System::Drawing::Image^ &gt; (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a04e599b24c20deaa9205dcadce18d5de">MyResources</a>-&gt;GetObject(L<span class="stringliteral">&quot;mouseSelectRight.Image&quot;</span>)));
<a name="l01935"></a>01935                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36fe788ed42a12146003122a9d3ae59f">StatusBarLabel</a>-&gt;Text=<span class="stringliteral">&quot;Translation&quot;</span>;
<a name="l01936"></a>01936         }
<a name="l01937"></a>01937         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;Button == ::MouseButtons::Middle)
<a name="l01938"></a>01938         {
<a name="l01939"></a>01939                 this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0f292c0002385b8560cd42f742cebf44">pictureBoxMouse</a>-&gt;Image=
<a name="l01940"></a>01940                         (cli::safe_cast&lt;System::Drawing::Image^ &gt; (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a04e599b24c20deaa9205dcadce18d5de">MyResources</a>-&gt;GetObject(L<span class="stringliteral">&quot;mouseSelectScroll.Image&quot;</span>)));
<a name="l01941"></a>01941                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36fe788ed42a12146003122a9d3ae59f">StatusBarLabel</a>-&gt;Text=<span class="stringliteral">&quot;Zoom&quot;</span>;
<a name="l01942"></a>01942         };
<a name="l01943"></a>01943 }
<a name="l01944"></a>01944 
<a name="l01945"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa13eedd852163dc9b815e157df0ea7d2">01945</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aa13eedd852163dc9b815e157df0ea7d2">SpinachGUI::MainForm::OnMouseUpOpenGL</a>(System::Object^  sender, System::Windows::Forms::MouseEventArgs^  e)
<a name="l01946"></a>01946 {
<a name="l01947"></a>01947         this-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0f292c0002385b8560cd42f742cebf44">pictureBoxMouse</a>-&gt;Image=
<a name="l01948"></a>01948                 (cli::safe_cast&lt;System::Drawing::Image^ &gt; (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a04e599b24c20deaa9205dcadce18d5de">MyResources</a>-&gt;GetObject(L<span class="stringliteral">&quot;pictureBoxMouse.Image&quot;</span>)));
<a name="l01949"></a>01949         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36fe788ed42a12146003122a9d3ae59f">StatusBarLabel</a>-&gt;Text=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01950"></a>01950 
<a name="l01951"></a>01951 }
<a name="l01952"></a>01952 
<a name="l01953"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#abb76bba6d9ac0bea0c20568be06a14a1">01953</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#abb76bba6d9ac0bea0c20568be06a14a1">SpinachGUI::MainForm::ToolTips_Popup</a>(System::Object^  sender, System::Windows::Forms::PopupEventArgs^  e) 
<a name="l01954"></a>01954 { 
<a name="l01955"></a>01955         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36fe788ed42a12146003122a9d3ae59f">StatusBarLabel</a>-&gt;Text=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5532988606a1064c41c824c473215e5b">ToolTips</a>-&gt;GetToolTip(e-&gt;AssociatedControl);
<a name="l01956"></a>01956 }
<a name="l01957"></a>01957 
<a name="l01958"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a795128e5b9de393b750fa0cc9c32c05a">01958</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a795128e5b9de393b750fa0cc9c32c05a">SpinachGUI::MainForm::OnMouseWheel</a>(System::Object^  sender, System::Windows::Forms::MouseEventArgs^  e)
<a name="l01959"></a>01959 {
<a name="l01960"></a>01960         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a9458a706c34bb3e65cddc4a9c6e3a6f6" title="Flag used for context menu showing.">focused</a>) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa4e3269ebac6026328e8ae6d7a78a187" title="For handling the wheel rotation of the mouse and used for zooming of the model.">OnMouseWheel</a>(sender,e);
<a name="l01961"></a>01961 }
<a name="l01962"></a>01962 <span class="comment"></span>
<a name="l01963"></a>01963 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l01964"></a>01964 <span class="comment"></span><span class="comment">//Panel Paint interactions</span>
<a name="l01965"></a>01965 
<a name="l01966"></a>01966 
<a name="l01967"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8d05dbcaaf82ad6429cdb24f9d800902">01967</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8d05dbcaaf82ad6429cdb24f9d800902">SpinachGUI::MainForm::Panel_Paint_Gradient</a>(System::Object^  sender, System::Windows::Forms::PaintEventArgs^  pe)
<a name="l01968"></a>01968 {
<a name="l01969"></a>01969         Graphics^ g = pe-&gt;Graphics;
<a name="l01970"></a>01970         System::Drawing::Rectangle myRectangle = ((Panel^)sender)-&gt;ClientRectangle;
<a name="l01971"></a>01971         <span class="keywordtype">int</span> enabledcolor=130;
<a name="l01972"></a>01972 
<a name="l01973"></a>01973 
<a name="l01974"></a>01974                 
<a name="l01975"></a>01975 
<a name="l01976"></a>01976 <span class="comment">/*</span>
<a name="l01977"></a>01977 <span class="comment"></span>
<a name="l01978"></a>01978 <span class="comment">                System::Drawing::Drawing2D::LinearGradientBrush^ myLinearGradientBrush = </span>
<a name="l01979"></a>01979 <span class="comment">                        gcnew System::Drawing::Drawing2D::LinearGradientBrush( myRectangle, acolor, bcolor,  </span>
<a name="l01980"></a>01980 <span class="comment">                        System::Drawing::Drawing2D::LinearGradientMode::Horizontal);</span>
<a name="l01981"></a>01981 <span class="comment"></span>
<a name="l01982"></a>01982 <span class="comment">                g-&gt;FillRectangle(myLinearGradientBrush, myRectangle);</span>
<a name="l01983"></a>01983 <span class="comment"></span>
<a name="l01984"></a>01984 <span class="comment"></span>
<a name="l01985"></a>01985 <span class="comment">                System::Drawing::Drawing2D::HatchBrush^ myHatchBrush = </span>
<a name="l01986"></a>01986 <span class="comment">                        gcnew System::Drawing::Drawing2D::HatchBrush(System::Drawing::Drawing2D::HatchStyle::WideUpwardDiagonal,</span>
<a name="l01987"></a>01987 <span class="comment">                        Color::Gray, Color::Transparent);</span>
<a name="l01988"></a>01988 <span class="comment"></span>
<a name="l01989"></a>01989 <span class="comment">                g-&gt;FillRectangle(myHatchBrush, myRectangle);</span>
<a name="l01990"></a>01990 <span class="comment">                */</span>
<a name="l01991"></a>01991         
<a name="l01992"></a>01992                 Color acolor=Color::FromArgb(
<a name="l01993"></a>01993                 (<span class="keywordtype">int</span>)(Convert::ToDouble((Double ^)((ArrayList ^)((Panel^)sender)-&gt;Tag)[0])*
<a name="l01994"></a>01994                                        (((Panel^)sender)-&gt;Enabled?170:130))+(((Panel^)sender)-&gt;Enabled?85:125),
<a name="l01995"></a>01995                 (<span class="keywordtype">int</span>)(Convert::ToDouble((Double ^)((ArrayList ^)((Panel^)sender)-&gt;Tag)[1])*
<a name="l01996"></a>01996                                        (((Panel^)sender)-&gt;Enabled?170:130))+(((Panel^)sender)-&gt;Enabled?85:125),
<a name="l01997"></a>01997                 (<span class="keywordtype">int</span>)(Convert::ToDouble((Double ^)((ArrayList ^)((Panel^)sender)-&gt;Tag)[2])*
<a name="l01998"></a>01998                                        (((Panel^)sender)-&gt;Enabled?170:130))+(((Panel^)sender)-&gt;Enabled?85:125));
<a name="l01999"></a>01999 
<a name="l02000"></a>02000         Color bcolor=Color::FromArgb(
<a name="l02001"></a>02001                 (<span class="keywordtype">int</span>)(Convert::ToDouble((Double ^)((ArrayList ^)((Panel^)sender)-&gt;Tag)[3])*
<a name="l02002"></a>02002                                        (((Panel^)sender)-&gt;Enabled?170:130))+(((Panel^)sender)-&gt;Enabled?85:125),
<a name="l02003"></a>02003                 (<span class="keywordtype">int</span>)(Convert::ToDouble((Double ^)((ArrayList ^)((Panel^)sender)-&gt;Tag)[4])*
<a name="l02004"></a>02004                                        (((Panel^)sender)-&gt;Enabled?170:130))+(((Panel^)sender)-&gt;Enabled?85:125),
<a name="l02005"></a>02005                 (<span class="keywordtype">int</span>)(Convert::ToDouble((Double ^)((ArrayList ^)((Panel^)sender)-&gt;Tag)[5])*
<a name="l02006"></a>02006                                        (((Panel^)sender)-&gt;Enabled?170:130))+(((Panel^)sender)-&gt;Enabled?85:125));
<a name="l02007"></a>02007 
<a name="l02008"></a>02008                         System::Drawing::Drawing2D::LinearGradientBrush^ myLinearGradientBrush = 
<a name="l02009"></a>02009                         <span class="keyword">gcnew</span> System::Drawing::Drawing2D::LinearGradientBrush( myRectangle, acolor, bcolor,  
<a name="l02010"></a>02010                         System::Drawing::Drawing2D::LinearGradientMode::Horizontal);
<a name="l02011"></a>02011 
<a name="l02012"></a>02012                 g-&gt;FillRectangle(myLinearGradientBrush, myRectangle);
<a name="l02013"></a>02013 
<a name="l02014"></a>02014         <span class="comment">//if(JCpanel)JCColorlabel-&gt;ForeColor=Color::LightGray; else JCColorlabel-&gt;ForeColor=Color::Black;</span>
<a name="l02015"></a>02015                 <span class="comment">//if(ECpanel)ECColorlabel-&gt;ForeColor=Color::LightGray; else ECColorlabel-&gt;ForeColor=Color::Black;</span>
<a name="l02016"></a>02016 }
<a name="l02017"></a>02017 
<a name="l02018"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afba47ca21da6662f9710a6fade444faf">02018</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afba47ca21da6662f9710a6fade444faf">SpinachGUI::MainForm::Update_OpenGL_Color</a>(String^ text, Color^ acolor, <span class="keywordtype">bool</span> left)
<a name="l02019"></a>02019    {
<a name="l02020"></a>02020 
<a name="l02021"></a>02021         <span class="comment">//Color</span>
<a name="l02022"></a>02022         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;CHEMICAL SHIFT&quot;</span>))
<a name="l02023"></a>02023         {
<a name="l02024"></a>02024         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d9b97f6a464282954c7a4d858abb2b7">CScolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02025"></a>02025         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d9b97f6a464282954c7a4d858abb2b7">CScolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02026"></a>02026         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d9b97f6a464282954c7a4d858abb2b7">CScolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02027"></a>02027         }
<a name="l02028"></a>02028 
<a name="l02029"></a>02029         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;BOND&quot;</span>))
<a name="l02030"></a>02030         {
<a name="l02031"></a>02031         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a80217ae357b897a5bae6d1821bb68f56">CBcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02032"></a>02032         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a80217ae357b897a5bae6d1821bb68f56">CBcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02033"></a>02033         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a80217ae357b897a5bae6d1821bb68f56">CBcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02034"></a>02034         }
<a name="l02035"></a>02035 
<a name="l02036"></a>02036         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;J-COUPLING&quot;</span>))
<a name="l02037"></a>02037         {
<a name="l02038"></a>02038                 <span class="keywordflow">if</span>(left)
<a name="l02039"></a>02039                 {
<a name="l02040"></a>02040                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02041"></a>02041                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02042"></a>02042                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02043"></a>02043                 }
<a name="l02044"></a>02044                 <span class="keywordflow">else</span>
<a name="l02045"></a>02045                 {
<a name="l02046"></a>02046                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>[3]=acolor-&gt;R/255.0f;
<a name="l02047"></a>02047                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>[4]=acolor-&gt;G/255.0f;
<a name="l02048"></a>02048                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>[5]=acolor-&gt;B/255.0f;
<a name="l02049"></a>02049                 }
<a name="l02050"></a>02050         }
<a name="l02051"></a>02051 
<a name="l02052"></a>02052                 <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;EXCHANGE&quot;</span>))
<a name="l02053"></a>02053         {
<a name="l02054"></a>02054                 <span class="keywordflow">if</span>(left)
<a name="l02055"></a>02055                 {
<a name="l02056"></a>02056                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02057"></a>02057                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02058"></a>02058                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02059"></a>02059                 }
<a name="l02060"></a>02060                 <span class="keywordflow">else</span>
<a name="l02061"></a>02061                 {
<a name="l02062"></a>02062                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>[3]=acolor-&gt;R/255.0f;
<a name="l02063"></a>02063                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>[4]=acolor-&gt;G/255.0f;
<a name="l02064"></a>02064                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>[5]=acolor-&gt;B/255.0f;
<a name="l02065"></a>02065                 }
<a name="l02066"></a>02066         }
<a name="l02067"></a>02067         
<a name="l02068"></a>02068         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;HYPERFINE&quot;</span>))
<a name="l02069"></a>02069         {
<a name="l02070"></a>02070         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a17fb59ac4d6ef32a53d0fecf2e7dc6cc">HCcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02071"></a>02071         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a17fb59ac4d6ef32a53d0fecf2e7dc6cc">HCcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02072"></a>02072         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a17fb59ac4d6ef32a53d0fecf2e7dc6cc">HCcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02073"></a>02073         }
<a name="l02074"></a>02074 
<a name="l02075"></a>02075         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;QUADRUPOLAR&quot;</span>))
<a name="l02076"></a>02076         {
<a name="l02077"></a>02077         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a2dbe60a3b6d57cbfa1b939b45a41870a">QCcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02078"></a>02078         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a2dbe60a3b6d57cbfa1b939b45a41870a">QCcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02079"></a>02079         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a2dbe60a3b6d57cbfa1b939b45a41870a">QCcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02080"></a>02080         }
<a name="l02081"></a>02081 
<a name="l02082"></a>02082         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;G-TENSOR&quot;</span>))
<a name="l02083"></a>02083         {
<a name="l02084"></a>02084         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af51a221898a9ac610830c56110ededfd">GTcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02085"></a>02085         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af51a221898a9ac610830c56110ededfd">GTcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02086"></a>02086         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af51a221898a9ac610830c56110ededfd">GTcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02087"></a>02087         }
<a name="l02088"></a>02088 
<a name="l02089"></a>02089         <span class="keywordflow">if</span>(text-&gt;Contains(<span class="stringliteral">&quot;ZERO-FIELD&quot;</span>))
<a name="l02090"></a>02090         {
<a name="l02091"></a>02091         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a00dd073770344c298e61f4bc233346f0" title="RGB Matrices for the color of interaction kind.">ZFcolor</a>[0]=acolor-&gt;R/255.0f;
<a name="l02092"></a>02092         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a00dd073770344c298e61f4bc233346f0" title="RGB Matrices for the color of interaction kind.">ZFcolor</a>[1]=acolor-&gt;G/255.0f;
<a name="l02093"></a>02093         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a00dd073770344c298e61f4bc233346f0" title="RGB Matrices for the color of interaction kind.">ZFcolor</a>[2]=acolor-&gt;B/255.0f;
<a name="l02094"></a>02094         }
<a name="l02095"></a>02095 
<a name="l02096"></a>02096         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a8beed90e57a4475297c26db8bc77d8eb">UpdateType::ELLIPSOIDS</a>);
<a name="l02097"></a>02097         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2a0e25d788d277d642072209cdb5bc3d91">UpdateType::BONDS_LIKE</a>);
<a name="l02098"></a>02098 
<a name="l02099"></a>02099 
<a name="l02100"></a>02100    }
<a name="l02101"></a>02101 
<a name="l02102"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2448c0f9e67dd5765379e1d475586eee">02102</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2448c0f9e67dd5765379e1d475586eee">SpinachGUI::MainForm::Update_Interactions_Color</a>()
<a name="l02103"></a>02103    {
<a name="l02104"></a>02104         Color acolor;
<a name="l02105"></a>02105 
<a name="l02106"></a>02106         <span class="comment">//HFC color</span>
<a name="l02107"></a>02107         acolor=Color::FromArgb( (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a17fb59ac4d6ef32a53d0fecf2e7dc6cc">HCcolor</a>[0]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled?85:125),
<a name="l02108"></a>02108                                                                   (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a17fb59ac4d6ef32a53d0fecf2e7dc6cc">HCcolor</a>[1]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled?85:125),
<a name="l02109"></a>02109                                                                   (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a17fb59ac4d6ef32a53d0fecf2e7dc6cc">HCcolor</a>[2]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled?85:125));
<a name="l02110"></a>02110 
<a name="l02111"></a>02111         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a55de30ee76d9a418dfe461faf660d13c">HFCColorlabel</a>-&gt;BackColor=acolor;
<a name="l02112"></a>02112         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#addb8c546e1158655645dbccd4020015a">HFCtrackBar</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#addb8c546e1158655645dbccd4020015a">HFCtrackBar</a>-&gt;BorderColor=acolor;
<a name="l02113"></a>02113         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a55de30ee76d9a418dfe461faf660d13c">HFCColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02114"></a>02114 
<a name="l02115"></a>02115         <span class="comment">//CS Color</span>
<a name="l02116"></a>02116         acolor=Color::FromArgb( (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d9b97f6a464282954c7a4d858abb2b7">CScolor</a>[0]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled?85:125),
<a name="l02117"></a>02117                                                     (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d9b97f6a464282954c7a4d858abb2b7">CScolor</a>[1]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled?85:125),
<a name="l02118"></a>02118                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d9b97f6a464282954c7a4d858abb2b7">CScolor</a>[2]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled?85:125));
<a name="l02119"></a>02119 
<a name="l02120"></a>02120         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9b60adcb93cae2a36f0af4934e6c9a9f">CSColorlabel</a>-&gt;BackColor=acolor;
<a name="l02121"></a>02121         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaa93a5c90977dc9e56e1e49bbcdfe451">CStrackBar</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaa93a5c90977dc9e56e1e49bbcdfe451">CStrackBar</a>-&gt;BorderColor=acolor;
<a name="l02122"></a>02122         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9b60adcb93cae2a36f0af4934e6c9a9f">CSColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02123"></a>02123 
<a name="l02124"></a>02124         <span class="comment">//CBond Color</span>
<a name="l02125"></a>02125         acolor=Color::FromArgb( (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a80217ae357b897a5bae6d1821bb68f56">CBcolor</a>[0]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled?85:125),
<a name="l02126"></a>02126                                                     (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a80217ae357b897a5bae6d1821bb68f56">CBcolor</a>[1]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled?85:125),
<a name="l02127"></a>02127                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a80217ae357b897a5bae6d1821bb68f56">CBcolor</a>[2]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled?85:125));
<a name="l02128"></a>02128 
<a name="l02129"></a>02129         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a63407fe8fc2579c5b6661e9f6d3116a3">BondColorlabel</a>-&gt;BackColor=acolor;
<a name="l02130"></a>02130         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac9d283e6bcc31cec8ecbd155f0391e49">BondtrackBar</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac9d283e6bcc31cec8ecbd155f0391e49">BondtrackBar</a>-&gt;BorderColor=acolor;
<a name="l02131"></a>02131         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a63407fe8fc2579c5b6661e9f6d3116a3">BondColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02132"></a>02132         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a51c642c2d16f0e36208792f73bc982d9">BondtrackBar_Scroll</a>(<span class="keyword">gcnew</span> System::Object(), <span class="keyword">gcnew</span> System::EventArgs()); 
<a name="l02133"></a>02133         
<a name="l02134"></a>02134         <span class="comment">//JC Color      </span>
<a name="l02135"></a>02135         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4ccf7c09029252c739533c23c1ca1645">JCColorlabel</a>-&gt;Tag=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#add74d88a91222980bfbcaa6904936c9c">ConColor</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>);<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5736e64a793ab51dc821b1814116ead1">JCpanel</a>-&gt;Tag=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#add74d88a91222980bfbcaa6904936c9c">ConColor</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a068b18861200cc701d3ad19e0424ee59" title="RGB Matrices for the color of interaction kind.">JCcolor</a>);
<a name="l02136"></a>02136         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4ccf7c09029252c739533c23c1ca1645">JCColorlabel</a>-&gt;BackColor=Color::FromArgb(1,1,1,1);
<a name="l02137"></a>02137         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5736e64a793ab51dc821b1814116ead1">JCpanel</a>-&gt;Enabled) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4ccf7c09029252c739533c23c1ca1645">JCColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02138"></a>02138         <span class="keywordflow">else</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4ccf7c09029252c739533c23c1ca1645">JCColorlabel</a>-&gt;ForeColor=Color::Black;
<a name="l02139"></a>02139         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a963a27daee78044c8810be3556d9add1">JCtrackBar_Scroll</a>(<span class="keyword">gcnew</span> System::Object(), <span class="keyword">gcnew</span> System::EventArgs()); 
<a name="l02140"></a>02140 
<a name="l02141"></a>02141         <span class="comment">//EC Color</span>
<a name="l02142"></a>02142         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a77bd6ecdf85e95071216791e54abe">ECColorlabel</a>-&gt;Tag=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#add74d88a91222980bfbcaa6904936c9c">ConColor</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>); <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac056f30d63143b81babdee675cf13bbc">ECpanel</a>-&gt;Tag=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#add74d88a91222980bfbcaa6904936c9c">ConColor</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae225fe838d6e93271a0f14604d0f74c5">ECcolor</a>);
<a name="l02143"></a>02143         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a77bd6ecdf85e95071216791e54abe">ECColorlabel</a>-&gt;BackColor=Color::FromArgb(1,1,1,1);
<a name="l02144"></a>02144         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac056f30d63143b81babdee675cf13bbc">ECpanel</a>-&gt;Enabled) <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a77bd6ecdf85e95071216791e54abe">ECColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02145"></a>02145         <span class="keywordflow">else</span> <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a10a77bd6ecdf85e95071216791e54abe">ECColorlabel</a>-&gt;ForeColor=Color::Black;
<a name="l02146"></a>02146         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2ab7c7d670ef95b717faa71e0b449538">ECtrackBar_Scroll</a>(<span class="keyword">gcnew</span> System::Object(), <span class="keyword">gcnew</span> System::EventArgs()); 
<a name="l02147"></a>02147 
<a name="l02148"></a>02148         <span class="comment">//QC Color</span>
<a name="l02149"></a>02149         acolor=Color::FromArgb( (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a2dbe60a3b6d57cbfa1b939b45a41870a">QCcolor</a>[0]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled?85:125),
<a name="l02150"></a>02150                                                     (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a2dbe60a3b6d57cbfa1b939b45a41870a">QCcolor</a>[1]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled?85:125),
<a name="l02151"></a>02151                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a2dbe60a3b6d57cbfa1b939b45a41870a">QCcolor</a>[2]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled?85:125));
<a name="l02152"></a>02152 
<a name="l02153"></a>02153         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac1fa2505e066b66d37a241a63a991ebe">QCColorlabel</a>-&gt;BackColor=acolor;
<a name="l02154"></a>02154         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a601149241a089b20bbba154ff320d5c7">QCtrackBar</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a601149241a089b20bbba154ff320d5c7">QCtrackBar</a>-&gt;BorderColor=acolor;
<a name="l02155"></a>02155         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac1fa2505e066b66d37a241a63a991ebe">QCColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02156"></a>02156 
<a name="l02157"></a>02157         <span class="comment">//GT Color</span>
<a name="l02158"></a>02158         acolor=Color::FromArgb( (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af51a221898a9ac610830c56110ededfd">GTcolor</a>[0]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled?85:125),
<a name="l02159"></a>02159                                                     (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af51a221898a9ac610830c56110ededfd">GTcolor</a>[1]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled?85:125),
<a name="l02160"></a>02160                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af51a221898a9ac610830c56110ededfd">GTcolor</a>[2]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled?85:125));
<a name="l02161"></a>02161 
<a name="l02162"></a>02162         
<a name="l02163"></a>02163         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1ebf31b916f8057f381dd1ede02264cd">GTColorlabel</a>-&gt;BackColor=acolor;
<a name="l02164"></a>02164         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a622b73087a36479909ca8cd42e920764">GTtrackBar</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a622b73087a36479909ca8cd42e920764">GTtrackBar</a>-&gt;BorderColor=acolor;
<a name="l02165"></a>02165         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1ebf31b916f8057f381dd1ede02264cd">GTColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02166"></a>02166 
<a name="l02167"></a>02167         <span class="comment">//ZF Color</span>
<a name="l02168"></a>02168         acolor=Color::FromArgb( (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a00dd073770344c298e61f4bc233346f0" title="RGB Matrices for the color of interaction kind.">ZFcolor</a>[0]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled?85:125),
<a name="l02169"></a>02169                                                     (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a00dd073770344c298e61f4bc233346f0" title="RGB Matrices for the color of interaction kind.">ZFcolor</a>[1]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled?85:125),
<a name="l02170"></a>02170                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a00dd073770344c298e61f4bc233346f0" title="RGB Matrices for the color of interaction kind.">ZFcolor</a>[2]*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled?170:130))+(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled?85:125));
<a name="l02171"></a>02171 
<a name="l02172"></a>02172         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8b3d57e478252cea9c573db00b96b8bb">ZFColorlabel</a>-&gt;BackColor=acolor;
<a name="l02173"></a>02173         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a571a1d88b54e5e32a1d1efe1aee152d5">ZFtrackBar</a>-&gt;BackColor=acolor;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a571a1d88b54e5e32a1d1efe1aee152d5">ZFtrackBar</a>-&gt;BorderColor=acolor;
<a name="l02174"></a>02174         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8b3d57e478252cea9c573db00b96b8bb">ZFColorlabel</a>-&gt;ForeColor=Color::LightGray;
<a name="l02175"></a>02175 
<a name="l02176"></a>02176    }
<a name="l02177"></a>02177 
<a name="l02178"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a79753a877b960d5f2e2e17736f2aff44">02178</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a79753a877b960d5f2e2e17736f2aff44">SpinachGUI::MainForm::trackBar_EnabledChanged</a>(System::Object^  sender, System::EventArgs^  e) 
<a name="l02179"></a>02179 {
<a name="l02180"></a>02180         <span class="keywordflow">if</span>(((gTrackBar::gTrackBar^)sender)-&gt;Enabled)
<a name="l02181"></a>02181         {
<a name="l02182"></a>02182                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorHigh-&gt;ColorA=System::Drawing::Color::LightGray;
<a name="l02183"></a>02183                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorHigh-&gt;ColorB=System::Drawing::Color::LightGray;
<a name="l02184"></a>02184                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorLow-&gt;ColorA=System::Drawing::Color::LightGray;
<a name="l02185"></a>02185                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorLow-&gt;ColorB=System::Drawing::Color::LightGray;
<a name="l02186"></a>02186                 ((gTrackBar::gTrackBar^)sender)-&gt;TickColor=System::Drawing::Color::LightGray;
<a name="l02187"></a>02187         }
<a name="l02188"></a>02188         <span class="keywordflow">else</span>
<a name="l02189"></a>02189         {
<a name="l02190"></a>02190                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorHigh-&gt;ColorA=System::Drawing::Color::DarkGray;
<a name="l02191"></a>02191                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorHigh-&gt;ColorB=System::Drawing::Color::DarkGray;
<a name="l02192"></a>02192                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorLow-&gt;ColorA=System::Drawing::Color::DarkGray;
<a name="l02193"></a>02193                 ((gTrackBar::gTrackBar^)sender)-&gt;SliderColorLow-&gt;ColorB=System::Drawing::Color::DarkGray;
<a name="l02194"></a>02194                 ((gTrackBar::gTrackBar^)sender)-&gt;TickColor=System::Drawing::Color::DarkGray;
<a name="l02195"></a>02195         }
<a name="l02196"></a>02196 
<a name="l02197"></a>02197 }
<a name="l02198"></a>02198 
<a name="l02199"></a>02199 
<a name="l02200"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#add74d88a91222980bfbcaa6904936c9c">02200</a> ArrayList^ <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#add74d88a91222980bfbcaa6904936c9c">SpinachGUI::MainForm::ConColor</a>(<span class="keywordtype">double</span>* matrix)
<a name="l02201"></a>02201 {
<a name="l02202"></a>02202         ArrayList ^ result=<span class="keyword">gcnew</span> ArrayList();
<a name="l02203"></a>02203         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;6;i++) { result-&gt;Add(matrix[i]);}
<a name="l02204"></a>02204         <span class="keywordflow">return</span> result;
<a name="l02205"></a>02205 
<a name="l02206"></a>02206 }
<a name="l02207"></a>02207 
<a name="l02208"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac5478d4213eaa78e3a725b45868c809d">02208</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac5478d4213eaa78e3a725b45868c809d">SpinachGUI::MainForm::Reset</a>()
<a name="l02209"></a>02209 {
<a name="l02210"></a>02210         <span class="comment">//trackbars</span>
<a name="l02211"></a>02211         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac9d283e6bcc31cec8ecbd155f0391e49">BondtrackBar</a>-&gt;Value=50;
<a name="l02212"></a>02212         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5fae1983e82c36bcd4ae88e378b62785">JCtrackBar</a>-&gt;Value=50;
<a name="l02213"></a>02213         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0989f0d7b98a3eae2465130be263be68">ECtrackBar</a>-&gt;Value=50;
<a name="l02214"></a>02214         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaa93a5c90977dc9e56e1e49bbcdfe451">CStrackBar</a>-&gt;Value=0;
<a name="l02215"></a>02215         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a622b73087a36479909ca8cd42e920764">GTtrackBar</a>-&gt;Value=0;
<a name="l02216"></a>02216         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a571a1d88b54e5e32a1d1efe1aee152d5">ZFtrackBar</a>-&gt;Value=0;
<a name="l02217"></a>02217         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a601149241a089b20bbba154ff320d5c7">QCtrackBar</a>-&gt;Value=0;
<a name="l02218"></a>02218         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#addb8c546e1158655645dbccd4020015a">HFCtrackBar</a>-&gt;Value=0;
<a name="l02219"></a>02219 
<a name="l02220"></a>02220         <span class="comment">//trackbar checkbox</span>
<a name="l02221"></a>02221         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af4116eef511ad2685f036f364cff5bd5">BondcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7fd00e0dce38f247c53b463fb332a364" title="Flags for showing kind of interactions.">CBFlag</a>;
<a name="l02222"></a>02222         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a366e32c9b1a8125cd4008b0803fa6b94">CScheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afa59a811285e41674e9f16ea7b6f77ba">CSFlag</a>;
<a name="l02223"></a>02223         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0609315e900c1b1bc111a03ed92677eb">HFCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a228adfdf34ef201300550f0f5467e446">HCFlag</a>;
<a name="l02224"></a>02224         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab896447cd940754e5b859a7941a09ac2">GTcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a13624261209264386df1cde404b1ed6e">GTFlag</a>;
<a name="l02225"></a>02225         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1b990cb1428e1f146caf86e7c6fd40f6">JCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a38fcd62b067631ddbf9a246de902a60d">JCFlag</a>;
<a name="l02226"></a>02226         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ae0fd7cae00dbc835b06db8ecd9396406">QCcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa548f39ed75164d87e04034e809ec70e">QCFlag</a>;
<a name="l02227"></a>02227         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1d748386440db28357f41756507ae5db">ECcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aa88a55e4dc4b4150121add8c84bda00d">ECFlag</a>;
<a name="l02228"></a>02228         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aedbf20e75a01075edf5a897e3a4b2cb5">ZFcheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a5d940879e95fc2974a27fb24d55bce89" title="Flags for showing kind of interactions.">ZFFlag</a>;
<a name="l02229"></a>02229         
<a name="l02230"></a>02230         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4b5718cbc6975ce96c5363c7eda717a1">checkBoxAxes</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a735447373bdfe5ed0fda746aaeaa5f72" title="Flag for showing navigation axes.">AxesFlag</a>;
<a name="l02231"></a>02231         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a272045c2348019eae8a3d7e2d3b15896">checkBoxAtomID</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#aea9bc7ab4d1f1cb9f91b2fa4fd9d7d28" title="Flag for showing ID of all atoms.">AtomIDFlag</a>;
<a name="l02232"></a>02232         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0004f7672716b865c4b0c18704497e3e">EigenAxescheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af7ffeb4b7690dfecb95daab57165b9c0" title="Flag for showing interaction axes.">EigenAxesFlag</a>;
<a name="l02233"></a>02233         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a36766accf409b06e050cb976986a8658">EigenEllipsoidscheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac4a2747b4541ead35bf992447bedeec9" title="Flag for showing interaction ellipsoids.">EigenEllipsoidsFlag</a>;
<a name="l02234"></a>02234         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2098dc9803048608dfaa073d6f816084">SelectedInteractionscheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a0f9cb0f634625db9ac37118d7314a044" title="Flag for showing the interaction of the selected atom.">SelectedAtomsInteractionsFlag</a>;
<a name="l02235"></a>02235         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a86e15ecfc298deeed80d70c2c29f222d">Stereobutton</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ab7c488998482ef56d60f94fbddbd0879" title="Flag for stero viewing.">stereoview</a>;
<a name="l02236"></a>02236         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad49d29faefc444c990205f1dead0811e">ReferencecheckBox</a>-&gt;Checked=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a44b9634d3a01e26c244d965f1eb9a0f1" title="Flag for showing current reference frame axis of interaction.">ReferenceFrameAxesFlag</a>;
<a name="l02237"></a>02237         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a4e75ba1060dc9ac8dd359437f5ddbaff">BackGroundColorLabel</a>-&gt;BackColor=Color::FromArgb((<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a59338162d14cc3c1179d6c90290ce450" title="RGB Matrix for the color.">BackgroundColor</a>[0]*255),
<a name="l02238"></a>02238                                                                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a59338162d14cc3c1179d6c90290ce450" title="RGB Matrix for the color.">BackgroundColor</a>[1]*255),
<a name="l02239"></a>02239                                                                                                         (<span class="keywordtype">int</span>)(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a59338162d14cc3c1179d6c90290ce450" title="RGB Matrix for the color.">BackgroundColor</a>[2]*255));
<a name="l02240"></a>02240 
<a name="l02241"></a>02241         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">CheckExistentInteractions</a>(<span class="keyword">false</span>);
<a name="l02242"></a>02242 
<a name="l02243"></a>02243 }
<a name="l02244"></a>02244 
<a name="l02245"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">02245</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">SpinachGUI::MainForm::CheckExistentInteractions</a>(<span class="keywordtype">bool</span> trackbarsReposition)
<a name="l02246"></a>02246 {
<a name="l02247"></a>02247                 <span class="keywordtype">double</span> validminCB=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[InteractionKind::CBond]&gt; <a class="code" href="_open_g_l_8cpp.html#af637d148c7b4f533fe2b0ab4705ceb46">epsilo</a> &amp;&amp; 
<a name="l02248"></a>02248                               <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[InteractionKind::CBond]&lt; <a class="code" href="_model_8h.html#a31749279d75cb3f5abada2931fffaf31">dMax</a> ? 
<a name="l02249"></a>02249                                           <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[InteractionKind::CBond]: 1.0f;
<a name="l02250"></a>02250 
<a name="l02251"></a>02251         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6bdc5ba2ad3a4408ea16474fc61720c3">Bondpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::CBond]&gt;0;
<a name="l02252"></a>02252         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a1159be3cf03806bd013a649f68e03b39">CSpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::Shift]&gt;0;
<a name="l02253"></a>02253         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5736e64a793ab51dc821b1814116ead1">JCpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::Jcoupling]&gt;0;
<a name="l02254"></a>02254         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac056f30d63143b81babdee675cf13bbc">ECpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::Exchange]&gt;0;
<a name="l02255"></a>02255         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0470cd2ba7935efea93b2d7a96ca744f">ZFpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::ZFS]&gt;0;
<a name="l02256"></a>02256         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a8ceb652e048db43db87892a94779a2e0">HFCpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::HFC]&gt;0;
<a name="l02257"></a>02257         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5ed16c83e85f1e0817aed71a12a93a9c">GTpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::GTensor]&gt;0; 
<a name="l02258"></a>02258     <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#afaefcf2e0e4362d187082b6f8fb83e29">QCpanel</a>-&gt;Enabled=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::Quadrupolar]&gt;0;
<a name="l02259"></a>02259 
<a name="l02260"></a>02260         <span class="keywordflow">if</span>(trackbarsReposition)
<a name="l02261"></a>02261         {
<a name="l02262"></a>02262         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>=<span class="keyword">false</span>;
<a name="l02263"></a>02263         <span class="keywordtype">double</span> temp;
<a name="l02264"></a>02264    <span class="comment">//Chemical shift factor</span>
<a name="l02265"></a>02265         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eae4a1b28ecfe89d0bac93fee76b23ba68">InteractionKind::Shift</a>]&gt;0)
<a name="l02266"></a>02266         {
<a name="l02267"></a>02267                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a04e6a63da35e196269c38126042a18d0">CSfinfactor</a>*(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eae4a1b28ecfe89d0bac93fee76b23ba68">InteractionKind::Shift</a>])&gt;
<a name="l02268"></a>02268                         <a class="code" href="_open_g_l_8cpp.html#af637d148c7b4f533fe2b0ab4705ceb46">epsilo</a> ?
<a name="l02269"></a>02269                         (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[InteractionKind::Shift]) 
<a name="l02270"></a>02270                         : 1.0f)/validminCB;
<a name="l02271"></a>02271 
<a name="l02272"></a>02272                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#aaa93a5c90977dc9e56e1e49bbcdfe451">CStrackBar</a>-&gt;Value=(int)(10*Math::Log10(temp));
<a name="l02273"></a>02273                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a655fb8e18d522e43daec2256cfee5937">CSfactor</a>=temp;
<a name="l02274"></a>02274         }
<a name="l02275"></a>02275 
<a name="l02276"></a>02276         <span class="comment">//Hyperfine factor</span>
<a name="l02277"></a>02277         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eaa963e6070e2708404c83781a60a9e823">InteractionKind::HFC</a>]&gt;0)
<a name="l02278"></a>02278         {
<a name="l02279"></a>02279                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a0047160e57ccebb2b04b12babd6ed4ef">HCfinfactor</a>*(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eaa963e6070e2708404c83781a60a9e823">InteractionKind::HFC</a>])&gt;
<a name="l02280"></a>02280                         <a class="code" href="_open_g_l_8cpp.html#af637d148c7b4f533fe2b0ab4705ceb46">epsilo</a> ?
<a name="l02281"></a>02281                         (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[InteractionKind::HFC]) 
<a name="l02282"></a>02282                         : 1.0f)/validminCB;
<a name="l02283"></a>02283 
<a name="l02284"></a>02284                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#addb8c546e1158655645dbccd4020015a">HFCtrackBar</a>-&gt;Value=(int)(10.0f*Math::Log10(temp));
<a name="l02285"></a>02285                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#afe34ce939edd9ed01b8df562629ab40b">HCfactor</a>=temp;
<a name="l02286"></a>02286         }
<a name="l02287"></a>02287 
<a name="l02288"></a>02288         <span class="comment">//Quadrupolar factor</span>
<a name="l02289"></a>02289         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eac17339440287fe2fd6774ac931c67eb7">InteractionKind::Quadrupolar</a>]&gt;0)
<a name="l02290"></a>02290         {
<a name="l02291"></a>02291                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a3a20612ea84b32eec09522c3b6588abe">QCfinfactor</a>*(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eac17339440287fe2fd6774ac931c67eb7">InteractionKind::Quadrupolar</a>])&gt;
<a name="l02292"></a>02292                         <a class="code" href="_open_g_l_8cpp.html#af637d148c7b4f533fe2b0ab4705ceb46">epsilo</a> ?
<a name="l02293"></a>02293                         (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[InteractionKind::Quadrupolar]) 
<a name="l02294"></a>02294                         : 1.0f)/validminCB;
<a name="l02295"></a>02295 
<a name="l02296"></a>02296                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a601149241a089b20bbba154ff320d5c7">QCtrackBar</a>-&gt;Value=(int)(10.0f*Math::Log10(temp));
<a name="l02297"></a>02297                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#af054791eff9432418c16d48cd8453023">QCfactor</a>=temp;
<a name="l02298"></a>02298         }
<a name="l02299"></a>02299 
<a name="l02300"></a>02300         <span class="comment">//Gtensor factor</span>
<a name="l02301"></a>02301         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea002c54e14f8b8cc5a33e76e39d67a6a0">InteractionKind::GTensor</a>]&gt;0)
<a name="l02302"></a>02302         {
<a name="l02303"></a>02303                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a8a1d695004e7cc224820f663e6f726cb">GTfinfactor</a>*(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea002c54e14f8b8cc5a33e76e39d67a6a0">InteractionKind::GTensor</a>])&gt;
<a name="l02304"></a>02304                         <a class="code" href="_open_g_l_8cpp.html#af637d148c7b4f533fe2b0ab4705ceb46">epsilo</a> ?
<a name="l02305"></a>02305                         (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[InteractionKind::GTensor]) 
<a name="l02306"></a>02306                         : 1.0f)/3.0f;
<a name="l02307"></a>02307 
<a name="l02308"></a>02308                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a622b73087a36479909ca8cd42e920764">GTtrackBar</a>-&gt;Value=(int)(10.0f*Math::Log10(temp));
<a name="l02309"></a>02309                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a022a3a713d0801b7427cabca634a3ec3">GTfactor</a>=temp;
<a name="l02310"></a>02310         }
<a name="l02311"></a>02311 
<a name="l02312"></a>02312                 <span class="comment">//ZFS factor</span>
<a name="l02313"></a>02313         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea26da56330c608adf3b3477986a12735f">InteractionKind::ZFS</a>]&gt;0)
<a name="l02314"></a>02314         {
<a name="l02315"></a>02315                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#acbc31c0451fb3299ce01f9b730456d19" title="Final multiplication factor for the size of ellipsoids.">ZFfinfactor</a>*(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea26da56330c608adf3b3477986a12735f">InteractionKind::ZFS</a>])&gt;
<a name="l02316"></a>02316                         <a class="code" href="_open_g_l_8cpp.html#af637d148c7b4f533fe2b0ab4705ceb46">epsilo</a> ?
<a name="l02317"></a>02317                         (<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[InteractionKind::ZFS]) 
<a name="l02318"></a>02318                         : 1.0f)/3.0f;
<a name="l02319"></a>02319 
<a name="l02320"></a>02320            <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a571a1d88b54e5e32a1d1efe1aee152d5">ZFtrackBar</a>-&gt;Value=(int)(10.0f*Math::Log10(temp));
<a name="l02321"></a>02321            <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a1e7566b011cd74b57ad1f52d4dc0b09e" title="Multiplication factor for the size of ellipsoids.">ZFfactor</a>=temp;
<a name="l02322"></a>02322         }
<a name="l02323"></a>02323 
<a name="l02324"></a>02324         <span class="comment">//J-coupling factor</span>
<a name="l02325"></a>02325         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]&gt;0)
<a name="l02326"></a>02326         {
<a name="l02327"></a>02327 
<a name="l02328"></a>02328                 <span class="keywordtype">double</span> absMax=(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>])&lt;
<a name="l02329"></a>02329                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]))*
<a name="l02330"></a>02330                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>])+
<a name="l02331"></a>02331                         (abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>])&gt;
<a name="l02332"></a>02332                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]))*
<a name="l02333"></a>02333                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]);
<a name="l02334"></a>02334 
<a name="l02335"></a>02335                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a6011b3b97869f450965a777171762ae4">JCfinfactor</a>/absMax;
<a name="l02336"></a>02336 
<a name="l02337"></a>02337                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5fae1983e82c36bcd4ae88e378b62785">JCtrackBar</a>-&gt;Value=(int)(100.0f*temp);
<a name="l02338"></a>02338                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a1782f41a5c8ffb35aa6704dfb68d9f21">JCfactor</a>=temp;
<a name="l02339"></a>02339         }
<a name="l02340"></a>02340 
<a name="l02341"></a>02341                 <span class="comment">//Exchange coupling factor</span>
<a name="l02342"></a>02342         <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]&gt;0)
<a name="l02343"></a>02343         {
<a name="l02344"></a>02344 
<a name="l02345"></a>02345                 <span class="keywordtype">double</span> absMax=(abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>])&lt;
<a name="l02346"></a>02346                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]))*
<a name="l02347"></a>02347                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>])+
<a name="l02348"></a>02348                         (abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>])&gt;
<a name="l02349"></a>02349                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#ae98cdbb07e8ef7b937cf038f23dbc466" title="Collection of the minima eigen value of each kind of interactions.">InterKindMin</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]))*
<a name="l02350"></a>02350                         abs(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea89fe455d57ae52cfe608090a0ffe2979">InteractionKind::Exchange</a>]);
<a name="l02351"></a>02351 
<a name="l02352"></a>02352                 temp=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ab48bf5d8d6d434cb7989d0b43a1764c0">ECfinfactor</a>/absMax;
<a name="l02353"></a>02353 
<a name="l02354"></a>02354                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0989f0d7b98a3eae2465130be263be68">ECtrackBar</a>-&gt;Value=(int)(100.0f*temp);
<a name="l02355"></a>02355                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a9c0396e7c649b1fc08390be9d045c20f">ECfactor</a>=temp;
<a name="l02356"></a>02356         }
<a name="l02357"></a>02357 
<a name="l02358"></a>02358         <span class="comment">//Bond factor</span>
<a name="l02359"></a>02359                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea1203807f6d26bc8df1724b77efbcf351">InteractionKind::CBond</a>]&gt;0)
<a name="l02360"></a>02360         {
<a name="l02361"></a>02361                 temp=(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ae47a6e56f51e049425e77348cf087b5a" title="Final multiplication factor for the size of ellipsoids.">CBfinfactor</a>-1.6f)/(2.0*(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a73c31389b3277694ad533d076ed581a7" title="Collection of the maxima eigen value of each kind of interactions.">InterKindMax</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea1203807f6d26bc8df1724b77efbcf351">InteractionKind::CBond</a>]-1.6f))+0.5;
<a name="l02362"></a>02362 
<a name="l02363"></a>02363                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ac9d283e6bcc31cec8ecbd155f0391e49">BondtrackBar</a>-&gt;Value=(int)(100.0f*temp);
<a name="l02364"></a>02364                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a8235a35f4031b6695623c3cfe403f73e" title="Multiplication factor for the size of ellipsoids.">CBfactor</a>=temp;
<a name="l02365"></a>02365         }
<a name="l02366"></a>02366 
<a name="l02367"></a>02367         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad90de006295097d05a51c7e457a5c082">UseTrackBarEventHandler</a>=<span class="keyword">true</span>;
<a name="l02368"></a>02368         }
<a name="l02369"></a>02369 
<a name="l02370"></a>02370         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a2448c0f9e67dd5765379e1d475586eee">Update_Interactions_Color</a>();
<a name="l02371"></a>02371         
<a name="l02372"></a>02372 
<a name="l02373"></a>02373 }
<a name="l02374"></a>02374 
<a name="l02375"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9fa649a1aea26e8f0cd4db116b55e19a">02375</a> <span class="keywordtype">double</span>* <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9fa649a1aea26e8f0cd4db116b55e19a">SpinachGUI::MainForm::RevConColor</a>(ArrayList ^ matrix)
<a name="l02376"></a>02376 {
<a name="l02377"></a>02377         <span class="keywordtype">double</span> * result=<span class="keyword">new</span> <span class="keywordtype">double</span>[matrix-&gt;Count];
<a name="l02378"></a>02378         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;matrix-&gt;Count;i++) { result[i]=Convert::ToDouble((Double ^)matrix[i]);}
<a name="l02379"></a>02379         <span class="keywordflow">return</span> result;
<a name="l02380"></a>02380 
<a name="l02381"></a>02381 }<span class="comment"></span>
<a name="l02382"></a>02382 <span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l02383"></a>02383 <span class="comment"></span><span class="comment">//OpenGL context menu</span>
<a name="l02384"></a>02384 
<a name="l02385"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af12c0fa0af564acbadeda1e98ad1c313">02385</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af12c0fa0af564acbadeda1e98ad1c313">SpinachGUI::MainForm::OpenGLcontextMenu_ItemClicked</a>(System::Object^  sender, System::Windows::Forms::ToolStripItemClickedEventArgs^  e) 
<a name="l02386"></a>02386 {
<a name="l02387"></a>02387         <span class="keywordtype">int</span> k=Convert::ToInt32(e-&gt;ClickedItem-&gt;Tag);
<a name="l02388"></a>02388         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a934d7d9135df6941da32069d78643584">orientationdialog</a>-&gt;<a class="code" href="class_spinach_g_u_i_1_1_orientation_dialog.html#a36c53006a93e73da4674553d1f566038" title="Initialization of orientation dialog.">Initialization</a>(((<a class="code" href="class_tensor.html">Tensor</a>^)<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>[k]), <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>, 
<a name="l02389"></a>02389                                                       <span class="keyword">gcnew</span> <a class="code" href="namespace_spinach_g_u_i.html#a3c716a03fba0b66dac5dd03360e85e38">Check</a>(<span class="keyword">this</span>,&amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#af5b5df6cbd3b9ddc6ac9381a4d8f18d8">SpinachGUI::MainForm:: CheckExistentInteractions</a>));
<a name="l02390"></a>02390         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a934d7d9135df6941da32069d78643584">orientationdialog</a>-&gt;ShowDialog();
<a name="l02391"></a>02391 
<a name="l02392"></a>02392 }
<a name="l02393"></a>02393 
<a name="l02394"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6694a1ec851276bc5b88f1115e065c62">02394</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6694a1ec851276bc5b88f1115e065c62">SpinachGUI::MainForm::OpenGLcontextMenu_Closed</a>(System::Object^  , System::Windows::Forms::ToolStripDropDownClosedEventArgs^  ) 
<a name="l02395"></a>02395 {
<a name="l02396"></a>02396 
<a name="l02397"></a>02397         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a7825b349b38f128d4a98b6b45b95051c" title="Atom to be selected.">ToBeSelectedAtom</a>=-1;
<a name="l02398"></a>02398 }
<a name="l02399"></a>02399 
<a name="l02400"></a>02400 <span class="comment">//Thread for import</span>
<a name="l02401"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3dcbe9bdefeb01c82243d2dd05d5637b">02401</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a3dcbe9bdefeb01c82243d2dd05d5637b">SpinachGUI::MainForm::ImportbackgroundWorker_DoWork</a>(System::Object^  sender, System::ComponentModel::DoWorkEventArgs^  e) 
<a name="l02402"></a>02402 {
<a name="l02403"></a>02403         <span class="comment">//OpenedFile</span>
<a name="l02404"></a>02404         <a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ OpenedFile=(<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )e-&gt;Argument;
<a name="l02405"></a>02405         <span class="keywordflow">try</span>{
<a name="l02406"></a>02406                 e-&gt;Result=(<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ ) e-&gt;Argument;
<a name="l02407"></a>02407                 <span class="keywordflow">if</span>(OpenedFile-&gt;<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html#af03bb15020eeabcc77503568f2bfadc6">LoadFile</a>())  {}<span class="comment">//e-&gt;Result=(IOSpinSystem^ )e-&gt;Argument;</span>
<a name="l02408"></a>02408                 <span class="keywordflow">else</span>
<a name="l02409"></a>02409                 {
<a name="l02410"></a>02410                         ((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Argument))-&gt;ReadingFile-&gt;Close();
<a name="l02411"></a>02411                         e-&gt;Cancel=<span class="keyword">true</span>;
<a name="l02412"></a>02412                         <span class="keywordflow">throw</span> <span class="keyword">gcnew</span> Exception(<span class="stringliteral">&quot;File Format is not &quot;</span>+OpenedFile-&gt;<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html#ac0b9b8564acd4f403ab68762adcf65a2" title="The name of the format.">FormatName</a>+<span class="stringliteral">&quot; format!&quot;</span>);
<a name="l02413"></a>02413                 }
<a name="l02414"></a>02414         }
<a name="l02415"></a>02415         <span class="keywordflow">catch</span>(Exception ^ error)
<a name="l02416"></a>02416         {
<a name="l02417"></a>02417                 ((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Argument))-&gt;ReadingFile-&gt;Close();
<a name="l02418"></a>02418                 <span class="keywordflow">throw</span> <span class="keyword">gcnew</span> Exception(error-&gt;Message);
<a name="l02419"></a>02419         }
<a name="l02420"></a>02420         <span class="keywordflow">catch</span>(String ^ error)
<a name="l02421"></a>02421         {
<a name="l02422"></a>02422                 ((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Argument))-&gt;ReadingFile-&gt;Close();
<a name="l02423"></a>02423                 <span class="keywordflow">throw</span> <span class="keyword">gcnew</span> Exception(error);
<a name="l02424"></a>02424         }
<a name="l02425"></a>02425 
<a name="l02426"></a>02426 
<a name="l02427"></a>02427 }
<a name="l02428"></a>02428 
<a name="l02429"></a><a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7e7d7acb3bd3965aea44a4fb2c29c4dc">02429</a> System::Void <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a7e7d7acb3bd3965aea44a4fb2c29c4dc">SpinachGUI::MainForm::ImportbackgroundWorker_RunWorkerCompleted</a>(System::Object^  sender, System::ComponentModel::RunWorkerCompletedEventArgs^  e) 
<a name="l02430"></a>02430 {
<a name="l02431"></a>02431         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9604c2f105f571246c561c539881d4fc">GenprogressBar</a>-&gt;Visible=<span class="keyword">false</span>;
<a name="l02432"></a>02432         this-&gt;Enabled=<span class="keyword">true</span>;
<a name="l02433"></a>02433         <span class="keywordflow">if</span>(e-&gt;Error != <span class="keyword">nullptr</span> || e-&gt;Cancelled)
<a name="l02434"></a>02434         {
<a name="l02435"></a>02435                 MessageBox::Show(e-&gt;Error-&gt;Message, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l02436"></a>02436                         MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l02437"></a>02437         }
<a name="l02438"></a>02438         <span class="keywordflow">else</span>
<a name="l02439"></a>02439         {
<a name="l02440"></a>02440                 <span class="comment">//Nameing</span>
<a name="l02441"></a>02441                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>=Path::GetFileNameWithoutExtension( ((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Result))-&gt;FileName);
<a name="l02442"></a>02442                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>=<span class="keyword">nullptr</span>;
<a name="l02443"></a>02443                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a9a74299d9d427352e42cb18c07d6ad35">ModelFileName</a>-&gt;Text=<span class="stringliteral">&quot;Imported File: &quot;</span>+Path::GetFileName( ((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Result))-&gt;FileName);
<a name="l02444"></a>02444                 this-&gt;Text=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a56278d7aa744ddd870c174af36777f63">CurrentTitleFile</a>+<span class="stringliteral">&quot; - Spinach GUI &quot;</span>+SpinachGUIver;
<a name="l02445"></a>02445 
<a name="l02446"></a>02446 
<a name="l02447"></a>02447                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>=((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Result))-&gt;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>;
<a name="l02448"></a>02448                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a80f79a6e9dcb6646e5b12304d9eacd09" title="Event for when something changes inside the model object.">PropertyChanged</a>+=<span class="keyword">gcnew</span> PropertyChangedEventHandler(<span class="keyword">this</span>,&amp;<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5b31c53c40cf7e6e6f15340d9f639fbe">MainForm::ModelChange</a>);
<a name="l02449"></a>02449                 <span class="comment">//When importing only atoms it better to declare that a change happen</span>
<a name="l02450"></a>02450                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a5b31c53c40cf7e6e6f15340d9f639fbe">ModelChange</a>(sender, <span class="keyword">gcnew</span> PropertyChangedEventArgs(<span class="stringliteral">&quot;Nothing&quot;</span>)); 
<a name="l02451"></a>02451                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#a9cd907838c4fbe6b254818e17e7bf8f8" title="Current system model.">SystemModel</a>=<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>;
<a name="l02452"></a>02452 
<a name="l02453"></a>02453                 <span class="comment">//Filtering</span>
<a name="l02454"></a>02454                 <span class="keywordflow">if</span>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eaa963e6070e2708404c83781a60a9e823">InteractionKind::HFC</a>]&gt;0 ||
<a name="l02455"></a>02455                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>]&gt;0 ||
<a name="l02456"></a>02456                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[<a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eac17339440287fe2fd6774ac931c67eb7">InteractionKind::Quadrupolar</a>]&gt;0 )
<a name="l02457"></a>02457                 {
<a name="l02458"></a>02458                         <a class="code" href="class_spinach_g_u_i_1_1_filter_file.html">FilterFile</a>^ filterfile = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_filter_file.html">FilterFile</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>); 
<a name="l02459"></a>02459                         filterfile-&gt;ShowDialog();
<a name="l02460"></a>02460                 };
<a name="l02461"></a>02461 
<a name="l02462"></a>02462                 <span class="comment">//For Gaussian only</span>
<a name="l02463"></a>02463                 <span class="keywordflow">if</span>(((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Result))-&gt;GetType()-&gt;ToString()==<span class="stringliteral">&quot;Gauss&quot;</span> &amp;&amp;
<a name="l02464"></a>02464                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::HFC]==0 &amp;&amp;
<a name="l02465"></a>02465                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::CShielding]==0 &amp;&amp;
<a name="l02466"></a>02466                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::Jcoupling]==0 &amp;&amp;
<a name="l02467"></a>02467                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::GTensor]==0 &amp;&amp;
<a name="l02468"></a>02468                         <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#a7b287b3d2768108facd1a8a3990e481d" title="Collection of the number of each kind of interactions.">InterKindCount</a>[InteractionKind::Quadrupolar]==0  )
<a name="l02469"></a>02469                 {
<a name="l02470"></a>02470                         MessageBox::Show(<span class="stringliteral">&quot;The Gaussian export file doesn&#39;t contain any information\n &quot;</span>+
<a name="l02471"></a>02471                                 <span class="stringliteral">&quot;about the interactions. Re-run Gaussian with #p parameter.&quot;</span>, <span class="stringliteral">&quot;Warning&quot;</span>, 
<a name="l02472"></a>02472                                 MessageBoxButtons::OK, MessageBoxIcon::Warning) ;
<a name="l02473"></a>02473                 }
<a name="l02474"></a>02474 
<a name="l02475"></a>02475                 <span class="comment">//If Shielding then Convert to shifts</span>
<a name="l02476"></a>02476                 <span class="keywordflow">if</span>(((<a class="code" href="class_spinach_g_u_i_1_1_i_o_spin_system.html">IOSpinSystem</a>^ )(e-&gt;Result))-&gt;ToShift)
<a name="l02477"></a>02477                 {
<a name="l02478"></a>02478                         <a class="code" href="class_spinach_g_u_i_1_1_shieldingto_shift.html">ShieldingtoShift</a>^ converttoshift = <span class="keyword">gcnew</span> <a class="code" href="class_spinach_g_u_i_1_1_shieldingto_shift.html">ShieldingtoShift</a>(<a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>);
<a name="l02479"></a>02479                         <span class="keywordflow">if</span>(converttoshift-&gt;ShowDialog()!= System::Windows::Forms::DialogResult::OK)
<a name="l02480"></a>02480                         {
<a name="l02481"></a>02481                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a477773d6666e62796fc46fc2bfaaf650" title="The collection of atoms in the model.">AtomCollection</a>-&gt;<a class="code" href="class_atoms_dictionary.html#a2b1099438d2b42b3f2c7c250323fa712">Clear</a>();
<a name="l02482"></a>02482                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#a7f859cd4433fb7e856a25afafba86ea3" title="The collection of interactions in the model.">InteractionCollection</a>-&gt;<a class="code" href="class_interactions_dictionary.html#aab9a62a43eabd6e0edef2599e65ebf82">Clear</a>();
<a name="l02483"></a>02483                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ad887b67a9764ea16888697362f95e9c0">SystemModel</a>-&gt;<a class="code" href="class_model.html#adc069c415325e10c5c452421d0578564" title="The collection of reference frames in the model.">RefFrameCollection</a>-&gt;<a class="code" href="class_reference_frames_dictionary.html#a3d6b3cdf166c8952ac2cd59b57b51676">Clear</a>();
<a name="l02484"></a>02484                                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#acf4b80f766f2180515baf511fc524dd5">CurrentSavedFile</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l02485"></a>02485                                 this-&gt;Text=<span class="stringliteral">&quot;Spinach GUI &quot;</span>+SpinachGUIver;
<a name="l02486"></a>02486                         }
<a name="l02487"></a>02487                 };
<a name="l02488"></a>02488 
<a name="l02489"></a>02489 
<a name="l02490"></a>02490                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#ab42879460d808810ce4d58dbc8dbe2d9">LoadModel</a>();
<a name="l02491"></a>02491                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a6e96faba3ccd3e71ad38f10f33414868">OpenGL</a>-&gt;<a class="code" href="class_open_g_l_form_1_1_c_open_g_l.html#ac8df7bacc4115db6119fb22eb76239f9" title="Updates the display list of the components of the system and renders at the end.">UpdateDisplay</a>(<a class="code" href="_open_g_l_8h.html#a0957e0df001dd796895b75f947daddb2ab1d5eac4b1dca480c8056eaea7663b7a">UpdateType::ALL</a>);
<a name="l02492"></a>02492                 <a class="code" href="class_spinach_g_u_i_1_1_main_form.html#a0d61b7fd1b0a11cf21cb61ccf3ccfae3">Savebutton</a>-&gt;Enabled=<span class="keyword">true</span>;
<a name="l02493"></a>02493         }
<a name="l02494"></a>02494 }
<a name="l02495"></a>02495 
<a name="l02496"></a>02496 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Apr 25 2015 18:33:59 for Spinach GUI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
