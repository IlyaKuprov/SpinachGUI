<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>spinach GUI: Z:/GUI/IO Formats/FileFormat.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Z:/GUI/IO Formats/FileFormat.cpp</h1>  </div>
</div>
<div class="contents">
<a href="_file_format_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;../StdAfx.h&quot;</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;windows.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;<a class="code" href="_file_format_8h.html">FileFormat.h</a>&quot;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;../MainForm.h&quot;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">using namespace </span>System::Windows::Forms;
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a><a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">00013</a> <span class="preprocessor">#define InteractionCollection  SystemModel-&gt;InteractionCollection</span>
<a name="l00014"></a><a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">00014</a> <span class="preprocessor"></span><span class="preprocessor">#define AtomCollection  SystemModel-&gt;AtomCollection</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a><a class="code" href="_file_format_8cpp.html#ab4cc23c3b2cb586d700fcce78e48a16b">00016</a> <span class="preprocessor">#define CMD_CHARGE                        &quot;Charge =&quot;//</span>
<a name="l00017"></a><a class="code" href="_file_format_8cpp.html#abe568cecf297affb793cbaa3acc623cf">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_DISTANCEMAT               &quot;Distance matrix (angstroms):&quot;//</span>
<a name="l00018"></a><a class="code" href="_file_format_8cpp.html#a167577ea401ef65aee2ce0a8bb281685">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_MUTLIPLICITY                  &quot;Multiplicity =&quot;//</span>
<a name="l00019"></a><a class="code" href="_file_format_8cpp.html#a62cfcd371dfc0eac379fd241c418e0a6">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_STDORIENT             &quot;Standard orientation:&quot;//</span>
<a name="l00020"></a><a class="code" href="_file_format_8cpp.html#a39469f4b08659f7b6e3d6bebf119094b">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_INPORIENT             &quot;Input orientation:&quot;//</span>
<a name="l00021"></a><a class="code" href="_file_format_8cpp.html#a8de9b7e31ab51251c0f4f1abe9065e02">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_GTENSOR               &quot;g tensor [g = g_e + g_RMC + g_DC + g_OZ/SOC]:&quot;</span>
<a name="l00022"></a><a class="code" href="_file_format_8cpp.html#a537808a9795f74e771a4a0b597c01936">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_SFCGIAOTENSOR         &quot;SCF GIAO Magnetic shielding tensor (ppm):&quot;//</span>
<a name="l00023"></a><a class="code" href="_file_format_8cpp.html#a71723a4c2f51b8025962366f24d8eaf2">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_TOTCOUPLINGS          &quot;Total nuclear spin-spin coupling J (Hz):&quot;//</span>
<a name="l00024"></a><a class="code" href="_file_format_8cpp.html#ac7d2340c0fdce028e690c2fb73e9e277">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_ISOCOUPLINGS          &quot;Isotropic Fermi Contact Couplings&quot;</span>
<a name="l00025"></a><a class="code" href="_file_format_8cpp.html#ac30b6f015a4ac764dc8661f66076e6ec">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_ANISCOUPLINGS         &quot;Anisotropic Spin Dipole Couplings in Principal Axis System&quot;</span>
<a name="l00026"></a><a class="code" href="_file_format_8cpp.html#afe34f2eee4e20974b93d1158a0bc1862">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define CMD_QUADCOUPLINGS         &quot;Nuclear quadrupole coupling constants [Chi] (MHz):&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a>00028 <a class="code" href="class_file_format.html#a28297667da9d8f99a2cc80934c1d455a">FileFormat::FileFormat</a>(System::String^ filename)
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030  ReadingFile = <span class="keyword">gcnew</span> StreamReader(filename);
<a name="l00031"></a>00031  Create_Bonds = <span class="keyword">false</span>;
<a name="l00032"></a>00032  ToShift= <span class="keyword">false</span>;
<a name="l00033"></a>00033   IsotropicCollection=<span class="keyword">gcnew</span> ArrayList();
<a name="l00034"></a>00034      Elements= <span class="keyword">gcnew</span> ArrayList();
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="class_file_format.html#a050a5068d0fbdea69f355c4656c1e686">00037</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#a050a5068d0fbdea69f355c4656c1e686">FileFormat::Gaussian</a>(<a class="code" href="class_model.html">Model</a>^% model)
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039  String^ Command;
<a name="l00040"></a>00040  <a class="code" href="class_file_format.html#ab37176acc4da3428cc051c4272c2173b">SystemModel</a>=model;
<a name="l00041"></a>00041 <span class="comment">// sww = gcnew StreamWriter(&quot;logtest2.txt&quot;);</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043  <span class="keywordtype">bool</span>  OK = <span class="keyword">true</span>;
<a name="l00044"></a>00044  <a class="code" href="class_file_format.html#ac7d7cc6d31459824e93334206ecd5bbe">read_onceOR</a>=<span class="keyword">false</span>;
<a name="l00045"></a>00045  <a class="code" href="class_file_format.html#a3bf6637f91689c144df7addd427104a8">read_onceSFC</a>=<span class="keyword">false</span>;
<a name="l00046"></a>00046  <a class="code" href="class_file_format.html#ac1f946b8fd174081bfdda6cb63d30d66">read_onceTOT</a>=<span class="keyword">false</span>;
<a name="l00047"></a>00047  <a class="code" href="class_file_format.html#a987f35b81e8f701663e891c76b3dd540">read_onceISO</a>=<span class="keyword">false</span>;
<a name="l00048"></a>00048  <a class="code" href="class_file_format.html#a14668f95e964800d5003bb9489991995">read_onceANI</a>=<span class="keyword">false</span>;
<a name="l00049"></a>00049  <a class="code" href="class_file_format.html#a641d32c26bb31910c396555743b79ae3">read_onceGT</a>=<span class="keyword">false</span>;
<a name="l00050"></a>00050  <a class="code" href="class_file_format.html#af0ef5dd493885b89c775a55963c57525">read_onceQC</a>=<span class="keyword">false</span>;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055  <span class="comment">//Read the file</span>
<a name="l00056"></a>00056  <span class="keywordflow">while</span> (!<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;EndOfStream  &amp;&amp; OK )
<a name="l00057"></a>00057  {
<a name="l00058"></a>00058          Command=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00059"></a>00059          Command= <a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061          <span class="keywordflow">if</span>(OK)
<a name="l00062"></a>00062          {
<a name="l00063"></a>00063                  <span class="keywordflow">if</span> ( (Command-&gt;Trim())-&gt;Contains(<a class="code" href="_file_format_8cpp.html#a167577ea401ef65aee2ce0a8bb281685">CMD_MUTLIPLICITY</a> ) )  { OK=<a class="code" href="class_file_format.html#a7c1dccdb8c20b6aa5136d9f4b2a88c96">read_CHRGMULTI</a>();}
<a name="l00064"></a>00064                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (Command-&gt;Trim())-&gt;Contains(<a class="code" href="_file_format_8cpp.html#abe568cecf297affb793cbaa3acc623cf">CMD_DISTANCEMAT</a>) )       { OK=<a class="code" href="class_file_format.html#aff95547c94c90d0189d56dc7fea0f43b">read_DISTANCEMAT</a>();}
<a name="l00065"></a>00065                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( String::Compare(Command-&gt;Trim(), CMD_STDORIENT ) == 0 ||
<a name="l00066"></a>00066                          String::Compare(Command-&gt;Trim(), CMD_INPORIENT) == 0)  
<a name="l00067"></a>00067                  { OK=<a class="code" href="class_file_format.html#adfd331a0ca86da564ff87537c157ff07">read_STDORIENT</a>(); <a class="code" href="class_file_format.html#ac7d7cc6d31459824e93334206ecd5bbe">read_onceOR</a>=<span class="keyword">true</span>;}      
<a name="l00068"></a>00068                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( String::Compare(Command-&gt;Trim(), CMD_GTENSOR) == 0 ) 
<a name="l00069"></a>00069                  {OK=<a class="code" href="class_file_format.html#a829213a1e7959bbf686f21b46a67a118">read_GTENSOR</a>();<a class="code" href="class_file_format.html#a641d32c26bb31910c396555743b79ae3">read_onceGT</a>=<span class="keyword">true</span>; } 
<a name="l00070"></a>00070                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (String::Compare(Command-&gt;Trim(), CMD_SFCGIAOTENSOR) == 0 ) 
<a name="l00071"></a>00071                  {OK=<a class="code" href="class_file_format.html#af4f7931909927549d33b99f2e4de127b">read_SFCGIAOTENSOR</a>();<a class="code" href="class_file_format.html#a3bf6637f91689c144df7addd427104a8">read_onceSFC</a>=<span class="keyword">true</span>;}
<a name="l00072"></a>00072                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (String::Compare(Command-&gt;Trim(), CMD_TOTCOUPLINGS) == 0 ) 
<a name="l00073"></a>00073                  {OK=<a class="code" href="class_file_format.html#ac73656cc0d00a16bf348adcc647ef61d">read_TOTCOUPLINGS</a>();<a class="code" href="class_file_format.html#ac1f946b8fd174081bfdda6cb63d30d66">read_onceTOT</a>=<span class="keyword">true</span>;} 
<a name="l00074"></a>00074                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (String::Compare(Command-&gt;Trim(), CMD_ISOCOUPLINGS)== 0) 
<a name="l00075"></a>00075                  {OK=<a class="code" href="class_file_format.html#ab24d898c4579f17c4dc13aefd75459f9">read_ISOCOUPLINGS</a>();<a class="code" href="class_file_format.html#a987f35b81e8f701663e891c76b3dd540">read_onceISO</a>=<span class="keyword">true</span>;} 
<a name="l00076"></a>00076                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (String::Compare(Command-&gt;Trim(), CMD_QUADCOUPLINGS)== 0) 
<a name="l00077"></a>00077                  {OK=<a class="code" href="class_file_format.html#abf926c03032369465af85aec46c28779">read_QUADCOUPLINGS</a>();<a class="code" href="class_file_format.html#af0ef5dd493885b89c775a55963c57525">read_onceQC</a>=<span class="keyword">true</span>;} 
<a name="l00078"></a>00078                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (String::Compare(Command-&gt;Trim(), CMD_ANISCOUPLINGS)== 0) 
<a name="l00079"></a>00079                  {OK=<a class="code" href="class_file_format.html#ac9f8fd3200c4e4c2c58692893d038512">read_ANISCOUPLINGS</a>();<a class="code" href="class_file_format.html#a14668f95e964800d5003bb9489991995">read_onceANI</a>=<span class="keyword">true</span>;}
<a name="l00080"></a>00080 
<a name="l00081"></a>00081          };
<a name="l00082"></a>00082 
<a name="l00083"></a>00083          <span class="keywordflow">if</span>(!OK) 
<a name="l00084"></a>00084          {
<a name="l00085"></a>00085                  MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading File&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00086"></a>00086                          MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00087"></a>00087                  <a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;Close();
<a name="l00088"></a>00088                  <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00089"></a>00089          };
<a name="l00090"></a>00090 
<a name="l00091"></a>00091  };
<a name="l00092"></a>00092 
<a name="l00093"></a>00093  <span class="comment">// Check if Gaussian format</span>
<a name="l00094"></a>00094   <span class="keywordflow">if</span>(!(<a class="code" href="class_file_format.html#ac7d7cc6d31459824e93334206ecd5bbe">read_onceOR</a> || <a class="code" href="class_file_format.html#a641d32c26bb31910c396555743b79ae3">read_onceGT</a> || <a class="code" href="class_file_format.html#a3bf6637f91689c144df7addd427104a8">read_onceSFC</a> ||
<a name="l00095"></a>00095          <a class="code" href="class_file_format.html#ac1f946b8fd174081bfdda6cb63d30d66">read_onceTOT</a> || <a class="code" href="class_file_format.html#a987f35b81e8f701663e891c76b3dd540">read_onceISO</a> || <a class="code" href="class_file_format.html#af0ef5dd493885b89c775a55963c57525">read_onceQC</a> || <a class="code" href="class_file_format.html#a14668f95e964800d5003bb9489991995">read_onceANI</a>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="comment">//  sww-&gt;Close();</span>
<a name="l00098"></a>00098   <a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;Close();
<a name="l00099"></a>00099   <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#a14668f95e964800d5003bb9489991995">read_onceANI</a> &amp;&amp; <a class="code" href="class_file_format.html#a987f35b81e8f701663e891c76b3dd540">read_onceISO</a>)
<a name="l00100"></a>00100   {
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         <span class="keywordtype">int</span> electronindex=-1;
<a name="l00103"></a>00103         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Count;i++)
<a name="l00104"></a>00104                 { 
<a name="l00105"></a>00105                 <span class="keywordflow">if</span>(((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[i])-&gt;isotope-&gt;Element==<span class="stringliteral">&quot;e&quot;</span>) electronindex=i;
<a name="l00106"></a>00106                 };
<a name="l00107"></a>00107 
<a name="l00108"></a>00108         <span class="keywordflow">if</span>(electronindex&lt;0)
<a name="l00109"></a>00109         {<a class="code" href="class_matrix3x3.html"></a>
<a name="l00110"></a>00110 <a class="code" href="class_matrix3x3.html">	  ::Matrix3x3</a> ^g_tensor=gcnew ::Matrix3x3();
<a name="l00111"></a>00111           <a class="code" href="class_atom.html">Atom</a>^ nAtom=<span class="keyword">gcnew</span> <a class="code" href="class_atom.html">Atom</a>();
<a name="l00112"></a>00112           nAtom-&gt;<a class="code" href="class_atom.html#a9adaaa1c67caa251c7c3f9b5753cfced">X</a>=0.0f;
<a name="l00113"></a>00113           nAtom-&gt;<a class="code" href="class_atom.html#ad121a01910fb0f6511a963de4d89460d">Y</a>=0.0f;
<a name="l00114"></a>00114           nAtom-&gt;<a class="code" href="class_atom.html#aa0c17b25aa4c710115c74b173c756a9b">Z</a>=0.0f;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116           g_tensor[0]=2.0023f; g_tensor[4]=2.0023f;g_tensor[8]=2.0023f;
<a name="l00117"></a>00117           g_tensor[1]=0.0f; g_tensor[2]=0.0f; g_tensor[3]=0.0f; 
<a name="l00118"></a>00118           g_tensor[5]=0.0f; g_tensor[6]=0.0f; g_tensor[7]=0.0f;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120           nAtom-&gt;<a class="code" href="class_atom.html#a14a6785b5d26d50fe23d617c95b2585d">isotope</a>=<a class="code" href="class_isotopes.html#a5d8772910912cbc6667f066a2a8ef531">Isotopes::FindIsotope</a>(<span class="stringliteral">&quot;e&quot;</span>,0, 0); 
<a name="l00121"></a>00121           nAtom-&gt;<a class="code" href="class_atom.html#ae501bf694d53ce89b0aaf8f7674262d3">ID</a>=<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Count;
<a name="l00122"></a>00122           <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Add(nAtom);
<a name="l00123"></a>00123           electronindex=nAtom-&gt;<a class="code" href="class_atom.html#ae501bf694d53ce89b0aaf8f7674262d3">ID</a>;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125           <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>(nAtom, <span class="keyword">nullptr</span>,
<a name="l00126"></a>00126                                                                                   <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea002c54e14f8b8cc5a33e76e39d67a6a0">InteractionKind::GTensor</a>, g_tensor);
<a name="l00127"></a>00127          nInteraction-&gt;<a class="code" href="class_interaction.html#af0b4df61d751c1ddffbfa70843e0c7db">unit</a>=<a class="code" href="class_units.html#aefde252771ce6c48781414a0ea4aee78">Units::Mi_b</a>;
<a name="l00128"></a>00128          <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Add(nInteraction);
<a name="l00129"></a>00129 
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="class_file_format.html#a0d17afa1804f253f4066b2abffc7a75d">AtomCount</a>; i++)
<a name="l00133"></a>00133         {<a class="code" href="class_matrix3x3.html"></a>
<a name="l00134"></a>00134 <a class="code" href="class_matrix3x3.html">	::Matrix3x3</a> ^ HF_Couplings=gcnew ::Matrix3x3();
<a name="l00135"></a>00135         HF_Couplings=((<a class="code" href="class_tensor.html">Tensor</a> ^)<a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[i+<a class="code" href="class_file_format.html#ab676d47abf1d737a983fe0c2e213903a">startIndexANIS</a>])-&gt;matrix3x3;
<a name="l00136"></a>00136         HF_Couplings[0]+=(double)<a class="code" href="class_file_format.html#a046b70bff205760a9bc27b427089949c">IsotropicCollection</a>[i];
<a name="l00137"></a>00137         HF_Couplings[4]+=(double)<a class="code" href="class_file_format.html#a046b70bff205760a9bc27b427089949c">IsotropicCollection</a>[i];
<a name="l00138"></a>00138         HF_Couplings[8]+=(double)<a class="code" href="class_file_format.html#a046b70bff205760a9bc27b427089949c">IsotropicCollection</a>[i];
<a name="l00139"></a>00139         <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[i], (<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[electronindex],
<a name="l00140"></a>00140                                                                                   <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eaa963e6070e2708404c83781a60a9e823">InteractionKind::HFC</a>, HF_Couplings);
<a name="l00141"></a>00141          nInteraction-&gt;<a class="code" href="class_interaction.html#af0b4df61d751c1ddffbfa70843e0c7db">unit</a>=<a class="code" href="class_units.html#afa8199bb56a18f4b9bc05a143645a068">Units::Gauss</a>;
<a name="l00142"></a>00142         <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[i+<a class="code" href="class_file_format.html#ab676d47abf1d737a983fe0c2e213903a">startIndexANIS</a>]=nInteraction;
<a name="l00143"></a>00143         };
<a name="l00144"></a>00144   };
<a name="l00145"></a>00145   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00146"></a>00146         
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="class_file_format.html#a7c1dccdb8c20b6aa5136d9f4b2a88c96">00149</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#a7c1dccdb8c20b6aa5136d9f4b2a88c96">FileFormat::read_CHRGMULTI</a>()
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151  <span class="keywordtype">int</span> number=4;
<a name="l00152"></a>00152    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00153"></a>00153    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 
<a name="l00156"></a>00156    
<a name="l00157"></a>00157 
<a name="l00158"></a>00158    String^ delimStr = <span class="stringliteral">&quot; ,&quot;</span>;
<a name="l00159"></a>00159    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00160"></a>00160 
<a name="l00161"></a>00161    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163    
<a name="l00164"></a>00164    <span class="keywordflow">if</span>((fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine())-&gt;Contains(<span class="stringliteral">&quot;Symbolic&quot;</span>)) fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00165"></a>00165 
<a name="l00166"></a>00166    <span class="comment">// C                     0.4865   -0.1848    1.3191   //</span>
<a name="l00167"></a>00167    <span class="keywordflow">while</span> (!(fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries)-&gt;Length&lt;1))<span class="comment">//number ||          //fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries)-&gt;Length==number+1)</span>
<a name="l00168"></a>00168         {
<a name="l00169"></a>00169         numbers = <span class="keyword">nullptr</span>;
<a name="l00170"></a>00170         numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00171"></a>00171         <span class="comment">//if(number!=numbers-&gt;Length) </span>
<a name="l00172"></a>00172         <span class="comment">//      {</span>
<a name="l00173"></a>00173         <span class="comment">//      MessageBox::Show(&quot;Problem in Reading Elements&quot;, &quot;Error&quot;, </span>
<a name="l00174"></a>00174         <span class="comment">//                          MessageBoxButtons::OK, MessageBoxIcon::Error) ;</span>
<a name="l00175"></a>00175         <span class="comment">//      return false;</span>
<a name="l00176"></a>00176         <span class="comment">//      };</span>
<a name="l00177"></a>00177         <span class="comment">//for (int i=0;i&lt;6;i++ )sww-&gt;WriteLine(numbers[i]);</span>
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="comment">//Change to capital</span>
<a name="l00180"></a>00180         Char^ cap=Char::ToUpper(numbers[0][0]);
<a name="l00181"></a>00181         numbers[0]=cap+numbers[0]-&gt;Remove(0,1);
<a name="l00182"></a>00182         
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <a class="code" href="class_file_format.html#a846078cd17a40b6712bcb0f2d08f23c4">Elements</a>-&gt;Add(numbers[0]);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186         fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00187"></a>00187         };
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 
<a name="l00190"></a>00190    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 }
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="class_file_format.html#aff95547c94c90d0189d56dc7fea0f43b">00196</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#aff95547c94c90d0189d56dc7fea0f43b">FileFormat::read_DISTANCEMAT</a>()
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198         <span class="comment">//at the end not used</span>
<a name="l00199"></a>00199 
<a name="l00200"></a>00200    <span class="keywordtype">int</span> number=3;
<a name="l00201"></a>00201    <span class="keywordtype">int</span> j=0;
<a name="l00202"></a>00202    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00203"></a>00203    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 
<a name="l00206"></a>00206    
<a name="l00207"></a>00207 
<a name="l00208"></a>00208    String^ delimStr = <span class="stringliteral">&quot; ,&quot;</span>;
<a name="l00209"></a>00209    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00210"></a>00210 
<a name="l00211"></a>00211    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213    <span class="comment">//                    1          2          3          4          5</span>
<a name="l00214"></a>00214   fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00215"></a>00215 
<a name="l00216"></a>00216    <span class="comment">//1  C    0.000000 //</span>
<a name="l00217"></a>00217    <span class="keywordflow">while</span> (!(fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries)-&gt;Length&gt;2))<span class="comment">//number ||          //fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries)-&gt;Length==number+1)</span>
<a name="l00218"></a>00218         {
<a name="l00219"></a>00219         numbers = <span class="keyword">nullptr</span>;
<a name="l00220"></a>00220         numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00221"></a>00221         <span class="comment">//if(number!=numbers-&gt;Length) </span>
<a name="l00222"></a>00222         <span class="comment">//      {</span>
<a name="l00223"></a>00223         <span class="comment">//      MessageBox::Show(&quot;Problem in Reading Elements&quot;, &quot;Error&quot;, </span>
<a name="l00224"></a>00224         <span class="comment">//                          MessageBoxButtons::OK, MessageBoxIcon::Error) ;</span>
<a name="l00225"></a>00225         <span class="comment">//      return false;</span>
<a name="l00226"></a>00226         <span class="comment">//      };</span>
<a name="l00227"></a>00227         <span class="comment">//for (int i=0;i&lt;6;i++ )sww-&gt;WriteLine(numbers[i]);</span>
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         <span class="keywordflow">if</span>(++j==<a class="code" href="class_file_format.html#a846078cd17a40b6712bcb0f2d08f23c4">Elements</a>-&gt;Count) <a class="code" href="class_file_format.html#a846078cd17a40b6712bcb0f2d08f23c4">Elements</a>-&gt;Add(numbers[1]);
<a name="l00230"></a>00230         <span class="keywordflow">else</span> <a class="code" href="class_file_format.html#a846078cd17a40b6712bcb0f2d08f23c4">Elements</a>[j]=numbers[1];
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00233"></a>00233         };
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 
<a name="l00236"></a>00236    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 }
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="class_file_format.html#adfd331a0ca86da564ff87537c157ff07">00241</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#adfd331a0ca86da564ff87537c157ff07">FileFormat::read_STDORIENT</a>()
<a name="l00242"></a>00242 {
<a name="l00243"></a>00243    <span class="keywordtype">int</span> number=6;
<a name="l00244"></a>00244    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00245"></a>00245    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00246"></a>00246    <a class="code" href="class_file_format.html#a0d17afa1804f253f4066b2abffc7a75d">AtomCount</a>=0;
<a name="l00247"></a>00247    <span class="keywordtype">int</span> AtomID=1;
<a name="l00248"></a>00248    <span class="keywordtype">int</span> index=0;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250    
<a name="l00251"></a>00251    
<a name="l00252"></a>00252 
<a name="l00253"></a>00253    String^ delimStr = <span class="stringliteral">&quot; &quot;</span>;
<a name="l00254"></a>00254    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00255"></a>00255 
<a name="l00256"></a>00256    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00257"></a>00257    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00258"></a>00258    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00259"></a>00259    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00260"></a>00260    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262    <span class="keywordflow">while</span> (!(fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine())-&gt;Contains(<span class="stringliteral">&quot;--------&quot;</span>))
<a name="l00263"></a>00263         {
<a name="l00264"></a>00264         numbers = <span class="keyword">nullptr</span>;
<a name="l00265"></a>00265         numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00266"></a>00266         <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00267"></a>00267                 {
<a name="l00268"></a>00268                 MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Coordinates&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00269"></a>00269                                     MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00270"></a>00270                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00271"></a>00271                 };
<a name="l00272"></a>00272         <span class="comment">//for (int i=0;i&lt;6;i++ )sww-&gt;WriteLine(numbers[i]);</span>
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276              <a class="code" href="class_atom.html">Atom</a>^ nAtom=<span class="keyword">gcnew</span> <a class="code" href="class_atom.html">Atom</a>();
<a name="l00277"></a>00277                  nAtom-&gt;<a class="code" href="class_atom.html#a9adaaa1c67caa251c7c3f9b5753cfced">X</a>=Convert::ToDouble(numbers[3]);
<a name="l00278"></a>00278                  nAtom-&gt;<a class="code" href="class_atom.html#ad121a01910fb0f6511a963de4d89460d">Y</a>=Convert::ToDouble(numbers[4]);
<a name="l00279"></a>00279                  nAtom-&gt;<a class="code" href="class_atom.html#aa0c17b25aa4c710115c74b173c756a9b">Z</a>=Convert::ToDouble(numbers[5]);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281                  <span class="keywordflow">try</span>{
<a name="l00282"></a>00282                  nAtom-&gt;<a class="code" href="class_atom.html#a14a6785b5d26d50fe23d617c95b2585d">isotope</a>=<a class="code" href="class_isotopes.html#a5d8772910912cbc6667f066a2a8ef531">Isotopes::FindIsotope</a>(((String^) <a class="code" href="class_file_format.html#a846078cd17a40b6712bcb0f2d08f23c4">Elements</a>[index++]),Convert::ToInt32(numbers[1]), 0);
<a name="l00283"></a>00283                  }
<a name="l00284"></a>00284                  <span class="keywordflow">catch</span>(String ^ e)
<a name="l00285"></a>00285                  {
<a name="l00286"></a>00286                 MessageBox::Show(<span class="stringliteral">&quot;Problem in Elements:&quot;</span>+e, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00287"></a>00287                                                 MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00288"></a>00288                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00289"></a>00289                  }
<a name="l00290"></a>00290                  <span class="comment">//nAtom-&gt;ID=AtomID;</span>
<a name="l00291"></a>00291 
<a name="l00292"></a>00292                  <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#ac7d7cc6d31459824e93334206ecd5bbe">read_onceOR</a>) {<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[AtomID]=nAtom;}
<a name="l00293"></a>00293                  <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Add(nAtom);
<a name="l00294"></a>00294                   AtomID++;
<a name="l00295"></a>00295         };
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    <a class="code" href="class_file_format.html#a0d17afa1804f253f4066b2abffc7a75d">AtomCount</a>=<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Count;
<a name="l00298"></a>00298    <span class="comment">//Command=nullptr;</span>
<a name="l00299"></a>00299    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="class_file_format.html#ab24d898c4579f17c4dc13aefd75459f9">00303</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#ab24d898c4579f17c4dc13aefd75459f9">FileFormat::read_ISOCOUPLINGS</a>()
<a name="l00304"></a>00304 {
<a name="l00305"></a>00305    <span class="keywordtype">int</span> number=6;
<a name="l00306"></a>00306    <span class="keywordtype">int</span> i=0;
<a name="l00307"></a>00307    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00308"></a>00308    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00309"></a>00309    <span class="keywordtype">int</span> jj=0;
<a name="l00310"></a>00310   
<a name="l00311"></a>00311 
<a name="l00312"></a>00312    String^ delimStr = <span class="stringliteral">&quot; &quot;</span>;
<a name="l00313"></a>00313    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00314"></a>00314 
<a name="l00315"></a>00315    <span class="comment">//Atom                 a.u.       MegaHertz       Gauss      10(-4) cm-1</span>
<a name="l00316"></a>00316    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00317"></a>00317    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00318"></a>00318 
<a name="l00319"></a>00319    <span class="keywordflow">while</span> (!(fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine())-&gt;Contains(<span class="stringliteral">&quot;--------&quot;</span>))
<a name="l00320"></a>00320         {
<a name="l00321"></a>00321         numbers = <span class="keyword">nullptr</span>;
<a name="l00322"></a>00322         numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00323"></a>00323         <span class="keywordflow">if</span>(number!=numbers-&gt;Length)
<a name="l00324"></a>00324                 {
<a name="l00325"></a>00325                 MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Isotropic couplings&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00326"></a>00326                                     MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00327"></a>00327                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00328"></a>00328                 };
<a name="l00329"></a>00329 
<a name="l00330"></a>00330         fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332         <span class="comment">//((Atom^)AtomCollection[i])-&gt;IsotropicCoupling=Convert::ToDouble(numbers[4]);</span>
<a name="l00333"></a>00333         <span class="comment">//i++;</span>
<a name="l00334"></a>00334 
<a name="l00335"></a>00335          
<a name="l00336"></a>00336         <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#a987f35b81e8f701663e891c76b3dd540">read_onceISO</a>) <a class="code" href="class_file_format.html#a046b70bff205760a9bc27b427089949c">IsotropicCollection</a>[jj]=Convert::ToDouble(numbers[4]);
<a name="l00337"></a>00337         <span class="keywordflow">else</span> <a class="code" href="class_file_format.html#a046b70bff205760a9bc27b427089949c">IsotropicCollection</a>-&gt;Add(Convert::ToDouble(numbers[4]));
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         jj++;
<a name="l00340"></a>00340         };
<a name="l00341"></a>00341    <span class="comment">//Command=nullptr;</span>
<a name="l00342"></a>00342    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 }
<a name="l00345"></a>00345 
<a name="l00346"></a><a class="code" href="class_file_format.html#ac73656cc0d00a16bf348adcc647ef61d">00346</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#ac73656cc0d00a16bf348adcc647ef61d">FileFormat::read_TOTCOUPLINGS</a>()
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348    <span class="keywordtype">int</span> number=6;
<a name="l00349"></a>00349    <span class="keywordtype">double</span> value;
<a name="l00350"></a>00350    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00351"></a>00351    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00352"></a>00352    <span class="keywordtype">int</span> atomcount=0;
<a name="l00353"></a>00353    <span class="keywordtype">int</span> jj=0;
<a name="l00354"></a>00354    <span class="keyword">static</span> <span class="keywordtype">int</span> startIndex;
<a name="l00355"></a>00355    <span class="keywordflow">if</span>(!<a class="code" href="class_file_format.html#ac1f946b8fd174081bfdda6cb63d30d66">read_onceTOT</a>) startIndex=<a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Count;
<a name="l00356"></a>00356    
<a name="l00357"></a>00357 
<a name="l00358"></a>00358    String^ delimStr = <span class="stringliteral">&quot; &quot;</span>;
<a name="l00359"></a>00359    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 
<a name="l00362"></a>00362      
<a name="l00363"></a>00363    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code" href="class_file_format.html#a0d17afa1804f253f4066b2abffc7a75d">AtomCount</a>/5+(int)(<a class="code" href="class_file_format.html#a0d17afa1804f253f4066b2abffc7a75d">AtomCount</a>%5&gt;0); k++)
<a name="l00364"></a>00364       {
<a name="l00365"></a>00365            fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00366"></a>00366            fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="class_file_format.html#a0d17afa1804f253f4066b2abffc7a75d">AtomCount</a>-5*k; i++)
<a name="l00369"></a>00369               {
<a name="l00370"></a>00370                         fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00371"></a>00371 
<a name="l00372"></a>00372                         fileline=fileline-&gt;Replace(<span class="charliteral">&#39;D&#39;</span>,<span class="charliteral">&#39;E&#39;</span>);
<a name="l00373"></a>00373                         numbers = <span class="keyword">nullptr</span>;
<a name="l00374"></a>00374                         numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00375"></a>00375                         <span class="keywordflow">if</span>((i+2) &lt; 6) number=i+2; <span class="keywordflow">else</span> number=6;
<a name="l00376"></a>00376                         <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00377"></a>00377                                 {
<a name="l00378"></a>00378                                 MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Total Couplings&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00379"></a>00379                                                     MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00380"></a>00380                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00381"></a>00381                                 };
<a name="l00382"></a>00382 
<a name="l00383"></a>00383                         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=1; j&lt;number-((int)(i&lt;5)); j++)
<a name="l00384"></a>00384                                 {
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 
<a name="l00388"></a>00388                                 <span class="keywordflow">if</span> (!Double::TryParse(numbers[j], value )) <span class="keywordflow">return</span> <span class="keyword">false</span>;<a class="code" href="class_matrix3x3.html"></a>
<a name="l00389"></a>00389 <a class="code" href="class_matrix3x3.html">				::Matrix3x3</a> ^Matrix=gcnew ::Matrix3x3();
<a name="l00390"></a>00390                                 Matrix[0]=value; Matrix[4]=value; Matrix[8]=value;
<a name="l00391"></a>00391                                 Matrix[1]=0.0; Matrix[2]=0.0; Matrix[3]=0.0; 
<a name="l00392"></a>00392                                 Matrix[5]=0.0; Matrix[6]=0.0; Matrix[7]=0.0;
<a name="l00393"></a>00393 
<a name="l00394"></a>00394                                 <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[i+5*k+1],
<a name="l00395"></a>00395                                                                             (<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[j+5*k],
<a name="l00396"></a>00396                                                                                                                 <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eada7dd200d6a013dee8d3ce94d259065f">InteractionKind::Jcoupling</a>, Matrix);
<a name="l00397"></a>00397                                  nInteraction-&gt;<a class="code" href="class_interaction.html#af0b4df61d751c1ddffbfa70843e0c7db">unit</a>=<a class="code" href="class_units.html#aa52706faabc35b525a484ad1bbd9747a">Units::Hz</a>;
<a name="l00398"></a>00398                                 <span class="comment">//InteractionCollection-&gt;Add(nInteraction);</span>
<a name="l00399"></a>00399                                 <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#ac1f946b8fd174081bfdda6cb63d30d66">read_onceTOT</a>) <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[jj+startIndex]=nInteraction;
<a name="l00400"></a>00400                         <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Add(nInteraction);
<a name="l00401"></a>00401                                 jj++;
<a name="l00402"></a>00402                                 };
<a name="l00403"></a>00403                 
<a name="l00404"></a>00404               };
<a name="l00405"></a>00405 
<a name="l00406"></a>00406       };
<a name="l00407"></a>00407 
<a name="l00408"></a>00408         
<a name="l00409"></a>00409    
<a name="l00410"></a>00410    <span class="comment">//while (Char::IsNumber((fileline=ReadingFile-&gt;ReadLine())-&gt;Trim(),0))// &amp;&amp;</span>
<a name="l00411"></a>00411 
<a name="l00412"></a>00412       
<a name="l00413"></a>00413    <span class="comment">//Command=fileline;</span>
<a name="l00414"></a>00414    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00418"></a><a class="code" href="class_file_format.html#af4f7931909927549d33b99f2e4de127b">00418</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#af4f7931909927549d33b99f2e4de127b">FileFormat::read_SFCGIAOTENSOR</a>()
<a name="l00419"></a>00419 {
<a name="l00420"></a>00420    <span class="keywordtype">int</span> number=6;
<a name="l00421"></a>00421    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00422"></a>00422    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00423"></a>00423    <span class="keywordtype">int</span> atomcount=0;
<a name="l00424"></a>00424    <span class="keyword">static</span> <span class="keywordtype">int</span> startIndex;
<a name="l00425"></a>00425    <span class="keywordflow">if</span>(!<a class="code" href="class_file_format.html#a3bf6637f91689c144df7addd427104a8">read_onceSFC</a>) startIndex=<a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Count;
<a name="l00426"></a>00426    <a class="code" href="class_file_format.html#af09b14b8f775411ceb51e158addc1b2e">ToShift</a>=<span class="keyword">true</span>;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428    String^ delimStr = <span class="stringliteral">&quot; &quot;</span>;
<a name="l00429"></a>00429    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00430"></a>00430 
<a name="l00431"></a>00431    <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Keys)
<a name="l00432"></a>00432           {<a class="code" href="class_matrix3x3.html"></a>
<a name="l00433"></a>00433 <a class="code" href="class_matrix3x3.html">		::Matrix3x3</a> ^ Chem_Shield=gcnew ::Matrix3x3();
<a name="l00434"></a>00434         <span class="comment">// 1  C    Isotropic =    57.9607   Anisotropy =   128.1526</span>
<a name="l00435"></a>00435        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00436"></a>00436 
<a name="l00437"></a>00437            <span class="comment">//  XX=   124.2135   YX=    17.8802   ZX=   -52.5149</span>
<a name="l00438"></a>00438        <span class="comment">//  XY=    16.8895   YY=    49.5584   ZY=    50.7000</span>
<a name="l00439"></a>00439        <span class="comment">//  XZ=   -52.1651   YZ=    56.3286   ZZ=     0.1103</span>
<a name="l00440"></a>00440            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++)
<a name="l00441"></a>00441               {
<a name="l00442"></a>00442                    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00443"></a>00443            fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00444"></a>00444                    numbers = <span class="keyword">nullptr</span>;
<a name="l00445"></a>00445                    numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00446"></a>00446                <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00447"></a>00447                                 {
<a name="l00448"></a>00448                                 MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Chemical shielding:Tensor&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00449"></a>00449                                                     MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00450"></a>00450                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00451"></a>00451                                 };
<a name="l00452"></a>00452 
<a name="l00453"></a>00453                Chem_Shield[j*3]=Convert::ToDouble(numbers[1]);
<a name="l00454"></a>00454                    Chem_Shield[j*3+1]=Convert::ToDouble(numbers[3]);
<a name="l00455"></a>00455                    Chem_Shield[j*3+2]=Convert::ToDouble(numbers[5]);
<a name="l00456"></a>00456                   };
<a name="l00457"></a>00457 
<a name="l00458"></a>00458            <span class="comment">//Make diagonal</span>
<a name="l00459"></a>00459            Chem_Shield[1]=(Chem_Shield[1]+Chem_Shield[3])/2.0f;
<a name="l00460"></a>00460            Chem_Shield[3]=Chem_Shield[1];
<a name="l00461"></a>00461            Chem_Shield[2]=(Chem_Shield[2]+Chem_Shield[6])/2.0f;
<a name="l00462"></a>00462            Chem_Shield[6]=Chem_Shield[2];
<a name="l00463"></a>00463            Chem_Shield[5]=(Chem_Shield[5]+Chem_Shield[7])/2.0f;
<a name="l00464"></a>00464            Chem_Shield[7]=Chem_Shield[5];
<a name="l00465"></a>00465 
<a name="l00466"></a>00466            <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[i], <span class="keyword">nullptr</span>,
<a name="l00467"></a>00467                                                                                   <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea4933d15638dc23396e7cb8ed2d9c205f">InteractionKind::CShielding</a>, Chem_Shield);
<a name="l00468"></a>00468            <span class="comment">//nInteraction-&gt;Calculate_EigenStates();</span>
<a name="l00469"></a>00469                  nInteraction-&gt;<a class="code" href="class_interaction.html#af0b4df61d751c1ddffbfa70843e0c7db">unit</a>=<a class="code" href="class_units.html#a13d0ca3953991e746670edb678bf1194">Units::ppm</a>;
<a name="l00470"></a>00470                 <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#a3bf6637f91689c144df7addd427104a8">read_onceSFC</a>) <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[i+startIndex]=nInteraction;
<a name="l00471"></a>00471                 <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Add(nInteraction);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473            <span class="comment">//Eigenvalues:   -50.5935    81.0799   143.3958</span>
<a name="l00474"></a>00474            fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00475"></a>00475        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00476"></a>00476            numbers = <span class="keyword">nullptr</span>;
<a name="l00477"></a>00477            numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00478"></a>00478            <span class="keywordflow">if</span>( numbers-&gt;Length!=4) 
<a name="l00479"></a>00479                   {
<a name="l00480"></a>00480                   MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Anisotropic Couplings:Eigenvalues&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00481"></a>00481                                             MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00482"></a>00482                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00483"></a>00483                         };
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 
<a name="l00486"></a>00486           };
<a name="l00487"></a>00487 
<a name="l00488"></a>00488      
<a name="l00489"></a>00489    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00493"></a><a class="code" href="class_file_format.html#ac9f8fd3200c4e4c2c58692893d038512">00493</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#ac9f8fd3200c4e4c2c58692893d038512">FileFormat::read_ANISCOUPLINGS</a>()
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495 
<a name="l00496"></a>00496  <span class="keywordtype">int</span> number=8;
<a name="l00497"></a>00497    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00498"></a>00498    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00499"></a>00499 <span class="comment">//   double *eigen_Anis_Couplings=new double[9];</span>
<a name="l00500"></a>00500 <span class="comment">//   double *eigenvec_Anis_Couplings=new double[9];</span>
<a name="l00501"></a>00501    
<a name="l00502"></a>00502    <span class="keywordflow">if</span>(!<a class="code" href="class_file_format.html#a14668f95e964800d5003bb9489991995">read_onceANI</a>) <a class="code" href="class_file_format.html#ab676d47abf1d737a983fe0c2e213903a">startIndexANIS</a>=<a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Count;
<a name="l00503"></a>00503     
<a name="l00504"></a>00504 
<a name="l00505"></a>00505    String^ delimStr = <span class="stringliteral">&quot; &quot;</span>;
<a name="l00506"></a>00506    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00507"></a>00507 
<a name="l00508"></a>00508    <span class="comment">// ---------------------------------------------------------------------------------</span>
<a name="l00509"></a>00509    <span class="comment">//</span>
<a name="l00510"></a>00510    <span class="comment">//    Atom             a.u.   MegaHertz   Gauss  10(-4) cm-1        Axes</span>
<a name="l00511"></a>00511    <span class="comment">//</span>
<a name="l00512"></a>00512    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00513"></a>00513    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00514"></a>00514    fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518    <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Keys)
<a name="l00519"></a>00519           {
<a name="l00520"></a>00520                 <span class="keywordtype">double</span> *eigen_Anis_Couplings=<span class="keyword">new</span> <span class="keywordtype">double</span>[9];<a class="code" href="class_matrix3x3.html"></a>
<a name="l00521"></a>00521 <a class="code" href="class_matrix3x3.html">        ::Matrix3x3</a> ^ eigenvec_Anis_Couplings=gcnew ::Matrix3x3();
<a name="l00522"></a>00522         <span class="comment">// &lt;Empty line&gt;</span>
<a name="l00523"></a>00523        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00524"></a>00524 
<a name="l00525"></a>00525            <span class="comment">//          Baa    -0.2281   -30.604   -10.920   -10.209  0.0000 -0.4863  0.8738</span>
<a name="l00526"></a>00526            fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00527"></a>00527        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00528"></a>00528            numbers = <span class="keyword">nullptr</span>;
<a name="l00529"></a>00529            numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00530"></a>00530            <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00531"></a>00531                  {
<a name="l00532"></a>00532                  MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Anisotropic Couplings&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00533"></a>00533                                             MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00534"></a>00534                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00535"></a>00535                  };
<a name="l00536"></a>00536 
<a name="l00537"></a>00537            eigen_Anis_Couplings[1]=eigen_Anis_Couplings[2]=0.0f;
<a name="l00538"></a>00538            eigen_Anis_Couplings[0]=Convert::ToDouble(numbers[3]);
<a name="l00539"></a>00539            eigenvec_Anis_Couplings[0]=Convert::ToDouble(numbers[5]);
<a name="l00540"></a>00540            eigenvec_Anis_Couplings[1]=Convert::ToDouble(numbers[6]);
<a name="l00541"></a>00541            eigenvec_Anis_Couplings[2]=Convert::ToDouble(numbers[7]);
<a name="l00542"></a>00542 
<a name="l00543"></a>00543        <span class="comment">// 1 C(13)  Bbb    -0.2215   -29.718   -10.604    -9.913  0.0000  0.8738  0.4863</span>
<a name="l00544"></a>00544            fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00545"></a>00545        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00546"></a>00546            numbers = <span class="keyword">nullptr</span>;
<a name="l00547"></a>00547            numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00548"></a>00548            <span class="keywordflow">if</span>((number+2)!=numbers-&gt;Length) 
<a name="l00549"></a>00549                 {
<a name="l00550"></a>00550                  MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Anisotropic Couplings&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00551"></a>00551                                             MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00552"></a>00552                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00553"></a>00553                  };
<a name="l00554"></a>00554 
<a name="l00555"></a>00555            eigen_Anis_Couplings[3]=eigen_Anis_Couplings[5]=0.0f;
<a name="l00556"></a>00556            eigen_Anis_Couplings[4]=Convert::ToDouble(numbers[5]);
<a name="l00557"></a>00557            eigenvec_Anis_Couplings[3]=Convert::ToDouble(numbers[7]);
<a name="l00558"></a>00558            eigenvec_Anis_Couplings[4]=Convert::ToDouble(numbers[8]);
<a name="l00559"></a>00559            eigenvec_Anis_Couplings[5]=Convert::ToDouble(numbers[9]);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561        <span class="comment">//          Bcc     0.4495    60.322    21.524    20.121  1.0000  0.0000  0.0000</span>
<a name="l00562"></a>00562            fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00563"></a>00563        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00564"></a>00564            numbers = <span class="keyword">nullptr</span>;
<a name="l00565"></a>00565            numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00566"></a>00566            <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00567"></a>00567                  {
<a name="l00568"></a>00568                  MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Anisotropic Couplings&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00569"></a>00569                                             MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00570"></a>00570                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00571"></a>00571                  };
<a name="l00572"></a>00572 
<a name="l00573"></a>00573            eigen_Anis_Couplings[6]=eigen_Anis_Couplings[7]=0.0f;
<a name="l00574"></a>00574            eigen_Anis_Couplings[8]=Convert::ToDouble(numbers[3]);
<a name="l00575"></a>00575            eigenvec_Anis_Couplings[6]=Convert::ToDouble(numbers[5]);
<a name="l00576"></a>00576            eigenvec_Anis_Couplings[7]=Convert::ToDouble(numbers[6]);
<a name="l00577"></a>00577            eigenvec_Anis_Couplings[8]=Convert::ToDouble(numbers[7]);
<a name="l00578"></a>00578 
<a name="l00579"></a>00579            <span class="comment">//Generate Tensor from eigenvectors and eigen values</span>
<a name="l00580"></a>00580                 Matrix3d result,eigenVectors,eigenValues;
<a name="l00581"></a>00581                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;9;j++) 
<a name="l00582"></a>00582                         {
<a name="l00583"></a>00583                         eigenVectors(j)=eigenvec_Anis_Couplings[j];
<a name="l00584"></a>00584                         eigenValues(j)=eigen_Anis_Couplings[j];
<a name="l00585"></a>00585                         };
<a name="l00586"></a>00586          
<a name="l00587"></a>00587              result= (eigenVectors*eigenValues)*eigenVectors.transpose();
<a name="l00588"></a>00588                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;9;j++) eigenvec_Anis_Couplings[j]=result(j);
<a name="l00589"></a>00589 
<a name="l00590"></a>00590                 
<a name="l00591"></a>00591                 
<a name="l00592"></a>00592                 <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[i], 
<a name="l00593"></a>00593                                                       <span class="keyword">nullptr</span>,
<a name="l00594"></a>00594                                                                                   <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eaa963e6070e2708404c83781a60a9e823">InteractionKind::HFC</a>, eigenvec_Anis_Couplings);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596                 
<a name="l00597"></a>00597 
<a name="l00598"></a>00598                 <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#a14668f95e964800d5003bb9489991995">read_onceANI</a>) <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[i+<a class="code" href="class_file_format.html#ab676d47abf1d737a983fe0c2e213903a">startIndexANIS</a>]=nInteraction;
<a name="l00599"></a>00599                 <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Add(nInteraction);
<a name="l00600"></a>00600 
<a name="l00601"></a>00601                 
<a name="l00602"></a>00602           };
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     
<a name="l00605"></a>00605    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00606"></a>00606         
<a name="l00607"></a>00607 
<a name="l00608"></a>00608 }
<a name="l00609"></a>00609 
<a name="l00610"></a><a class="code" href="class_file_format.html#a829213a1e7959bbf686f21b46a67a118">00610</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#a829213a1e7959bbf686f21b46a67a118">FileFormat::read_GTENSOR</a>()
<a name="l00611"></a>00611 {
<a name="l00612"></a>00612    <span class="keywordtype">int</span> number=6;
<a name="l00613"></a>00613    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00614"></a>00614    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;<a class="code" href="class_matrix3x3.html"></a>
<a name="l00615"></a>00615 <a class="code" href="class_matrix3x3.html">   ::Matrix3x3</a> ^ g_tensor=gcnew ::Matrix3x3();
<a name="l00616"></a>00616    <span class="keyword">static</span> <span class="keywordtype">int</span> startIndex;
<a name="l00617"></a>00617    <span class="comment">//if(!read_onceGT) startIndex=InteractionCollection-&gt;Count;</span>
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 
<a name="l00620"></a>00620    <a class="code" href="class_atom.html">Atom</a>^ nAtom=<span class="keyword">gcnew</span> <a class="code" href="class_atom.html">Atom</a>();
<a name="l00621"></a>00621           nAtom-&gt;<a class="code" href="class_atom.html#a9adaaa1c67caa251c7c3f9b5753cfced">X</a>=0.0f;
<a name="l00622"></a>00622           nAtom-&gt;<a class="code" href="class_atom.html#ad121a01910fb0f6511a963de4d89460d">Y</a>=0.0f;
<a name="l00623"></a>00623           nAtom-&gt;<a class="code" href="class_atom.html#aa0c17b25aa4c710115c74b173c756a9b">Z</a>=0.0f;
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 
<a name="l00626"></a>00626    nAtom-&gt;<a class="code" href="class_atom.html#a14a6785b5d26d50fe23d617c95b2585d">isotope</a>=<a class="code" href="class_isotopes.html#a5d8772910912cbc6667f066a2a8ef531">Isotopes::FindIsotope</a>(<span class="stringliteral">&quot;e&quot;</span>,0, 0); <span class="comment">//Electron mass=0</span>
<a name="l00627"></a>00627    nAtom-&gt;<a class="code" href="class_atom.html#ae501bf694d53ce89b0aaf8f7674262d3">ID</a>=<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Count;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629    <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#a641d32c26bb31910c396555743b79ae3">read_onceGT</a>) <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Count-1]=nAtom;
<a name="l00630"></a>00630    <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Add(nAtom);
<a name="l00631"></a>00631    
<a name="l00632"></a>00632 
<a name="l00633"></a>00633    String^ delimStr = <span class="stringliteral">&quot; =&quot;</span>;
<a name="l00634"></a>00634    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00635"></a>00635 
<a name="l00636"></a>00636            <span class="comment">//  XX= 124.2135  YX=    17.8802   ZX=-52.5149</span>
<a name="l00637"></a>00637        <span class="comment">//  XY= 16.8895   YY=    49.5584   ZY= 50.7000</span>
<a name="l00638"></a>00638        <span class="comment">//  XZ=-52.1651   YZ=    56.3286   ZZ=  0.1103</span>
<a name="l00639"></a>00639            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++)
<a name="l00640"></a>00640               {
<a name="l00641"></a>00641                    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00642"></a>00642            fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00643"></a>00643                    fileline=fileline-&gt;Replace(<span class="charliteral">&#39;D&#39;</span>,<span class="charliteral">&#39;E&#39;</span>);
<a name="l00644"></a>00644                    numbers = <span class="keyword">nullptr</span>;
<a name="l00645"></a>00645                    numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00646"></a>00646                <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00647"></a>00647                          {
<a name="l00648"></a>00648                          MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading G-tensor&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00649"></a>00649                                             MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00650"></a>00650                          <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00651"></a>00651                                 };
<a name="l00652"></a>00652 
<a name="l00653"></a>00653                g_tensor[j*3]=Convert::ToDouble(numbers[1]);
<a name="l00654"></a>00654                    g_tensor[j*3+1]=Convert::ToDouble(numbers[3]);
<a name="l00655"></a>00655                    g_tensor[j*3+2]=Convert::ToDouble(numbers[5]);
<a name="l00656"></a>00656                   };
<a name="l00657"></a>00657 
<a name="l00658"></a>00658            <span class="comment">//Make diagonal</span>
<a name="l00659"></a>00659            g_tensor[1]=(g_tensor[1]+g_tensor[3])/2.0f;
<a name="l00660"></a>00660            g_tensor[3]=g_tensor[1];
<a name="l00661"></a>00661            g_tensor[2]=(g_tensor[2]+g_tensor[6])/2.0f;
<a name="l00662"></a>00662            g_tensor[6]=g_tensor[2];
<a name="l00663"></a>00663            g_tensor[5]=(g_tensor[5]+g_tensor[7])/2.0f;
<a name="l00664"></a>00664            g_tensor[7]=g_tensor[5];
<a name="l00665"></a>00665 
<a name="l00666"></a>00666            <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>(nAtom, <span class="keyword">nullptr</span>,
<a name="l00667"></a>00667                                                                                   <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8ea002c54e14f8b8cc5a33e76e39d67a6a0">InteractionKind::GTensor</a>, g_tensor);
<a name="l00668"></a>00668                  nInteraction-&gt;<a class="code" href="class_interaction.html#af0b4df61d751c1ddffbfa70843e0c7db">unit</a>=<a class="code" href="class_units.html#aefde252771ce6c48781414a0ea4aee78">Units::Mi_b</a>;
<a name="l00669"></a>00669 
<a name="l00670"></a>00670                 <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#a641d32c26bb31910c396555743b79ae3">read_onceGT</a>) <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[<a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Count-1]=nInteraction;
<a name="l00671"></a>00671                 <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Add(nInteraction);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673              
<a name="l00674"></a>00674    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 }
<a name="l00677"></a>00677 
<a name="l00678"></a><a class="code" href="class_file_format.html#abf926c03032369465af85aec46c28779">00678</a> <span class="keywordtype">bool</span> <a class="code" href="class_file_format.html#abf926c03032369465af85aec46c28779">FileFormat::read_QUADCOUPLINGS</a>()
<a name="l00679"></a>00679 {
<a name="l00680"></a>00680    <span class="keywordtype">int</span> number=6;
<a name="l00681"></a>00681    String^ fileline=<span class="keyword">gcnew</span> String(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00682"></a>00682    array&lt;String^&gt;^numbers = <span class="keyword">nullptr</span>;
<a name="l00683"></a>00683    <span class="keywordtype">int</span> atomcount=0;
<a name="l00684"></a>00684    <span class="keyword">static</span> <span class="keywordtype">int</span> startIndex;
<a name="l00685"></a>00685    <span class="keywordflow">if</span>(!<a class="code" href="class_file_format.html#af0ef5dd493885b89c775a55963c57525">read_onceQC</a>) startIndex=<a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Count;
<a name="l00686"></a>00686 
<a name="l00687"></a>00687    String^ delimStr = <span class="stringliteral">&quot; &quot;</span>;
<a name="l00688"></a>00688    array&lt;Char&gt;^delimiter = delimStr-&gt;ToCharArray();
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    <span class="keywordflow">for each</span>(<span class="keywordtype">int</span> i <span class="keywordflow">in</span> <a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>-&gt;Keys)
<a name="l00691"></a>00691           {<a class="code" href="class_matrix3x3.html"></a>
<a name="l00692"></a>00692 <a class="code" href="class_matrix3x3.html">		::Matrix3x3</a> ^ Quad_Coupling=gcnew ::Matrix3x3();
<a name="l00693"></a>00693         <span class="comment">//   1  C(12) </span>
<a name="l00694"></a>00694        fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine();
<a name="l00695"></a>00695 
<a name="l00696"></a>00696            <span class="comment">//aa=     0.0000   ba=     0.0000   ca=     0.0000</span>
<a name="l00697"></a>00697        <span class="comment">//ab=     0.0000   bb=     0.0000   cb=     0.0000</span>
<a name="l00698"></a>00698        <span class="comment">//ac=     0.0000   bc=     0.0000   cc=     0.0000</span>
<a name="l00699"></a>00699            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++)
<a name="l00700"></a>00700               {
<a name="l00701"></a>00701                    fileline=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00702"></a>00702            fileline=<a class="code" href="class_file_format.html#a7fb19b8f00d07deaa2f5b1c33ca25c53">ReadingFile</a>-&gt;ReadLine() ;
<a name="l00703"></a>00703                    numbers = <span class="keyword">nullptr</span>;
<a name="l00704"></a>00704                    numbers=fileline-&gt;Split(delimiter,StringSplitOptions::RemoveEmptyEntries );
<a name="l00705"></a>00705                <span class="keywordflow">if</span>(number!=numbers-&gt;Length) 
<a name="l00706"></a>00706                                 {
<a name="l00707"></a>00707                                 MessageBox::Show(<span class="stringliteral">&quot;Problem in Reading Quadrupole Couplings&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, 
<a name="l00708"></a>00708                                                     MessageBoxButtons::OK, MessageBoxIcon::Error) ;
<a name="l00709"></a>00709                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00710"></a>00710                                 };
<a name="l00711"></a>00711 
<a name="l00712"></a>00712                Quad_Coupling[j*3]=Convert::ToDouble(numbers[1]);
<a name="l00713"></a>00713                    Quad_Coupling[j*3+1]=Convert::ToDouble(numbers[3]);
<a name="l00714"></a>00714                    Quad_Coupling[j*3+2]=Convert::ToDouble(numbers[5]);
<a name="l00715"></a>00715                   };
<a name="l00716"></a>00716 
<a name="l00717"></a>00717            <span class="comment">//Make diagonal</span>
<a name="l00718"></a>00718            Quad_Coupling[1]=(Quad_Coupling[1]+Quad_Coupling[3])/2.0f;
<a name="l00719"></a>00719            Quad_Coupling[3]=Quad_Coupling[1];
<a name="l00720"></a>00720            Quad_Coupling[2]=(Quad_Coupling[2]+Quad_Coupling[6])/2.0f;
<a name="l00721"></a>00721            Quad_Coupling[6]=Quad_Coupling[2];
<a name="l00722"></a>00722            Quad_Coupling[5]=(Quad_Coupling[5]+Quad_Coupling[7])/2.0f;
<a name="l00723"></a>00723            Quad_Coupling[7]=Quad_Coupling[5];
<a name="l00724"></a>00724 
<a name="l00725"></a>00725            <span class="keywordtype">int</span> ii=0;
<a name="l00726"></a>00726            <span class="keywordflow">if</span>(Quad_Coupling[0]+Quad_Coupling[1]+Quad_Coupling[2]+Quad_Coupling[3]+Quad_Coupling[4]+
<a name="l00727"></a>00727               Quad_Coupling[5]+Quad_Coupling[6]+Quad_Coupling[7]+Quad_Coupling[8]&gt;0)
<a name="l00728"></a>00728            {
<a name="l00729"></a>00729            <a class="code" href="class_tensor.html">Tensor</a>^ nInteraction=<span class="keyword">gcnew</span> <a class="code" href="class_tensor.html">Tensor</a>((<a class="code" href="class_atom.html">Atom</a>^)<a class="code" href="_file_format_8cpp.html#a2d177689e21e2dec50129e23e6d83df9">AtomCollection</a>[i], <span class="keyword">nullptr</span>,
<a name="l00730"></a>00730                                                                                   <a class="code" href="_model_8h.html#a0c402bd678cea44c9d1fdaf49d6f6b8eac17339440287fe2fd6774ac931c67eb7">InteractionKind::Quadrupolar</a>, Quad_Coupling);
<a name="l00731"></a>00731            nInteraction-&gt;<a class="code" href="class_interaction.html#af0b4df61d751c1ddffbfa70843e0c7db">unit</a>=<a class="code" href="class_units.html#a0dae09a04eea7c37f558e74dfe99f09b">Units::MHz</a>;
<a name="l00732"></a>00732            <span class="comment">//nInteraction-&gt;Calculate_EigenStates();</span>
<a name="l00733"></a>00733                 
<a name="l00734"></a>00734                 <span class="keywordflow">if</span>(<a class="code" href="class_file_format.html#af0ef5dd493885b89c775a55963c57525">read_onceQC</a>) <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>[ii+startIndex]=nInteraction;
<a name="l00735"></a>00735                 <span class="keywordflow">else</span> <a class="code" href="_file_format_8cpp.html#a5cbb61ec3949904f6d01991168849abf">InteractionCollection</a>-&gt;Add(nInteraction);
<a name="l00736"></a>00736                 ii++;
<a name="l00737"></a>00737            }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739           };
<a name="l00740"></a>00740 
<a name="l00741"></a>00741      
<a name="l00742"></a>00742    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00743"></a>00743 
<a name="l00744"></a>00744 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 4 2014 14:26:47 for spinach GUI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
